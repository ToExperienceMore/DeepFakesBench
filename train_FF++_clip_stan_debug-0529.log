/root/autodl-tmp/envs/DeepfakeBench-torch2.0/lib/python3.9/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/root/autodl-tmp/envs/DeepfakeBench-torch2.0/lib/python3.9/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
2025-05-30 10:56:05,857 - INFO - Save log to ./logs/training/clip_stan_2025-05-30-10-56-05
2025-05-30 10:56:05,857 - INFO - --------------- Configuration ---------------
2025-05-30 10:56:05,857 - INFO - Parameters: 
name: clip_stan
type: clip
model_name: clip_stan
backbone: ViT-L/14
pretrained: True
freeze_backbone: False
use_peft: True
peft_type: ln_tuning
use_metric_learning: True
metric_margin: 0.3
use_l2_norm: True
temperature: 0.07
use_contrastive_loss: True
clip_path: weights/clip-vit-base-patch16
depth: 4
time_module: selfattn
cls_residue: False
gradient_checkpointing: True
video_mode: True
clip_size: 8
frame_num: {'train': 32, 'test': 32}
manualSeed: 1024
cuda: True
cudnn: True
cudnn_benchmark: True
cudnn_deterministic: False
use_compile: False
log_dir: ./logs/training/
save_ckpt: True
save_feat: True
all_dataset: ['FaceForensics++', 'FF-F2F', 'FF-DF', 'FF-FS', 'FF-NT', 'FaceShifter', 'DeepFakeDetection', 'Celeb-DF-v1', 'Celeb-DF-v2', 'DFDCP', 'DFDC', 'DeeperForensics-1.0', 'UADFV']
train_dataset: ['FaceForensics++']
test_dataset: ['DFDC']
compression: c23
with_mask: False
with_landmark: False
resolution: 224
train_batchSize: 32
test_batchSize: 8
workers: 24
classifier: {'type': 'linear', 'in_features': 768, 'out_features': 2, 'bias': True}
optimizer: {'type': 'AdamW', 'lr': '8e-5', 'weight_decay': 0.0, 'betas': [0.9, 0.999]}
lr_scheduler: cosine
min_lr: 5e-5
nEpochs: 10
start_epoch: 0
save_epoch: 1
rec_iter: 100
loss: {'type': 'combined', 'ce_weight': 1.0, 'label_smoothing': 0.0, 'bce_labels': 0.0, 'uniformity': 0.0, 'alignment_labels': 0.0}
data: {'img_size': 224, 'batch_size': 128, 'num_workers': 12, 'use_face_detection': True}
use_data_augmentation: True
data_aug: {'flip_prob': 0.5, 'rotate_prob': 0.5, 'rotate_limit': [-10, 10], 'blur_prob': 0.5, 'blur_limit': [3, 7], 'brightness_prob': 0.5, 'brightness_limit': [-0.1, 0.1], 'contrast_limit': [-0.1, 0.1], 'quality_lower': 40, 'quality_upper': 100, 'random_resized_crop': {'size': 224, 'scale': [0.8, 1.0]}, 'color_jitter': {'brightness': 0.2, 'contrast': 0.2, 'saturation': 0.2, 'hue': 0.1}, 'random_erasing': {'p': 0.2}}
mean: [0.48145466, 0.4578275, 0.40821073]
std: [0.26862954, 0.26130258, 0.27577711]
metric_scoring: auc
loss_func: cross_entropy
mode: train
lmdb: False
dry_run: False
rgb_dir: ./datasets/rgb
lmdb_dir: ./datasets/lmdb
dataset_json_folder: ./preprocessing/dataset_json
SWA: False
save_avg: True
label_dict: {'DFD_fake': 1, 'DFD_real': 0, 'FF-SH': 1, 'FF-F2F': 1, 'FF-DF': 1, 'FF-FS': 1, 'FF-NT': 1, 'FF-FH': 1, 'FF-real': 0, 'CelebDFv1_real': 0, 'CelebDFv1_fake': 1, 'CelebDFv2_real': 0, 'CelebDFv2_fake': 1, 'DFDCP_Real': 0, 'DFDCP_FakeA': 1, 'DFDCP_FakeB': 1, 'DFDC_Fake': 1, 'DFDC_Real': 0, 'DF_fake': 1, 'DF_real': 0, 'UADFV_Fake': 1, 'UADFV_Real': 0, 'roop_Real': 0, 'roop_Fake': 1, 'real': 0, 'fake': 1}
local_rank: 0
max_train_images: 100
max_test_images: 100
ddp: False

2025-05-30 10:56:07,183 - INFO - ===> Epoch[0] start!
2025-05-30 10:56:07,183 - INFO - data_dict saved to ./logs/training/clip_stan_2025-05-30-10-56-05/train/FaceForensics++/data_dict_train.pickle
['in_channels', 'out_channels', 'kernel_size', 'stride', 'padding', 'dilation', 'groups', 'bias', 'padding_mode', 'device', 'dtype']
spatial_count=0 keep_stride_count=0
Setting maximum training images to 100
Setting maximum test images to 100
cudnn.benchmark: True
Limiting training dataset from 14313 to 100 images
Skipping video DFDC_Real_hmvjiodnxy because it has less than clip_size (8) frames (4).
Skipping video DFDC_Real_zffenlgire because it has less than clip_size (8) frames (4).
Skipping video DFDC_Real_mpwoskwuuk because it has less than clip_size (8) frames (7).
Skipping video DFDC_Real_hqfpcnnxuj because it has less than clip_size (8) frames (4).
Skipping video DFDC_Real_iyfwndboqs because it has less than clip_size (8) frames (3).
Skipping video DFDC_Real_issioyofmn because it has less than clip_size (8) frames (1).
Skipping video DFDC_Real_xgtelcltvg because it has less than clip_size (8) frames (1).
Skipping video DFDC_Real_vytzcppkpg because it has less than clip_size (8) frames (2).
Skipping video DFDC_Real_gqqhtdjoha because it has less than clip_size (8) frames (5).
Skipping video DFDC_Real_nodoppwmyj because it has less than clip_size (8) frames (3).
Skipping video DFDC_Real_bsduhevcwg because it has less than clip_size (8) frames (7).
Skipping video DFDC_Real_pgbtmrrmrq because it has less than clip_size (8) frames (1).
Skipping video DFDC_Real_dxuxornpue because it has less than clip_size (8) frames (6).
Skipping video DFDC_Real_rpqkwlaasy because it has less than clip_size (8) frames (7).
Skipping video DFDC_Real_usrimdndpz because it has less than clip_size (8) frames (5).
Skipping video DFDC_Real_rodpvqvdxm because it has less than clip_size (8) frames (5).
Skipping video DFDC_Real_fagregozex because it has less than clip_size (8) frames (5).
Skipping video DFDC_Real_aalscayrfi because it has less than clip_size (8) frames (3).
Skipping video DFDC_Real_sygzijgurs because it has less than clip_size (8) frames (4).
Skipping video DFDC_Real_qvpjagljpr because it has less than clip_size (8) frames (3).
Skipping video DFDC_Real_puhcxsfnde because it has less than clip_size (8) frames (4).
Skipping video DFDC_Real_rafzcxkbsh because it has less than clip_size (8) frames (7).
Skipping video DFDC_Real_olanckxfdx because it has less than clip_size (8) frames (6).
Skipping video DFDC_Real_cemvsipmew because it has less than clip_size (8) frames (1).
Skipping video DFDC_Real_egxsckqubp because it has less than clip_size (8) frames (5).
Skipping video DFDC_Real_hmmnljhtom because it has less than clip_size (8) frames (5).
Skipping video DFDC_Real_gdnacoubws because it has less than clip_size (8) frames (2).
Skipping video DFDC_Real_xvkflltlbg because it has less than clip_size (8) frames (4).
Skipping video DFDC_Real_ejunkkahbw because it has less than clip_size (8) frames (1).
Skipping video DFDC_Real_snsnifxref because it has less than clip_size (8) frames (3).
Skipping video DFDC_Real_zztotvpkjc because it has less than clip_size (8) frames (5).
Skipping video DFDC_Real_eppwzalgil because it has less than clip_size (8) frames (1).
Skipping video DFDC_Real_xnwmohspsh because it has less than clip_size (8) frames (1).
Skipping video DFDC_Real_pwfhdwzxqm because it has less than clip_size (8) frames (2).
Skipping video DFDC_Real_igbpkykmrz because it has less than clip_size (8) frames (2).
Skipping video DFDC_Real_apmxeenhpt because it has less than clip_size (8) frames (6).
Skipping video DFDC_Real_sfuddhcgmz because it has less than clip_size (8) frames (4).
Skipping video DFDC_Real_kdiezumwzi because it has less than clip_size (8) frames (2).
Skipping video DFDC_Real_vxvqnhakrk because it has less than clip_size (8) frames (7).
Skipping video DFDC_Real_bzqohcbrip because it has less than clip_size (8) frames (1).
Skipping video DFDC_Real_ovyikmbbdr because it has less than clip_size (8) frames (5).
Skipping video DFDC_Real_nuhvoaxqtn because it has less than clip_size (8) frames (2).
Skipping video DFDC_Real_ovbvtbmuxo because it has less than clip_size (8) frames (1).
Skipping video DFDC_Real_knamsitmul because it has less than clip_size (8) frames (4).
Skipping video DFDC_Real_mipljmaefr because it has less than clip_size (8) frames (4).
Skipping video DFDC_Real_hswqufrqdq because it has less than clip_size (8) frames (6).
Skipping video DFDC_Fake_ljaedxbwki because it has less than clip_size (8) frames (6).
Skipping video DFDC_Fake_gkhhhvjkmr because it has less than clip_size (8) frames (5).
Skipping video DFDC_Fake_xirozlwlpd because it has less than clip_size (8) frames (1).
Skipping video DFDC_Fake_noodanjabq because it has less than clip_size (8) frames (1).
Skipping video DFDC_Fake_ydiydkhofb because it has less than clip_size (8) frames (1).
Skipping video DFDC_Fake_nrzayygpza because it has less than clip_size (8) frames (7).
Skipping video DFDC_Fake_wpotxtrxtj because it has less than clip_size (8) frames (2).
Skipping video DFDC_Fake_eboyboyzis because it has less than clip_size (8) frames (4).
Skipping video DFDC_Fake_jqfpwtawdw because it has less than clip_size (8) frames (2).
Skipping video DFDC_Fake_zfbfgatuvk because it has less than clip_size (8) frames (1).
Skipping video DFDC_Fake_ejhumipcge because it has less than clip_size (8) frames (2).
Skipping video DFDC_Fake_pcnvtisyms because it has less than clip_size (8) frames (6).
Skipping video DFDC_Fake_hmwdlvrwbe because it has less than clip_size (8) frames (4).
Skipping video DFDC_Fake_bxgfrpxpyp because it has less than clip_size (8) frames (6).
Skipping video DFDC_Fake_wxorluvmvm because it has less than clip_size (8) frames (2).
Skipping video DFDC_Fake_jgmmablvoo because it has less than clip_size (8) frames (6).
Skipping video DFDC_Fake_gneonsmngz because it has less than clip_size (8) frames (2).
Skipping video DFDC_Fake_okogoesrwg because it has less than clip_size (8) frames (6).
Skipping video DFDC_Fake_wuzzdfwxlv because it has less than clip_size (8) frames (5).
Skipping video DFDC_Fake_jarlmlkfam because it has less than clip_size (8) frames (3).
Skipping video DFDC_Fake_shjmzxlkgk because it has less than clip_size (8) frames (1).
Skipping video DFDC_Fake_hrijskleak because it has less than clip_size (8) frames (4).
Skipping video DFDC_Fake_mzldnycwvi because it has less than clip_size (8) frames (1).
Skipping video DFDC_Fake_szkejtkgqq because it has less than clip_size (8) frames (7).
Skipping video DFDC_Fake_gowytswfqh because it has less than clip_size (8) frames (6).
Skipping video DFDC_Fake_ikgvwddrng because it has less than clip_size (8) frames (7).
Limiting test dataset from 3151 to 100 images
model_name: clip_stan
clip_path: weights/clip-vit-base-patch16
features_dim: 768
  0%|          | 0/4 [00:00<?, ?it/s]2025-05-30 10:56:10,910 - INFO - Iter: 0    training-loss, overall: 0.685638427734375    
2025-05-30 10:56:10,917 - INFO - Iter: 0    training-metric, acc: 0.75    training-metric, auc: 0.7560386473429952    training-metric, eer: 0.3333333333333333    training-metric, ap: 0.8837832441646885    
 25%|██▌       | 1/4 [00:03<00:10,  3.40s/it] 50%|█████     | 2/4 [00:03<00:03,  1.70s/it] 75%|███████▌  | 3/4 [00:04<00:01,  1.16s/it]2025-05-30 10:56:12,072 - INFO - ===> Test start!
2025-05-30 10:56:12,074 - INFO - data_dict saved to ./logs/training/clip_stan_2025-05-30-10-56-05/test/DFDC/data_dict_test.pickle
x.shape: torch.Size([32, 8, 3, 224, 224])
x.ndim: 5
x.shape: torch.Size([256, 3, 224, 224])
batch_size: 256
embeddings.shape: torch.Size([256, 197, 768])
input_ini - x shape before view: torch.Size([32, 8, 196, 768])
input_ini - x shape after first reshape: torch.Size([6272, 8, 768])
input_ini - x shape after cat: torch.Size([6272, 9, 768])
input_ini - x shape before final reshape: torch.Size([6272, 8, 768])
input_ini - x shape after final reshape: torch.Size([32, 196, 8, 768])
input_ini - x shape at end: torch.Size([32, 1568, 768])
x2.shape): torch.Size([32, 1569, 768])
(x1.shape): torch.Size([32, 1569, 768])
(x2.shape): torch.Size([32, 1569, 768])
x2.shape): torch.Size([32, 1569, 768])
(x1.shape): torch.Size([32, 1569, 768])
(x2.shape): torch.Size([32, 1569, 768])
x2.shape): torch.Size([32, 1569, 768])
(x1.shape): torch.Size([32, 1569, 768])
(x2.shape): torch.Size([32, 1569, 768])
cls_token.shape: torch.Size([32, 8, 1, 768])
patch_token.shape: torch.Size([32, 8, 196, 768])
x.shape: torch.Size([256, 197, 768])
x2.shape: torch.Size([256, 197, 768])
temporal.shape: torch.Size([256, 768])
cls_token.shape: torch.Size([256, 768])
### cls_token.shape: torch.Size([32, 768])
features.shape: torch.Size([32, 768])
pred.shape: torch.Size([32, 2])
label.shape: torch.Size([32])
pred.shape: torch.Size([32, 2])
x.shape: torch.Size([32, 8, 3, 224, 224])
x.ndim: 5
x.shape: torch.Size([256, 3, 224, 224])
batch_size: 256
embeddings.shape: torch.Size([256, 197, 768])
input_ini - x shape before view: torch.Size([32, 8, 196, 768])
input_ini - x shape after first reshape: torch.Size([6272, 8, 768])
input_ini - x shape after cat: torch.Size([6272, 9, 768])
input_ini - x shape before final reshape: torch.Size([6272, 8, 768])
input_ini - x shape after final reshape: torch.Size([32, 196, 8, 768])
input_ini - x shape at end: torch.Size([32, 1568, 768])
x2.shape): torch.Size([32, 1569, 768])
(x1.shape): torch.Size([32, 1569, 768])
(x2.shape): torch.Size([32, 1569, 768])
x2.shape): torch.Size([32, 1569, 768])
(x1.shape): torch.Size([32, 1569, 768])
(x2.shape): torch.Size([32, 1569, 768])
x2.shape): torch.Size([32, 1569, 768])
(x1.shape): torch.Size([32, 1569, 768])
(x2.shape): torch.Size([32, 1569, 768])
cls_token.shape: torch.Size([32, 8, 1, 768])
patch_token.shape: torch.Size([32, 8, 196, 768])
x.shape: torch.Size([256, 197, 768])
x2.shape: torch.Size([256, 197, 768])
temporal.shape: torch.Size([256, 768])
cls_token.shape: torch.Size([256, 768])
### cls_token.shape: torch.Size([32, 768])
features.shape: torch.Size([32, 768])
pred.shape: torch.Size([32, 2])
label.shape: torch.Size([32])
pred.shape: torch.Size([32, 2])
x.shape: torch.Size([32, 8, 3, 224, 224])
x.ndim: 5
x.shape: torch.Size([256, 3, 224, 224])
batch_size: 256
embeddings.shape: torch.Size([256, 197, 768])
input_ini - x shape before view: torch.Size([32, 8, 196, 768])
input_ini - x shape after first reshape: torch.Size([6272, 8, 768])
input_ini - x shape after cat: torch.Size([6272, 9, 768])
input_ini - x shape before final reshape: torch.Size([6272, 8, 768])
input_ini - x shape after final reshape: torch.Size([32, 196, 8, 768])
input_ini - x shape at end: torch.Size([32, 1568, 768])
x2.shape): torch.Size([32, 1569, 768])
(x1.shape): torch.Size([32, 1569, 768])
(x2.shape): torch.Size([32, 1569, 768])
x2.shape): torch.Size([32, 1569, 768])
(x1.shape): torch.Size([32, 1569, 768])
(x2.shape): torch.Size([32, 1569, 768])
x2.shape): torch.Size([32, 1569, 768])
(x1.shape): torch.Size([32, 1569, 768])
(x2.shape): torch.Size([32, 1569, 768])
cls_token.shape: torch.Size([32, 8, 1, 768])
patch_token.shape: torch.Size([32, 8, 196, 768])
x.shape: torch.Size([256, 197, 768])
x2.shape: torch.Size([256, 197, 768])
temporal.shape: torch.Size([256, 768])
cls_token.shape: torch.Size([256, 768])
### cls_token.shape: torch.Size([32, 768])
features.shape: torch.Size([32, 768])
pred.shape: torch.Size([32, 2])
label.shape: torch.Size([32])
pred.shape: torch.Size([32, 2])
x.shape: torch.Size([4, 8, 3, 224, 224])
x.ndim: 5
x.shape: torch.Size([32, 3, 224, 224])
batch_size: 32
embeddings.shape: torch.Size([32, 197, 768])
input_ini - x shape before view: torch.Size([4, 8, 196, 768])
input_ini - x shape after first reshape: torch.Size([784, 8, 768])
input_ini - x shape after cat: torch.Size([784, 9, 768])
input_ini - x shape before final reshape: torch.Size([784, 8, 768])
input_ini - x shape after final reshape: torch.Size([4, 196, 8, 768])
input_ini - x shape at end: torch.Size([4, 1568, 768])
x2.shape): torch.Size([4, 1569, 768])
(x1.shape): torch.Size([4, 1569, 768])
(x2.shape): torch.Size([4, 1569, 768])
x2.shape): torch.Size([4, 1569, 768])
(x1.shape): torch.Size([4, 1569, 768])
(x2.shape): torch.Size([4, 1569, 768])
x2.shape): torch.Size([4, 1569, 768])
(x1.shape): torch.Size([4, 1569, 768])
(x2.shape): torch.Size([4, 1569, 768])
cls_token.shape: torch.Size([4, 8, 1, 768])
patch_token.shape: torch.Size([4, 8, 196, 768])
x.shape: torch.Size([32, 197, 768])
x2.shape: torch.Size([32, 197, 768])
temporal.shape: torch.Size([32, 768])
cls_token.shape: torch.Size([32, 768])
### cls_token.shape: torch.Size([4, 768])
features.shape: torch.Size([4, 768])
pred.shape: torch.Size([4, 2])
label.shape: torch.Size([4])
pred.shape: torch.Size([4, 2])

  0%|          | 0/13 [00:00<?, ?it/s][A
  8%|▊         | 1/13 [00:00<00:09,  1.24it/s][A
 15%|█▌        | 2/13 [00:00<00:04,  2.43it/s][A
 23%|██▎       | 3/13 [00:01<00:02,  3.51it/s][A
 31%|███       | 4/13 [00:01<00:02,  4.45it/s][A
 38%|███▊      | 5/13 [00:01<00:01,  5.21it/s][A
 46%|████▌     | 6/13 [00:01<00:01,  5.82it/s][Ax.shape: torch.Size([8, 8, 3, 224, 224])
x.ndim: 5
x.shape: torch.Size([64, 3, 224, 224])
batch_size: 64
embeddings.shape: torch.Size([64, 197, 768])
input_ini - x shape before view: torch.Size([8, 8, 196, 768])
input_ini - x shape after first reshape: torch.Size([1568, 8, 768])
input_ini - x shape after cat: torch.Size([1568, 9, 768])
input_ini - x shape before final reshape: torch.Size([1568, 8, 768])
input_ini - x shape after final reshape: torch.Size([8, 196, 8, 768])
input_ini - x shape at end: torch.Size([8, 1568, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
cls_token.shape: torch.Size([8, 8, 1, 768])
patch_token.shape: torch.Size([8, 8, 196, 768])
x.shape: torch.Size([64, 197, 768])
x2.shape: torch.Size([64, 197, 768])
temporal.shape: torch.Size([64, 768])
cls_token.shape: torch.Size([64, 768])
### cls_token.shape: torch.Size([8, 768])
features.shape: torch.Size([8, 768])
pred.shape: torch.Size([8, 2])
label.shape: torch.Size([8])
pred.shape: torch.Size([8, 2])
x.shape: torch.Size([8, 8, 3, 224, 224])
x.ndim: 5
x.shape: torch.Size([64, 3, 224, 224])
batch_size: 64
embeddings.shape: torch.Size([64, 197, 768])
input_ini - x shape before view: torch.Size([8, 8, 196, 768])
input_ini - x shape after first reshape: torch.Size([1568, 8, 768])
input_ini - x shape after cat: torch.Size([1568, 9, 768])
input_ini - x shape before final reshape: torch.Size([1568, 8, 768])
input_ini - x shape after final reshape: torch.Size([8, 196, 8, 768])
input_ini - x shape at end: torch.Size([8, 1568, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
cls_token.shape: torch.Size([8, 8, 1, 768])
patch_token.shape: torch.Size([8, 8, 196, 768])
x.shape: torch.Size([64, 197, 768])
x2.shape: torch.Size([64, 197, 768])
temporal.shape: torch.Size([64, 768])
cls_token.shape: torch.Size([64, 768])
### cls_token.shape: torch.Size([8, 768])
features.shape: torch.Size([8, 768])
pred.shape: torch.Size([8, 2])
label.shape: torch.Size([8])
pred.shape: torch.Size([8, 2])
x.shape: torch.Size([8, 8, 3, 224, 224])
x.ndim: 5
x.shape: torch.Size([64, 3, 224, 224])
batch_size: 64
embeddings.shape: torch.Size([64, 197, 768])
input_ini - x shape before view: torch.Size([8, 8, 196, 768])
input_ini - x shape after first reshape: torch.Size([1568, 8, 768])
input_ini - x shape after cat: torch.Size([1568, 9, 768])
input_ini - x shape before final reshape: torch.Size([1568, 8, 768])
input_ini - x shape after final reshape: torch.Size([8, 196, 8, 768])
input_ini - x shape at end: torch.Size([8, 1568, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
cls_token.shape: torch.Size([8, 8, 1, 768])
patch_token.shape: torch.Size([8, 8, 196, 768])
x.shape: torch.Size([64, 197, 768])
x2.shape: torch.Size([64, 197, 768])
temporal.shape: torch.Size([64, 768])
cls_token.shape: torch.Size([64, 768])
### cls_token.shape: torch.Size([8, 768])
features.shape: torch.Size([8, 768])
pred.shape: torch.Size([8, 2])
label.shape: torch.Size([8])
pred.shape: torch.Size([8, 2])
x.shape: torch.Size([8, 8, 3, 224, 224])
x.ndim: 5
x.shape: torch.Size([64, 3, 224, 224])
batch_size: 64
embeddings.shape: torch.Size([64, 197, 768])
input_ini - x shape before view: torch.Size([8, 8, 196, 768])
input_ini - x shape after first reshape: torch.Size([1568, 8, 768])
input_ini - x shape after cat: torch.Size([1568, 9, 768])
input_ini - x shape before final reshape: torch.Size([1568, 8, 768])
input_ini - x shape after final reshape: torch.Size([8, 196, 8, 768])
input_ini - x shape at end: torch.Size([8, 1568, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
cls_token.shape: torch.Size([8, 8, 1, 768])
patch_token.shape: torch.Size([8, 8, 196, 768])
x.shape: torch.Size([64, 197, 768])
x2.shape: torch.Size([64, 197, 768])
temporal.shape: torch.Size([64, 768])
cls_token.shape: torch.Size([64, 768])
### cls_token.shape: torch.Size([8, 768])
features.shape: torch.Size([8, 768])
pred.shape: torch.Size([8, 2])
label.shape: torch.Size([8])
pred.shape: torch.Size([8, 2])
x.shape: torch.Size([8, 8, 3, 224, 224])
x.ndim: 5
x.shape: torch.Size([64, 3, 224, 224])
batch_size: 64
embeddings.shape: torch.Size([64, 197, 768])
input_ini - x shape before view: torch.Size([8, 8, 196, 768])
input_ini - x shape after first reshape: torch.Size([1568, 8, 768])
input_ini - x shape after cat: torch.Size([1568, 9, 768])
input_ini - x shape before final reshape: torch.Size([1568, 8, 768])
input_ini - x shape after final reshape: torch.Size([8, 196, 8, 768])
input_ini - x shape at end: torch.Size([8, 1568, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
cls_token.shape: torch.Size([8, 8, 1, 768])
patch_token.shape: torch.Size([8, 8, 196, 768])
x.shape: torch.Size([64, 197, 768])
x2.shape: torch.Size([64, 197, 768])
temporal.shape: torch.Size([64, 768])
cls_token.shape: torch.Size([64, 768])
### cls_token.shape: torch.Size([8, 768])
features.shape: torch.Size([8, 768])
pred.shape: torch.Size([8, 2])
label.shape: torch.Size([8])
pred.shape: torch.Size([8, 2])
x.shape: torch.Size([8, 8, 3, 224, 224])
x.ndim: 5
x.shape: torch.Size([64, 3, 224, 224])
batch_size: 64
embeddings.shape: torch.Size([64, 197, 768])
input_ini - x shape before view: torch.Size([8, 8, 196, 768])
input_ini - x shape after first reshape: torch.Size([1568, 8, 768])
input_ini - x shape after cat: torch.Size([1568, 9, 768])
input_ini - x shape before final reshape: torch.Size([1568, 8, 768])
input_ini - x shape after final reshape: torch.Size([8, 196, 8, 768])
input_ini - x shape at end: torch.Size([8, 1568, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
cls_token.shape: torch.Size([8, 8, 1, 768])
patch_token.shape: torch.Size([8, 8, 196, 768])
x.shape: torch.Size([64, 197, 768])
x2.shape: torch.Size([64, 197, 768])
temporal.shape: torch.Size([64, 768])
cls_token.shape: torch.Size([64, 768])
### cls_token.shape: torch.Size([8, 768])
features.shape: torch.Size([8, 768])
pred.shape: torch.Size([8, 2])
label.shape: torch.Size([8])
pred.shape: torch.Size([8, 2])
x.shape: torch.Size([8, 8, 3, 224, 224])
x.ndim: 5
x.shape: torch.Size([64, 3, 224, 224])
batch_size: 64
embeddings.shape: torch.Size([64, 197, 768])
input_ini - x shape before view: torch.Size([8, 8, 196, 768])
input_ini - x shape after first reshape: torch.Size([1568, 8, 768])
input_ini - x shape after cat: torch.Size([1568, 9, 768])
input_ini - x shape before final reshape: torch.Size([1568, 8, 768])

 54%|█████▍    | 7/13 [00:01<00:00,  6.28it/s][A
 62%|██████▏   | 8/13 [00:01<00:00,  6.62it/s][A
 69%|██████▉   | 9/13 [00:01<00:00,  6.88it/s][A
 77%|███████▋  | 10/13 [00:02<00:00,  7.06it/s][A
 85%|████████▍ | 11/13 [00:02<00:00,  7.20it/s][A
 92%|█████████▏| 12/13 [00:02<00:00,  7.29it/s][Ainput_ini - x shape after final reshape: torch.Size([8, 196, 8, 768])
input_ini - x shape at end: torch.Size([8, 1568, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
cls_token.shape: torch.Size([8, 8, 1, 768])
patch_token.shape: torch.Size([8, 8, 196, 768])
x.shape: torch.Size([64, 197, 768])
x2.shape: torch.Size([64, 197, 768])
temporal.shape: torch.Size([64, 768])
cls_token.shape: torch.Size([64, 768])
### cls_token.shape: torch.Size([8, 768])
features.shape: torch.Size([8, 768])
pred.shape: torch.Size([8, 2])
label.shape: torch.Size([8])
pred.shape: torch.Size([8, 2])
x.shape: torch.Size([8, 8, 3, 224, 224])
x.ndim: 5
x.shape: torch.Size([64, 3, 224, 224])
batch_size: 64
embeddings.shape: torch.Size([64, 197, 768])
input_ini - x shape before view: torch.Size([8, 8, 196, 768])
input_ini - x shape after first reshape: torch.Size([1568, 8, 768])
input_ini - x shape after cat: torch.Size([1568, 9, 768])
input_ini - x shape before final reshape: torch.Size([1568, 8, 768])
input_ini - x shape after final reshape: torch.Size([8, 196, 8, 768])
input_ini - x shape at end: torch.Size([8, 1568, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
cls_token.shape: torch.Size([8, 8, 1, 768])
patch_token.shape: torch.Size([8, 8, 196, 768])
x.shape: torch.Size([64, 197, 768])
x2.shape: torch.Size([64, 197, 768])
temporal.shape: torch.Size([64, 768])
cls_token.shape: torch.Size([64, 768])
### cls_token.shape: torch.Size([8, 768])
features.shape: torch.Size([8, 768])
pred.shape: torch.Size([8, 2])
label.shape: torch.Size([8])
pred.shape: torch.Size([8, 2])
x.shape: torch.Size([8, 8, 3, 224, 224])
x.ndim: 5
x.shape: torch.Size([64, 3, 224, 224])
batch_size: 64
embeddings.shape: torch.Size([64, 197, 768])
input_ini - x shape before view: torch.Size([8, 8, 196, 768])
input_ini - x shape after first reshape: torch.Size([1568, 8, 768])
input_ini - x shape after cat: torch.Size([1568, 9, 768])
input_ini - x shape before final reshape: torch.Size([1568, 8, 768])
input_ini - x shape after final reshape: torch.Size([8, 196, 8, 768])
input_ini - x shape at end: torch.Size([8, 1568, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
cls_token.shape: torch.Size([8, 8, 1, 768])
patch_token.shape: torch.Size([8, 8, 196, 768])
x.shape: torch.Size([64, 197, 768])
x2.shape: torch.Size([64, 197, 768])
temporal.shape: torch.Size([64, 768])
cls_token.shape: torch.Size([64, 768])
### cls_token.shape: torch.Size([8, 768])
features.shape: torch.Size([8, 768])
pred.shape: torch.Size([8, 2])
label.shape: torch.Size([8])
pred.shape: torch.Size([8, 2])
x.shape: torch.Size([8, 8, 3, 224, 224])
x.ndim: 5
x.shape: torch.Size([64, 3, 224, 224])
batch_size: 64
embeddings.shape: torch.Size([64, 197, 768])
input_ini - x shape before view: torch.Size([8, 8, 196, 768])
input_ini - x shape after first reshape: torch.Size([1568, 8, 768])
input_ini - x shape after cat: torch.Size([1568, 9, 768])
input_ini - x shape before final reshape: torch.Size([1568, 8, 768])
input_ini - x shape after final reshape: torch.Size([8, 196, 8, 768])
input_ini - x shape at end: torch.Size([8, 1568, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
cls_token.shape: torch.Size([8, 8, 1, 768])
patch_token.shape: torch.Size([8, 8, 196, 768])
x.shape: torch.Size([64, 197, 768])
x2.shape: torch.Size([64, 197, 768])
temporal.shape: torch.Size([64, 768])
cls_token.shape: torch.Size([64, 768])
### cls_token.shape: torch.Size([8, 768])
features.shape: torch.Size([8, 768])
pred.shape: torch.Size([8, 2])
label.shape: torch.Size([8])
pred.shape: torch.Size([8, 2])
x.shape: torch.Size([8, 8, 3, 224, 224])
x.ndim: 5
x.shape: torch.Size([64, 3, 224, 224])
batch_size: 64
embeddings.shape: torch.Size([64, 197, 768])
input_ini - x shape before view: torch.Size([8, 8, 196, 768])
input_ini - x shape after first reshape: torch.Size([1568, 8, 768])
input_ini - x shape after cat: torch.Size([1568, 9, 768])
input_ini - x shape before final reshape: torch.Size([1568, 8, 768])
input_ini - x shape after final reshape: torch.Size([8, 196, 8, 768])
input_ini - x shape at end: torch.Size([8, 1568, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
cls_token.shape: torch.Size([8, 8, 1, 768])
patch_token.shape: torch.Size([8, 8, 196, 768])
x.shape: torch.Size([64, 197, 768])
x2.shape: torch.Size([64, 197, 768])
temporal.shape: torch.Size([64, 768])
cls_token.shape: torch.Size([64, 768])
### cls_token.shape: torch.Size([8, 768])
features.shape: torch.Size([8, 768])
pred.shape: torch.Size([8, 2])
label.shape: torch.Size([8])
pred.shape: torch.Size([8, 2])
x.shape: torch.Size([8, 8, 3, 224, 224])
x.ndim: 5
x.shape: torch.Size([64, 3, 224, 224])
batch_size: 64
embeddings.shape: torch.Size([64, 197, 768])
input_ini - x shape before view: torch.Size([8, 8, 196, 768])
input_ini - x shape after first reshape: torch.Size([1568, 8, 768])
input_ini - x shape after cat: torch.Size([1568, 9, 768])
input_ini - x shape before final reshape: torch.Size([1568, 8, 768])
input_ini - x shape after final reshape: torch.Size([8, 196, 8, 768])
input_ini - x shape at end: torch.Size([8, 1568, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
cls_token.shape: torch.Size([8, 8, 1, 768])
patch_token.shape: torch.Size([8, 8, 196, 768])
x.shape: torch.Size([64, 197, 768])
x2.shape: torch.Size([64, 197, 768])
temporal.shape: torch.Size([64, 768])
cls_token.shape: torch.Size([64, 768])
### cls_token.shape: torch.Size([8, 768])
features.shape: torch.Size([8, 768])
pred.shape: torch.Size([8, 2])
label.shape: torch.Size([8])
pred.shape: torch.Size([8, 2])
x.shape: torch.Size([4, 8, 3, 224, 224])
x.ndim: 5
x.shape: torch.Size([32, 3, 224, 224])
batch_size: 32
embeddings.shape: torch.Size([32, 197, 768])
input_ini - x shape before view: torch.Size([4, 8, 196, 768])
input_ini - x shape after first reshape: torch.Size([784, 8, 768])
input_ini - x shape after cat: torch.Size([784, 9, 768])
input_ini - x shape before final reshape: torch.Size([784, 8, 768])
input_ini - x shape after final reshape: torch.Size([4, 196, 8, 768])
input_ini - x shape at end: torch.Size([4, 1568, 768])
x2.shape): torch.Size([4, 1569, 768])
(x1.shape): torch.Size([4, 1569, 768])
(x2.shape): torch.Size([4, 1569, 768])
x2.shape): torch.Size([4, 1569, 768])
(x1.shape): torch.Size([4, 1569, 768])
(x2.shape): torch.Size([4, 1569, 768])
x2.shape): torch.Size([4, 1569, 768])
(x1.shape): torch.Size([4, 1569, 768])
100%|██████████| 13/13 [00:02<00:00,  5.54it/s]
2025-05-30 10:56:15,687 - INFO - Checkpoint saved to ./logs/training/clip_stan_2025-05-30-10-56-05/test/DFDC/ckpt_best.pth, current ckpt is 0+3
2025-05-30 10:56:15,688 - INFO - Metrics saved to ./logs/training/clip_stan_2025-05-30-10-56-05/test/DFDC/metric_dict_best.pickle
2025-05-30 10:56:15,693 - INFO - dataset: DFDC    step: 3    testing-loss, overall: 0.685546875    
2025-05-30 10:56:15,702 - INFO - dataset: DFDC    step: 3    testing-metric, acc: 0.65    testing-metric, auc: 0.5090109890109891    testing-metric, eer: 0.45714285714285713    testing-metric, ap: 0.703160612012238    testing-metric, video_auc: 0.5090109890109891    testing-metric, acc_real:0.7714285714285715; acc_fake:0.5846153846153846
2025-05-30 10:56:16,268 - INFO - Checkpoint saved to ./logs/training/clip_stan_2025-05-30-10-56-05/test/avg/ckpt_best.pth, current ckpt is 0+3
2025-05-30 10:56:16,269 - INFO - Metrics saved to ./logs/training/clip_stan_2025-05-30-10-56-05/test/avg/metric_dict_best.pickle
2025-05-30 10:56:16,277 - INFO - dataset: avg    step: 3    testing-metric, acc: 0.65    testing-metric, auc: 0.5090109890109891    testing-metric, eer: 0.45714285714285713    testing-metric, ap: 0.703160612012238    testing-metric, video_auc: 0.5090109890109891    
2025-05-30 10:56:16,278 - INFO - ===> Test Done!
100%|██████████| 4/4 [00:08<00:00,  2.41s/it]100%|██████████| 4/4 [00:08<00:00,  2.19s/it]
2025-05-30 10:56:16,279 - INFO - ===> Epoch[0] end with testing auc: 
================================ Each dataset best metric ================================ 
| DFDC:  auc=0.5090109890109891 | 
============================================================================================= 
================================== Average best metric ====================================== 
| avg auc: 0.5090109890109891 | 
| DFDC: 0.5090109890109891 | 
=============================================================================================!
2025-05-30 10:56:16,279 - INFO - ===> Epoch[1] start!
2025-05-30 10:56:16,280 - INFO - data_dict saved to ./logs/training/clip_stan_2025-05-30-10-56-05/train/FaceForensics++/data_dict_train.pickle
(x2.shape): torch.Size([4, 1569, 768])
cls_token.shape: torch.Size([4, 8, 1, 768])
patch_token.shape: torch.Size([4, 8, 196, 768])
x.shape: torch.Size([32, 197, 768])
x2.shape: torch.Size([32, 197, 768])
temporal.shape: torch.Size([32, 768])
cls_token.shape: torch.Size([32, 768])
### cls_token.shape: torch.Size([4, 768])
features.shape: torch.Size([4, 768])
pred.shape: torch.Size([4, 2])
label.shape: torch.Size([4])
pred.shape: torch.Size([4, 2])
len(y_pred): 100
len(y_true): 100
  0%|          | 0/4 [00:00<?, ?it/s]2025-05-30 10:56:18,806 - INFO - Iter: 4    training-loss, overall: 0.6850738525390625    
2025-05-30 10:56:18,807 - INFO - Iter: 4    training-metric, acc: 0.65625    training-metric, auc: 0.6568181818181819    training-metric, eer: 0.4    training-metric, ap: 0.8327721647039825    
 25%|██▌       | 1/4 [00:02<00:07,  2.52s/it]2025-05-30 10:56:19,321 - INFO - ===> Test start!
2025-05-30 10:56:19,324 - INFO - data_dict saved to ./logs/training/clip_stan_2025-05-30-10-56-05/test/DFDC/data_dict_test.pickle
x.shape: torch.Size([32, 8, 3, 224, 224])
x.ndim: 5
x.shape: torch.Size([256, 3, 224, 224])
batch_size: 256
embeddings.shape: torch.Size([256, 197, 768])
input_ini - x shape before view: torch.Size([32, 8, 196, 768])
input_ini - x shape after first reshape: torch.Size([6272, 8, 768])
input_ini - x shape after cat: torch.Size([6272, 9, 768])
input_ini - x shape before final reshape: torch.Size([6272, 8, 768])
input_ini - x shape after final reshape: torch.Size([32, 196, 8, 768])
input_ini - x shape at end: torch.Size([32, 1568, 768])
x2.shape): torch.Size([32, 1569, 768])
(x1.shape): torch.Size([32, 1569, 768])
(x2.shape): torch.Size([32, 1569, 768])
x2.shape): torch.Size([32, 1569, 768])
(x1.shape): torch.Size([32, 1569, 768])
(x2.shape): torch.Size([32, 1569, 768])
x2.shape): torch.Size([32, 1569, 768])
(x1.shape): torch.Size([32, 1569, 768])
(x2.shape): torch.Size([32, 1569, 768])
cls_token.shape: torch.Size([32, 8, 1, 768])
patch_token.shape: torch.Size([32, 8, 196, 768])
x.shape: torch.Size([256, 197, 768])
x2.shape: torch.Size([256, 197, 768])
temporal.shape: torch.Size([256, 768])
cls_token.shape: torch.Size([256, 768])
### cls_token.shape: torch.Size([32, 768])
features.shape: torch.Size([32, 768])
pred.shape: torch.Size([32, 2])
label.shape: torch.Size([32])
pred.shape: torch.Size([32, 2])
x.shape: torch.Size([32, 8, 3, 224, 224])
x.ndim: 5
x.shape: torch.Size([256, 3, 224, 224])
batch_size: 256
embeddings.shape: torch.Size([256, 197, 768])
input_ini - x shape before view: torch.Size([32, 8, 196, 768])
input_ini - x shape after first reshape: torch.Size([6272, 8, 768])
input_ini - x shape after cat: torch.Size([6272, 9, 768])
input_ini - x shape before final reshape: torch.Size([6272, 8, 768])
input_ini - x shape after final reshape: torch.Size([32, 196, 8, 768])
input_ini - x shape at end: torch.Size([32, 1568, 768])
x2.shape): torch.Size([32, 1569, 768])
(x1.shape): torch.Size([32, 1569, 768])
(x2.shape): torch.Size([32, 1569, 768])
x2.shape): torch.Size([32, 1569, 768])
(x1.shape): torch.Size([32, 1569, 768])
(x2.shape): torch.Size([32, 1569, 768])
x2.shape): torch.Size([32, 1569, 768])
(x1.shape): torch.Size([32, 1569, 768])
(x2.shape): torch.Size([32, 1569, 768])
cls_token.shape: torch.Size([32, 8, 1, 768])
patch_token.shape: torch.Size([32, 8, 196, 768])
x.shape: torch.Size([256, 197, 768])
x2.shape: torch.Size([256, 197, 768])
temporal.shape: torch.Size([256, 768])
cls_token.shape: torch.Size([256, 768])
### cls_token.shape: torch.Size([32, 768])
features.shape: torch.Size([32, 768])
pred.shape: torch.Size([32, 2])
label.shape: torch.Size([32])
pred.shape: torch.Size([32, 2])

  0%|          | 0/13 [00:00<?, ?it/s][A
  8%|▊         | 1/13 [00:00<00:07,  1.59it/s][A
 15%|█▌        | 2/13 [00:00<00:03,  2.97it/s][A
 23%|██▎       | 3/13 [00:00<00:02,  4.11it/s][A
 31%|███       | 4/13 [00:01<00:01,  5.01it/s][A
 38%|███▊      | 5/13 [00:01<00:01,  5.70it/s][A
 46%|████▌     | 6/13 [00:01<00:01,  6.22it/s][Ax.shape: torch.Size([8, 8, 3, 224, 224])
x.ndim: 5
x.shape: torch.Size([64, 3, 224, 224])
batch_size: 64
embeddings.shape: torch.Size([64, 197, 768])
input_ini - x shape before view: torch.Size([8, 8, 196, 768])
input_ini - x shape after first reshape: torch.Size([1568, 8, 768])
input_ini - x shape after cat: torch.Size([1568, 9, 768])
input_ini - x shape before final reshape: torch.Size([1568, 8, 768])
input_ini - x shape after final reshape: torch.Size([8, 196, 8, 768])
input_ini - x shape at end: torch.Size([8, 1568, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
cls_token.shape: torch.Size([8, 8, 1, 768])
patch_token.shape: torch.Size([8, 8, 196, 768])
x.shape: torch.Size([64, 197, 768])
x2.shape: torch.Size([64, 197, 768])
temporal.shape: torch.Size([64, 768])
cls_token.shape: torch.Size([64, 768])
### cls_token.shape: torch.Size([8, 768])
features.shape: torch.Size([8, 768])
pred.shape: torch.Size([8, 2])
label.shape: torch.Size([8])
pred.shape: torch.Size([8, 2])
x.shape: torch.Size([8, 8, 3, 224, 224])
x.ndim: 5
x.shape: torch.Size([64, 3, 224, 224])
batch_size: 64
embeddings.shape: torch.Size([64, 197, 768])
input_ini - x shape before view: torch.Size([8, 8, 196, 768])
input_ini - x shape after first reshape: torch.Size([1568, 8, 768])
input_ini - x shape after cat: torch.Size([1568, 9, 768])
input_ini - x shape before final reshape: torch.Size([1568, 8, 768])
input_ini - x shape after final reshape: torch.Size([8, 196, 8, 768])
input_ini - x shape at end: torch.Size([8, 1568, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
cls_token.shape: torch.Size([8, 8, 1, 768])
patch_token.shape: torch.Size([8, 8, 196, 768])
x.shape: torch.Size([64, 197, 768])
x2.shape: torch.Size([64, 197, 768])
temporal.shape: torch.Size([64, 768])
cls_token.shape: torch.Size([64, 768])
### cls_token.shape: torch.Size([8, 768])
features.shape: torch.Size([8, 768])
pred.shape: torch.Size([8, 2])
label.shape: torch.Size([8])
pred.shape: torch.Size([8, 2])
x.shape: torch.Size([8, 8, 3, 224, 224])
x.ndim: 5
x.shape: torch.Size([64, 3, 224, 224])
batch_size: 64
embeddings.shape: torch.Size([64, 197, 768])
input_ini - x shape before view: torch.Size([8, 8, 196, 768])
input_ini - x shape after first reshape: torch.Size([1568, 8, 768])
input_ini - x shape after cat: torch.Size([1568, 9, 768])
input_ini - x shape before final reshape: torch.Size([1568, 8, 768])
input_ini - x shape after final reshape: torch.Size([8, 196, 8, 768])
input_ini - x shape at end: torch.Size([8, 1568, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
cls_token.shape: torch.Size([8, 8, 1, 768])
patch_token.shape: torch.Size([8, 8, 196, 768])
x.shape: torch.Size([64, 197, 768])
x2.shape: torch.Size([64, 197, 768])
temporal.shape: torch.Size([64, 768])
cls_token.shape: torch.Size([64, 768])
### cls_token.shape: torch.Size([8, 768])
features.shape: torch.Size([8, 768])
pred.shape: torch.Size([8, 2])
label.shape: torch.Size([8])
pred.shape: torch.Size([8, 2])
x.shape: torch.Size([8, 8, 3, 224, 224])
x.ndim: 5
x.shape: torch.Size([64, 3, 224, 224])
batch_size: 64
embeddings.shape: torch.Size([64, 197, 768])
input_ini - x shape before view: torch.Size([8, 8, 196, 768])
input_ini - x shape after first reshape: torch.Size([1568, 8, 768])
input_ini - x shape after cat: torch.Size([1568, 9, 768])
input_ini - x shape before final reshape: torch.Size([1568, 8, 768])
input_ini - x shape after final reshape: torch.Size([8, 196, 8, 768])
input_ini - x shape at end: torch.Size([8, 1568, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
cls_token.shape: torch.Size([8, 8, 1, 768])
patch_token.shape: torch.Size([8, 8, 196, 768])
x.shape: torch.Size([64, 197, 768])
x2.shape: torch.Size([64, 197, 768])
temporal.shape: torch.Size([64, 768])
cls_token.shape: torch.Size([64, 768])
### cls_token.shape: torch.Size([8, 768])
features.shape: torch.Size([8, 768])
pred.shape: torch.Size([8, 2])
label.shape: torch.Size([8])
pred.shape: torch.Size([8, 2])
x.shape: torch.Size([8, 8, 3, 224, 224])
x.ndim: 5
x.shape: torch.Size([64, 3, 224, 224])
batch_size: 64
embeddings.shape: torch.Size([64, 197, 768])
input_ini - x shape before view: torch.Size([8, 8, 196, 768])
input_ini - x shape after first reshape: torch.Size([1568, 8, 768])
input_ini - x shape after cat: torch.Size([1568, 9, 768])
input_ini - x shape before final reshape: torch.Size([1568, 8, 768])
input_ini - x shape after final reshape: torch.Size([8, 196, 8, 768])
input_ini - x shape at end: torch.Size([8, 1568, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
cls_token.shape: torch.Size([8, 8, 1, 768])
patch_token.shape: torch.Size([8, 8, 196, 768])
x.shape: torch.Size([64, 197, 768])
x2.shape: torch.Size([64, 197, 768])
temporal.shape: torch.Size([64, 768])
cls_token.shape: torch.Size([64, 768])
### cls_token.shape: torch.Size([8, 768])
features.shape: torch.Size([8, 768])
pred.shape: torch.Size([8, 2])
label.shape: torch.Size([8])
pred.shape: torch.Size([8, 2])
x.shape: torch.Size([8, 8, 3, 224, 224])
x.ndim: 5
x.shape: torch.Size([64, 3, 224, 224])
batch_size: 64
embeddings.shape: torch.Size([64, 197, 768])
input_ini - x shape before view: torch.Size([8, 8, 196, 768])
input_ini - x shape after first reshape: torch.Size([1568, 8, 768])
input_ini - x shape after cat: torch.Size([1568, 9, 768])
input_ini - x shape before final reshape: torch.Size([1568, 8, 768])
input_ini - x shape after final reshape: torch.Size([8, 196, 8, 768])
input_ini - x shape at end: torch.Size([8, 1568, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
cls_token.shape: torch.Size([8, 8, 1, 768])
patch_token.shape: torch.Size([8, 8, 196, 768])
x.shape: torch.Size([64, 197, 768])
x2.shape: torch.Size([64, 197, 768])
temporal.shape: torch.Size([64, 768])
cls_token.shape: torch.Size([64, 768])
### cls_token.shape: torch.Size([8, 768])
features.shape: torch.Size([8, 768])
pred.shape: torch.Size([8, 2])
label.shape: torch.Size([8])
pred.shape: torch.Size([8, 2])
x.shape: torch.Size([8, 8, 3, 224, 224])
x.ndim: 5
x.shape: torch.Size([64, 3, 224, 224])
batch_size: 64
embeddings.shape: torch.Size([64, 197, 768])
input_ini - x shape before view: torch.Size([8, 8, 196, 768])
input_ini - x shape after first reshape: torch.Size([1568, 8, 768])
input_ini - x shape after cat: torch.Size([1568, 9, 768])
input_ini - x shape before final reshape: torch.Size([1568, 8, 768])

 54%|█████▍    | 7/13 [00:01<00:00,  6.60it/s][A
 62%|██████▏   | 8/13 [00:01<00:00,  6.88it/s][A
 69%|██████▉   | 9/13 [00:01<00:00,  7.07it/s][A
 77%|███████▋  | 10/13 [00:01<00:00,  7.21it/s][A
 85%|████████▍ | 11/13 [00:01<00:00,  7.32it/s][A
 92%|█████████▏| 12/13 [00:02<00:00,  7.39it/s][Ainput_ini - x shape after final reshape: torch.Size([8, 196, 8, 768])
input_ini - x shape at end: torch.Size([8, 1568, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
cls_token.shape: torch.Size([8, 8, 1, 768])
patch_token.shape: torch.Size([8, 8, 196, 768])
x.shape: torch.Size([64, 197, 768])
x2.shape: torch.Size([64, 197, 768])
temporal.shape: torch.Size([64, 768])
cls_token.shape: torch.Size([64, 768])
### cls_token.shape: torch.Size([8, 768])
features.shape: torch.Size([8, 768])
pred.shape: torch.Size([8, 2])
label.shape: torch.Size([8])
pred.shape: torch.Size([8, 2])
x.shape: torch.Size([8, 8, 3, 224, 224])
x.ndim: 5
x.shape: torch.Size([64, 3, 224, 224])
batch_size: 64
embeddings.shape: torch.Size([64, 197, 768])
input_ini - x shape before view: torch.Size([8, 8, 196, 768])
input_ini - x shape after first reshape: torch.Size([1568, 8, 768])
input_ini - x shape after cat: torch.Size([1568, 9, 768])
input_ini - x shape before final reshape: torch.Size([1568, 8, 768])
input_ini - x shape after final reshape: torch.Size([8, 196, 8, 768])
input_ini - x shape at end: torch.Size([8, 1568, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
cls_token.shape: torch.Size([8, 8, 1, 768])
patch_token.shape: torch.Size([8, 8, 196, 768])
x.shape: torch.Size([64, 197, 768])
x2.shape: torch.Size([64, 197, 768])
temporal.shape: torch.Size([64, 768])
cls_token.shape: torch.Size([64, 768])
### cls_token.shape: torch.Size([8, 768])
features.shape: torch.Size([8, 768])
pred.shape: torch.Size([8, 2])
label.shape: torch.Size([8])
pred.shape: torch.Size([8, 2])
x.shape: torch.Size([8, 8, 3, 224, 224])
x.ndim: 5
x.shape: torch.Size([64, 3, 224, 224])
batch_size: 64
embeddings.shape: torch.Size([64, 197, 768])
input_ini - x shape before view: torch.Size([8, 8, 196, 768])
input_ini - x shape after first reshape: torch.Size([1568, 8, 768])
input_ini - x shape after cat: torch.Size([1568, 9, 768])
input_ini - x shape before final reshape: torch.Size([1568, 8, 768])
input_ini - x shape after final reshape: torch.Size([8, 196, 8, 768])
input_ini - x shape at end: torch.Size([8, 1568, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
cls_token.shape: torch.Size([8, 8, 1, 768])
patch_token.shape: torch.Size([8, 8, 196, 768])
x.shape: torch.Size([64, 197, 768])
x2.shape: torch.Size([64, 197, 768])
temporal.shape: torch.Size([64, 768])
cls_token.shape: torch.Size([64, 768])
### cls_token.shape: torch.Size([8, 768])
features.shape: torch.Size([8, 768])
pred.shape: torch.Size([8, 2])
label.shape: torch.Size([8])
pred.shape: torch.Size([8, 2])
x.shape: torch.Size([8, 8, 3, 224, 224])
x.ndim: 5
x.shape: torch.Size([64, 3, 224, 224])
batch_size: 64
embeddings.shape: torch.Size([64, 197, 768])
input_ini - x shape before view: torch.Size([8, 8, 196, 768])
input_ini - x shape after first reshape: torch.Size([1568, 8, 768])
input_ini - x shape after cat: torch.Size([1568, 9, 768])
input_ini - x shape before final reshape: torch.Size([1568, 8, 768])
input_ini - x shape after final reshape: torch.Size([8, 196, 8, 768])
input_ini - x shape at end: torch.Size([8, 1568, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
cls_token.shape: torch.Size([8, 8, 1, 768])
patch_token.shape: torch.Size([8, 8, 196, 768])
x.shape: torch.Size([64, 197, 768])
x2.shape: torch.Size([64, 197, 768])
temporal.shape: torch.Size([64, 768])
cls_token.shape: torch.Size([64, 768])
### cls_token.shape: torch.Size([8, 768])
features.shape: torch.Size([8, 768])
pred.shape: torch.Size([8, 2])
label.shape: torch.Size([8])
pred.shape: torch.Size([8, 2])
x.shape: torch.Size([8, 8, 3, 224, 224])
x.ndim: 5
x.shape: torch.Size([64, 3, 224, 224])
batch_size: 64
embeddings.shape: torch.Size([64, 197, 768])
input_ini - x shape before view: torch.Size([8, 8, 196, 768])
input_ini - x shape after first reshape: torch.Size([1568, 8, 768])
input_ini - x shape after cat: torch.Size([1568, 9, 768])
input_ini - x shape before final reshape: torch.Size([1568, 8, 768])
input_ini - x shape after final reshape: torch.Size([8, 196, 8, 768])
input_ini - x shape at end: torch.Size([8, 1568, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
cls_token.shape: torch.Size([8, 8, 1, 768])
patch_token.shape: torch.Size([8, 8, 196, 768])
x.shape: torch.Size([64, 197, 768])
x2.shape: torch.Size([64, 197, 768])
temporal.shape: torch.Size([64, 768])
cls_token.shape: torch.Size([64, 768])
### cls_token.shape: torch.Size([8, 768])
features.shape: torch.Size([8, 768])
pred.shape: torch.Size([8, 2])
label.shape: torch.Size([8])
pred.shape: torch.Size([8, 2])
x.shape: torch.Size([8, 8, 3, 224, 224])
x.ndim: 5
x.shape: torch.Size([64, 3, 224, 224])
batch_size: 64
embeddings.shape: torch.Size([64, 197, 768])
input_ini - x shape before view: torch.Size([8, 8, 196, 768])
input_ini - x shape after first reshape: torch.Size([1568, 8, 768])
input_ini - x shape after cat: torch.Size([1568, 9, 768])
input_ini - x shape before final reshape: torch.Size([1568, 8, 768])
input_ini - x shape after final reshape: torch.Size([8, 196, 8, 768])
input_ini - x shape at end: torch.Size([8, 1568, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
cls_token.shape: torch.Size([8, 8, 1, 768])
patch_token.shape: torch.Size([8, 8, 196, 768])
x.shape: torch.Size([64, 197, 768])
x2.shape: torch.Size([64, 197, 768])
temporal.shape: torch.Size([64, 768])
cls_token.shape: torch.Size([64, 768])
### cls_token.shape: torch.Size([8, 768])
features.shape: torch.Size([8, 768])
pred.shape: torch.Size([8, 2])
label.shape: torch.Size([8])
pred.shape: torch.Size([8, 2])
x.shape: torch.Size([4, 8, 3, 224, 224])
x.ndim: 5
x.shape: torch.Size([32, 3, 224, 224])
batch_size: 32
embeddings.shape: torch.Size([32, 197, 768])
input_ini - x shape before view: torch.Size([4, 8, 196, 768])
input_ini - x shape after first reshape: torch.Size([784, 8, 768])
input_ini - x shape after cat: torch.Size([784, 9, 768])
input_ini - x shape before final reshape: torch.Size([784, 8, 768])
input_ini - x shape after final reshape: torch.Size([4, 196, 8, 768])
input_ini - x shape at end: torch.Size([4, 1568, 768])
x2.shape): torch.Size([4, 1569, 768])
(x1.shape): torch.Size([4, 1569, 768])
(x2.shape): torch.Size([4, 1569, 768])
x2.shape): torch.Size([4, 1569, 768])
(x1.shape): torch.Size([4, 1569, 768])
(x2.shape): torch.Size([4, 1569, 768])
x2.shape): torch.Size([4, 1569, 768])
(x1.shape): torch.Size([4, 1569, 768])
100%|██████████| 13/13 [00:02<00:00,  6.03it/s]
2025-05-30 10:56:21,490 - INFO - dataset: DFDC    step: 5    testing-loss, overall: 0.685546875    
2025-05-30 10:56:21,491 - INFO - dataset: DFDC    step: 5    testing-metric, acc: 0.65    testing-metric, auc: 0.5083516483516484    testing-metric, eer: 0.45714285714285713    testing-metric, ap: 0.7033682945386437    testing-metric, video_auc: 0.5083516483516484    testing-metric, acc_real:0.7714285714285715; acc_fake:0.5846153846153846
2025-05-30 10:56:21,492 - INFO - dataset: avg    step: 5    testing-metric, acc: 0.65    testing-metric, auc: 0.5083516483516484    testing-metric, eer: 0.45714285714285713    testing-metric, ap: 0.7033682945386437    testing-metric, video_auc: 0.5083516483516484    
2025-05-30 10:56:21,492 - INFO - ===> Test Done!
 50%|█████     | 2/4 [00:05<00:05,  2.62s/it] 75%|███████▌  | 3/4 [00:05<00:01,  1.65s/it]2025-05-30 10:56:22,077 - INFO - ===> Test start!
2025-05-30 10:56:22,079 - INFO - data_dict saved to ./logs/training/clip_stan_2025-05-30-10-56-05/test/DFDC/data_dict_test.pickle
(x2.shape): torch.Size([4, 1569, 768])
cls_token.shape: torch.Size([4, 8, 1, 768])
patch_token.shape: torch.Size([4, 8, 196, 768])
x.shape: torch.Size([32, 197, 768])
x2.shape: torch.Size([32, 197, 768])
temporal.shape: torch.Size([32, 768])
cls_token.shape: torch.Size([32, 768])
### cls_token.shape: torch.Size([4, 768])
features.shape: torch.Size([4, 768])
pred.shape: torch.Size([4, 2])
label.shape: torch.Size([4])
pred.shape: torch.Size([4, 2])
len(y_pred): 100
len(y_true): 100
x.shape: torch.Size([32, 8, 3, 224, 224])
x.ndim: 5
x.shape: torch.Size([256, 3, 224, 224])
batch_size: 256
embeddings.shape: torch.Size([256, 197, 768])
input_ini - x shape before view: torch.Size([32, 8, 196, 768])
input_ini - x shape after first reshape: torch.Size([6272, 8, 768])
input_ini - x shape after cat: torch.Size([6272, 9, 768])
input_ini - x shape before final reshape: torch.Size([6272, 8, 768])
input_ini - x shape after final reshape: torch.Size([32, 196, 8, 768])
input_ini - x shape at end: torch.Size([32, 1568, 768])
x2.shape): torch.Size([32, 1569, 768])
(x1.shape): torch.Size([32, 1569, 768])
(x2.shape): torch.Size([32, 1569, 768])
x2.shape): torch.Size([32, 1569, 768])
(x1.shape): torch.Size([32, 1569, 768])
(x2.shape): torch.Size([32, 1569, 768])
x2.shape): torch.Size([32, 1569, 768])
(x1.shape): torch.Size([32, 1569, 768])
(x2.shape): torch.Size([32, 1569, 768])
cls_token.shape: torch.Size([32, 8, 1, 768])
patch_token.shape: torch.Size([32, 8, 196, 768])
x.shape: torch.Size([256, 197, 768])
x2.shape: torch.Size([256, 197, 768])
temporal.shape: torch.Size([256, 768])
cls_token.shape: torch.Size([256, 768])
### cls_token.shape: torch.Size([32, 768])
features.shape: torch.Size([32, 768])
pred.shape: torch.Size([32, 2])
label.shape: torch.Size([32])
pred.shape: torch.Size([32, 2])
x.shape: torch.Size([4, 8, 3, 224, 224])
x.ndim: 5
x.shape: torch.Size([32, 3, 224, 224])
batch_size: 32
embeddings.shape: torch.Size([32, 197, 768])
input_ini - x shape before view: torch.Size([4, 8, 196, 768])
input_ini - x shape after first reshape: torch.Size([784, 8, 768])
input_ini - x shape after cat: torch.Size([784, 9, 768])
input_ini - x shape before final reshape: torch.Size([784, 8, 768])
input_ini - x shape after final reshape: torch.Size([4, 196, 8, 768])
input_ini - x shape at end: torch.Size([4, 1568, 768])
x2.shape): torch.Size([4, 1569, 768])
(x1.shape): torch.Size([4, 1569, 768])
(x2.shape): torch.Size([4, 1569, 768])
x2.shape): torch.Size([4, 1569, 768])
(x1.shape): torch.Size([4, 1569, 768])
(x2.shape): torch.Size([4, 1569, 768])
x2.shape): torch.Size([4, 1569, 768])
(x1.shape): torch.Size([4, 1569, 768])
(x2.shape): torch.Size([4, 1569, 768])
cls_token.shape: torch.Size([4, 8, 1, 768])
patch_token.shape: torch.Size([4, 8, 196, 768])
x.shape: torch.Size([32, 197, 768])
x2.shape: torch.Size([32, 197, 768])
temporal.shape: torch.Size([32, 768])
cls_token.shape: torch.Size([32, 768])
### cls_token.shape: torch.Size([4, 768])
features.shape: torch.Size([4, 768])
pred.shape: torch.Size([4, 2])
label.shape: torch.Size([4])
pred.shape: torch.Size([4, 2])

  0%|          | 0/13 [00:00<?, ?it/s][A
  8%|▊         | 1/13 [00:00<00:07,  1.61it/s][A
 15%|█▌        | 2/13 [00:00<00:03,  2.99it/s][A
 23%|██▎       | 3/13 [00:00<00:02,  4.13it/s][A
 31%|███       | 4/13 [00:01<00:01,  5.03it/s][A
 38%|███▊      | 5/13 [00:01<00:01,  5.71it/s][A
 46%|████▌     | 6/13 [00:01<00:01,  6.22it/s][Ax.shape: torch.Size([8, 8, 3, 224, 224])
x.ndim: 5
x.shape: torch.Size([64, 3, 224, 224])
batch_size: 64
embeddings.shape: torch.Size([64, 197, 768])
input_ini - x shape before view: torch.Size([8, 8, 196, 768])
input_ini - x shape after first reshape: torch.Size([1568, 8, 768])
input_ini - x shape after cat: torch.Size([1568, 9, 768])
input_ini - x shape before final reshape: torch.Size([1568, 8, 768])
input_ini - x shape after final reshape: torch.Size([8, 196, 8, 768])
input_ini - x shape at end: torch.Size([8, 1568, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
cls_token.shape: torch.Size([8, 8, 1, 768])
patch_token.shape: torch.Size([8, 8, 196, 768])
x.shape: torch.Size([64, 197, 768])
x2.shape: torch.Size([64, 197, 768])
temporal.shape: torch.Size([64, 768])
cls_token.shape: torch.Size([64, 768])
### cls_token.shape: torch.Size([8, 768])
features.shape: torch.Size([8, 768])
pred.shape: torch.Size([8, 2])
label.shape: torch.Size([8])
pred.shape: torch.Size([8, 2])
x.shape: torch.Size([8, 8, 3, 224, 224])
x.ndim: 5
x.shape: torch.Size([64, 3, 224, 224])
batch_size: 64
embeddings.shape: torch.Size([64, 197, 768])
input_ini - x shape before view: torch.Size([8, 8, 196, 768])
input_ini - x shape after first reshape: torch.Size([1568, 8, 768])
input_ini - x shape after cat: torch.Size([1568, 9, 768])
input_ini - x shape before final reshape: torch.Size([1568, 8, 768])
input_ini - x shape after final reshape: torch.Size([8, 196, 8, 768])
input_ini - x shape at end: torch.Size([8, 1568, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
cls_token.shape: torch.Size([8, 8, 1, 768])
patch_token.shape: torch.Size([8, 8, 196, 768])
x.shape: torch.Size([64, 197, 768])
x2.shape: torch.Size([64, 197, 768])
temporal.shape: torch.Size([64, 768])
cls_token.shape: torch.Size([64, 768])
### cls_token.shape: torch.Size([8, 768])
features.shape: torch.Size([8, 768])
pred.shape: torch.Size([8, 2])
label.shape: torch.Size([8])
pred.shape: torch.Size([8, 2])
x.shape: torch.Size([8, 8, 3, 224, 224])
x.ndim: 5
x.shape: torch.Size([64, 3, 224, 224])
batch_size: 64
embeddings.shape: torch.Size([64, 197, 768])
input_ini - x shape before view: torch.Size([8, 8, 196, 768])
input_ini - x shape after first reshape: torch.Size([1568, 8, 768])
input_ini - x shape after cat: torch.Size([1568, 9, 768])
input_ini - x shape before final reshape: torch.Size([1568, 8, 768])
input_ini - x shape after final reshape: torch.Size([8, 196, 8, 768])
input_ini - x shape at end: torch.Size([8, 1568, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
cls_token.shape: torch.Size([8, 8, 1, 768])
patch_token.shape: torch.Size([8, 8, 196, 768])
x.shape: torch.Size([64, 197, 768])
x2.shape: torch.Size([64, 197, 768])
temporal.shape: torch.Size([64, 768])
cls_token.shape: torch.Size([64, 768])
### cls_token.shape: torch.Size([8, 768])
features.shape: torch.Size([8, 768])
pred.shape: torch.Size([8, 2])
label.shape: torch.Size([8])
pred.shape: torch.Size([8, 2])
x.shape: torch.Size([8, 8, 3, 224, 224])
x.ndim: 5
x.shape: torch.Size([64, 3, 224, 224])
batch_size: 64
embeddings.shape: torch.Size([64, 197, 768])
input_ini - x shape before view: torch.Size([8, 8, 196, 768])
input_ini - x shape after first reshape: torch.Size([1568, 8, 768])
input_ini - x shape after cat: torch.Size([1568, 9, 768])
input_ini - x shape before final reshape: torch.Size([1568, 8, 768])
input_ini - x shape after final reshape: torch.Size([8, 196, 8, 768])
input_ini - x shape at end: torch.Size([8, 1568, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
cls_token.shape: torch.Size([8, 8, 1, 768])
patch_token.shape: torch.Size([8, 8, 196, 768])
x.shape: torch.Size([64, 197, 768])
x2.shape: torch.Size([64, 197, 768])
temporal.shape: torch.Size([64, 768])
cls_token.shape: torch.Size([64, 768])
### cls_token.shape: torch.Size([8, 768])
features.shape: torch.Size([8, 768])
pred.shape: torch.Size([8, 2])
label.shape: torch.Size([8])
pred.shape: torch.Size([8, 2])
x.shape: torch.Size([8, 8, 3, 224, 224])
x.ndim: 5
x.shape: torch.Size([64, 3, 224, 224])
batch_size: 64
embeddings.shape: torch.Size([64, 197, 768])
input_ini - x shape before view: torch.Size([8, 8, 196, 768])
input_ini - x shape after first reshape: torch.Size([1568, 8, 768])
input_ini - x shape after cat: torch.Size([1568, 9, 768])
input_ini - x shape before final reshape: torch.Size([1568, 8, 768])
input_ini - x shape after final reshape: torch.Size([8, 196, 8, 768])
input_ini - x shape at end: torch.Size([8, 1568, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
cls_token.shape: torch.Size([8, 8, 1, 768])
patch_token.shape: torch.Size([8, 8, 196, 768])
x.shape: torch.Size([64, 197, 768])
x2.shape: torch.Size([64, 197, 768])
temporal.shape: torch.Size([64, 768])
cls_token.shape: torch.Size([64, 768])
### cls_token.shape: torch.Size([8, 768])
features.shape: torch.Size([8, 768])
pred.shape: torch.Size([8, 2])
label.shape: torch.Size([8])
pred.shape: torch.Size([8, 2])
x.shape: torch.Size([8, 8, 3, 224, 224])
x.ndim: 5
x.shape: torch.Size([64, 3, 224, 224])
batch_size: 64
embeddings.shape: torch.Size([64, 197, 768])
input_ini - x shape before view: torch.Size([8, 8, 196, 768])
input_ini - x shape after first reshape: torch.Size([1568, 8, 768])
input_ini - x shape after cat: torch.Size([1568, 9, 768])
input_ini - x shape before final reshape: torch.Size([1568, 8, 768])
input_ini - x shape after final reshape: torch.Size([8, 196, 8, 768])
input_ini - x shape at end: torch.Size([8, 1568, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
cls_token.shape: torch.Size([8, 8, 1, 768])
patch_token.shape: torch.Size([8, 8, 196, 768])
x.shape: torch.Size([64, 197, 768])
x2.shape: torch.Size([64, 197, 768])
temporal.shape: torch.Size([64, 768])
cls_token.shape: torch.Size([64, 768])
### cls_token.shape: torch.Size([8, 768])
features.shape: torch.Size([8, 768])
pred.shape: torch.Size([8, 2])
label.shape: torch.Size([8])
pred.shape: torch.Size([8, 2])
x.shape: torch.Size([8, 8, 3, 224, 224])
x.ndim: 5
x.shape: torch.Size([64, 3, 224, 224])
batch_size: 64
embeddings.shape: torch.Size([64, 197, 768])
input_ini - x shape before view: torch.Size([8, 8, 196, 768])
input_ini - x shape after first reshape: torch.Size([1568, 8, 768])
input_ini - x shape after cat: torch.Size([1568, 9, 768])
input_ini - x shape before final reshape: torch.Size([1568, 8, 768])

 54%|█████▍    | 7/13 [00:01<00:00,  6.60it/s][A
 62%|██████▏   | 8/13 [00:01<00:00,  6.86it/s][A
 69%|██████▉   | 9/13 [00:01<00:00,  7.06it/s][A
 77%|███████▋  | 10/13 [00:01<00:00,  7.19it/s][A
 85%|████████▍ | 11/13 [00:01<00:00,  7.29it/s][A
 92%|█████████▏| 12/13 [00:02<00:00,  7.36it/s][Ainput_ini - x shape after final reshape: torch.Size([8, 196, 8, 768])
input_ini - x shape at end: torch.Size([8, 1568, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
cls_token.shape: torch.Size([8, 8, 1, 768])
patch_token.shape: torch.Size([8, 8, 196, 768])
x.shape: torch.Size([64, 197, 768])
x2.shape: torch.Size([64, 197, 768])
temporal.shape: torch.Size([64, 768])
cls_token.shape: torch.Size([64, 768])
### cls_token.shape: torch.Size([8, 768])
features.shape: torch.Size([8, 768])
pred.shape: torch.Size([8, 2])
label.shape: torch.Size([8])
pred.shape: torch.Size([8, 2])
x.shape: torch.Size([8, 8, 3, 224, 224])
x.ndim: 5
x.shape: torch.Size([64, 3, 224, 224])
batch_size: 64
embeddings.shape: torch.Size([64, 197, 768])
input_ini - x shape before view: torch.Size([8, 8, 196, 768])
input_ini - x shape after first reshape: torch.Size([1568, 8, 768])
input_ini - x shape after cat: torch.Size([1568, 9, 768])
input_ini - x shape before final reshape: torch.Size([1568, 8, 768])
input_ini - x shape after final reshape: torch.Size([8, 196, 8, 768])
input_ini - x shape at end: torch.Size([8, 1568, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
cls_token.shape: torch.Size([8, 8, 1, 768])
patch_token.shape: torch.Size([8, 8, 196, 768])
x.shape: torch.Size([64, 197, 768])
x2.shape: torch.Size([64, 197, 768])
temporal.shape: torch.Size([64, 768])
cls_token.shape: torch.Size([64, 768])
### cls_token.shape: torch.Size([8, 768])
features.shape: torch.Size([8, 768])
pred.shape: torch.Size([8, 2])
label.shape: torch.Size([8])
pred.shape: torch.Size([8, 2])
x.shape: torch.Size([8, 8, 3, 224, 224])
x.ndim: 5
x.shape: torch.Size([64, 3, 224, 224])
batch_size: 64
embeddings.shape: torch.Size([64, 197, 768])
input_ini - x shape before view: torch.Size([8, 8, 196, 768])
input_ini - x shape after first reshape: torch.Size([1568, 8, 768])
input_ini - x shape after cat: torch.Size([1568, 9, 768])
input_ini - x shape before final reshape: torch.Size([1568, 8, 768])
input_ini - x shape after final reshape: torch.Size([8, 196, 8, 768])
input_ini - x shape at end: torch.Size([8, 1568, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
cls_token.shape: torch.Size([8, 8, 1, 768])
patch_token.shape: torch.Size([8, 8, 196, 768])
x.shape: torch.Size([64, 197, 768])
x2.shape: torch.Size([64, 197, 768])
temporal.shape: torch.Size([64, 768])
cls_token.shape: torch.Size([64, 768])
### cls_token.shape: torch.Size([8, 768])
features.shape: torch.Size([8, 768])
pred.shape: torch.Size([8, 2])
label.shape: torch.Size([8])
pred.shape: torch.Size([8, 2])
x.shape: torch.Size([8, 8, 3, 224, 224])
x.ndim: 5
x.shape: torch.Size([64, 3, 224, 224])
batch_size: 64
embeddings.shape: torch.Size([64, 197, 768])
input_ini - x shape before view: torch.Size([8, 8, 196, 768])
input_ini - x shape after first reshape: torch.Size([1568, 8, 768])
input_ini - x shape after cat: torch.Size([1568, 9, 768])
input_ini - x shape before final reshape: torch.Size([1568, 8, 768])
input_ini - x shape after final reshape: torch.Size([8, 196, 8, 768])
input_ini - x shape at end: torch.Size([8, 1568, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
cls_token.shape: torch.Size([8, 8, 1, 768])
patch_token.shape: torch.Size([8, 8, 196, 768])
x.shape: torch.Size([64, 197, 768])
x2.shape: torch.Size([64, 197, 768])
temporal.shape: torch.Size([64, 768])
cls_token.shape: torch.Size([64, 768])
### cls_token.shape: torch.Size([8, 768])
features.shape: torch.Size([8, 768])
pred.shape: torch.Size([8, 2])
label.shape: torch.Size([8])
pred.shape: torch.Size([8, 2])
x.shape: torch.Size([8, 8, 3, 224, 224])
x.ndim: 5
x.shape: torch.Size([64, 3, 224, 224])
batch_size: 64
embeddings.shape: torch.Size([64, 197, 768])
input_ini - x shape before view: torch.Size([8, 8, 196, 768])
input_ini - x shape after first reshape: torch.Size([1568, 8, 768])
input_ini - x shape after cat: torch.Size([1568, 9, 768])
input_ini - x shape before final reshape: torch.Size([1568, 8, 768])
input_ini - x shape after final reshape: torch.Size([8, 196, 8, 768])
input_ini - x shape at end: torch.Size([8, 1568, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
cls_token.shape: torch.Size([8, 8, 1, 768])
patch_token.shape: torch.Size([8, 8, 196, 768])
x.shape: torch.Size([64, 197, 768])
x2.shape: torch.Size([64, 197, 768])
temporal.shape: torch.Size([64, 768])
cls_token.shape: torch.Size([64, 768])
### cls_token.shape: torch.Size([8, 768])
features.shape: torch.Size([8, 768])
pred.shape: torch.Size([8, 2])
label.shape: torch.Size([8])
pred.shape: torch.Size([8, 2])
x.shape: torch.Size([8, 8, 3, 224, 224])
x.ndim: 5
x.shape: torch.Size([64, 3, 224, 224])
batch_size: 64
embeddings.shape: torch.Size([64, 197, 768])
input_ini - x shape before view: torch.Size([8, 8, 196, 768])
input_ini - x shape after first reshape: torch.Size([1568, 8, 768])
input_ini - x shape after cat: torch.Size([1568, 9, 768])
input_ini - x shape before final reshape: torch.Size([1568, 8, 768])
input_ini - x shape after final reshape: torch.Size([8, 196, 8, 768])
input_ini - x shape at end: torch.Size([8, 1568, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
cls_token.shape: torch.Size([8, 8, 1, 768])
patch_token.shape: torch.Size([8, 8, 196, 768])
x.shape: torch.Size([64, 197, 768])
x2.shape: torch.Size([64, 197, 768])
temporal.shape: torch.Size([64, 768])
cls_token.shape: torch.Size([64, 768])
### cls_token.shape: torch.Size([8, 768])
features.shape: torch.Size([8, 768])
pred.shape: torch.Size([8, 2])
label.shape: torch.Size([8])
pred.shape: torch.Size([8, 2])
x.shape: torch.Size([4, 8, 3, 224, 224])
x.ndim: 5
x.shape: torch.Size([32, 3, 224, 224])
batch_size: 32
embeddings.shape: torch.Size([32, 197, 768])
input_ini - x shape before view: torch.Size([4, 8, 196, 768])
input_ini - x shape after first reshape: torch.Size([784, 8, 768])
input_ini - x shape after cat: torch.Size([784, 9, 768])
input_ini - x shape before final reshape: torch.Size([784, 8, 768])
input_ini - x shape after final reshape: torch.Size([4, 196, 8, 768])
input_ini - x shape at end: torch.Size([4, 1568, 768])
x2.shape): torch.Size([4, 1569, 768])
(x1.shape): torch.Size([4, 1569, 768])
(x2.shape): torch.Size([4, 1569, 768])
x2.shape): torch.Size([4, 1569, 768])
(x1.shape): torch.Size([4, 1569, 768])
(x2.shape): torch.Size([4, 1569, 768])
x2.shape): torch.Size([4, 1569, 768])
(x1.shape): torch.Size([4, 1569, 768])
100%|██████████| 13/13 [00:02<00:00,  6.04it/s]
2025-05-30 10:56:24,241 - INFO - dataset: DFDC    step: 7    testing-loss, overall: 0.68505859375    
2025-05-30 10:56:24,241 - INFO - dataset: DFDC    step: 7    testing-metric, acc: 0.65    testing-metric, auc: 0.5063736263736264    testing-metric, eer: 0.4857142857142857    testing-metric, ap: 0.7022699030131765    testing-metric, video_auc: 0.5063736263736264    testing-metric, acc_real:0.7714285714285715; acc_fake:0.5846153846153846
2025-05-30 10:56:24,242 - INFO - dataset: avg    step: 7    testing-metric, acc: 0.65    testing-metric, auc: 0.5063736263736264    testing-metric, eer: 0.4857142857142857    testing-metric, ap: 0.7022699030131765    testing-metric, video_auc: 0.5063736263736264    
2025-05-30 10:56:24,242 - INFO - ===> Test Done!
100%|██████████| 4/4 [00:07<00:00,  1.89s/it]100%|██████████| 4/4 [00:07<00:00,  1.99s/it]
2025-05-30 10:56:24,247 - INFO - ===> Epoch[1] end with testing auc: 
================================ Each dataset best metric ================================ 
| DFDC:  auc=0.5090109890109891 | 
============================================================================================= 
================================== Average best metric ====================================== 
| avg auc: 0.5090109890109891 | 
| DFDC: 0.5090109890109891 | 
=============================================================================================!
2025-05-30 10:56:24,247 - INFO - ===> Epoch[2] start!
2025-05-30 10:56:24,248 - INFO - data_dict saved to ./logs/training/clip_stan_2025-05-30-10-56-05/train/FaceForensics++/data_dict_train.pickle
(x2.shape): torch.Size([4, 1569, 768])
cls_token.shape: torch.Size([4, 8, 1, 768])
patch_token.shape: torch.Size([4, 8, 196, 768])
x.shape: torch.Size([32, 197, 768])
x2.shape: torch.Size([32, 197, 768])
temporal.shape: torch.Size([32, 768])
cls_token.shape: torch.Size([32, 768])
### cls_token.shape: torch.Size([4, 768])
features.shape: torch.Size([4, 768])
pred.shape: torch.Size([4, 2])
label.shape: torch.Size([4])
pred.shape: torch.Size([4, 2])
len(y_pred): 100
len(y_true): 100
  0%|          | 0/4 [00:00<?, ?it/s]2025-05-30 10:56:26,611 - INFO - Iter: 8    training-loss, overall: 0.680145263671875    
2025-05-30 10:56:26,611 - INFO - Iter: 8    training-metric, acc: 0.84375    training-metric, auc: 0.701923076923077    training-metric, eer: 0.3333333333333333    training-metric, ap: 0.8879668096877236    
 25%|██▌       | 1/4 [00:02<00:07,  2.36s/it]2025-05-30 10:56:27,126 - INFO - ===> Test start!
2025-05-30 10:56:27,129 - INFO - data_dict saved to ./logs/training/clip_stan_2025-05-30-10-56-05/test/DFDC/data_dict_test.pickle
x.shape: torch.Size([32, 8, 3, 224, 224])
x.ndim: 5
x.shape: torch.Size([256, 3, 224, 224])
batch_size: 256
embeddings.shape: torch.Size([256, 197, 768])
input_ini - x shape before view: torch.Size([32, 8, 196, 768])
input_ini - x shape after first reshape: torch.Size([6272, 8, 768])
input_ini - x shape after cat: torch.Size([6272, 9, 768])
input_ini - x shape before final reshape: torch.Size([6272, 8, 768])
input_ini - x shape after final reshape: torch.Size([32, 196, 8, 768])
input_ini - x shape at end: torch.Size([32, 1568, 768])
x2.shape): torch.Size([32, 1569, 768])
(x1.shape): torch.Size([32, 1569, 768])
(x2.shape): torch.Size([32, 1569, 768])
x2.shape): torch.Size([32, 1569, 768])
(x1.shape): torch.Size([32, 1569, 768])
(x2.shape): torch.Size([32, 1569, 768])
x2.shape): torch.Size([32, 1569, 768])
(x1.shape): torch.Size([32, 1569, 768])
(x2.shape): torch.Size([32, 1569, 768])
cls_token.shape: torch.Size([32, 8, 1, 768])
patch_token.shape: torch.Size([32, 8, 196, 768])
x.shape: torch.Size([256, 197, 768])
x2.shape: torch.Size([256, 197, 768])
temporal.shape: torch.Size([256, 768])
cls_token.shape: torch.Size([256, 768])
### cls_token.shape: torch.Size([32, 768])
features.shape: torch.Size([32, 768])
pred.shape: torch.Size([32, 2])
label.shape: torch.Size([32])
pred.shape: torch.Size([32, 2])
x.shape: torch.Size([32, 8, 3, 224, 224])
x.ndim: 5
x.shape: torch.Size([256, 3, 224, 224])
batch_size: 256
embeddings.shape: torch.Size([256, 197, 768])
input_ini - x shape before view: torch.Size([32, 8, 196, 768])
input_ini - x shape after first reshape: torch.Size([6272, 8, 768])
input_ini - x shape after cat: torch.Size([6272, 9, 768])
input_ini - x shape before final reshape: torch.Size([6272, 8, 768])
input_ini - x shape after final reshape: torch.Size([32, 196, 8, 768])
input_ini - x shape at end: torch.Size([32, 1568, 768])
x2.shape): torch.Size([32, 1569, 768])
(x1.shape): torch.Size([32, 1569, 768])
(x2.shape): torch.Size([32, 1569, 768])
x2.shape): torch.Size([32, 1569, 768])
(x1.shape): torch.Size([32, 1569, 768])
(x2.shape): torch.Size([32, 1569, 768])
x2.shape): torch.Size([32, 1569, 768])
(x1.shape): torch.Size([32, 1569, 768])
(x2.shape): torch.Size([32, 1569, 768])
cls_token.shape: torch.Size([32, 8, 1, 768])
patch_token.shape: torch.Size([32, 8, 196, 768])
x.shape: torch.Size([256, 197, 768])
x2.shape: torch.Size([256, 197, 768])
temporal.shape: torch.Size([256, 768])
cls_token.shape: torch.Size([256, 768])
### cls_token.shape: torch.Size([32, 768])
features.shape: torch.Size([32, 768])
pred.shape: torch.Size([32, 2])
label.shape: torch.Size([32])
pred.shape: torch.Size([32, 2])

  0%|          | 0/13 [00:00<?, ?it/s][A
  8%|▊         | 1/13 [00:00<00:07,  1.54it/s][A
 15%|█▌        | 2/13 [00:00<00:03,  2.89it/s][A
 23%|██▎       | 3/13 [00:00<00:02,  4.02it/s][A
 31%|███       | 4/13 [00:01<00:01,  4.92it/s][A
 38%|███▊      | 5/13 [00:01<00:01,  5.61it/s][A
 46%|████▌     | 6/13 [00:01<00:01,  6.14it/s][Ax.shape: torch.Size([8, 8, 3, 224, 224])
x.ndim: 5
x.shape: torch.Size([64, 3, 224, 224])
batch_size: 64
embeddings.shape: torch.Size([64, 197, 768])
input_ini - x shape before view: torch.Size([8, 8, 196, 768])
input_ini - x shape after first reshape: torch.Size([1568, 8, 768])
input_ini - x shape after cat: torch.Size([1568, 9, 768])
input_ini - x shape before final reshape: torch.Size([1568, 8, 768])
input_ini - x shape after final reshape: torch.Size([8, 196, 8, 768])
input_ini - x shape at end: torch.Size([8, 1568, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
cls_token.shape: torch.Size([8, 8, 1, 768])
patch_token.shape: torch.Size([8, 8, 196, 768])
x.shape: torch.Size([64, 197, 768])
x2.shape: torch.Size([64, 197, 768])
temporal.shape: torch.Size([64, 768])
cls_token.shape: torch.Size([64, 768])
### cls_token.shape: torch.Size([8, 768])
features.shape: torch.Size([8, 768])
pred.shape: torch.Size([8, 2])
label.shape: torch.Size([8])
pred.shape: torch.Size([8, 2])
x.shape: torch.Size([8, 8, 3, 224, 224])
x.ndim: 5
x.shape: torch.Size([64, 3, 224, 224])
batch_size: 64
embeddings.shape: torch.Size([64, 197, 768])
input_ini - x shape before view: torch.Size([8, 8, 196, 768])
input_ini - x shape after first reshape: torch.Size([1568, 8, 768])
input_ini - x shape after cat: torch.Size([1568, 9, 768])
input_ini - x shape before final reshape: torch.Size([1568, 8, 768])
input_ini - x shape after final reshape: torch.Size([8, 196, 8, 768])
input_ini - x shape at end: torch.Size([8, 1568, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
cls_token.shape: torch.Size([8, 8, 1, 768])
patch_token.shape: torch.Size([8, 8, 196, 768])
x.shape: torch.Size([64, 197, 768])
x2.shape: torch.Size([64, 197, 768])
temporal.shape: torch.Size([64, 768])
cls_token.shape: torch.Size([64, 768])
### cls_token.shape: torch.Size([8, 768])
features.shape: torch.Size([8, 768])
pred.shape: torch.Size([8, 2])
label.shape: torch.Size([8])
pred.shape: torch.Size([8, 2])
x.shape: torch.Size([8, 8, 3, 224, 224])
x.ndim: 5
x.shape: torch.Size([64, 3, 224, 224])
batch_size: 64
embeddings.shape: torch.Size([64, 197, 768])
input_ini - x shape before view: torch.Size([8, 8, 196, 768])
input_ini - x shape after first reshape: torch.Size([1568, 8, 768])
input_ini - x shape after cat: torch.Size([1568, 9, 768])
input_ini - x shape before final reshape: torch.Size([1568, 8, 768])
input_ini - x shape after final reshape: torch.Size([8, 196, 8, 768])
input_ini - x shape at end: torch.Size([8, 1568, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
cls_token.shape: torch.Size([8, 8, 1, 768])
patch_token.shape: torch.Size([8, 8, 196, 768])
x.shape: torch.Size([64, 197, 768])
x2.shape: torch.Size([64, 197, 768])
temporal.shape: torch.Size([64, 768])
cls_token.shape: torch.Size([64, 768])
### cls_token.shape: torch.Size([8, 768])
features.shape: torch.Size([8, 768])
pred.shape: torch.Size([8, 2])
label.shape: torch.Size([8])
pred.shape: torch.Size([8, 2])
x.shape: torch.Size([8, 8, 3, 224, 224])
x.ndim: 5
x.shape: torch.Size([64, 3, 224, 224])
batch_size: 64
embeddings.shape: torch.Size([64, 197, 768])
input_ini - x shape before view: torch.Size([8, 8, 196, 768])
input_ini - x shape after first reshape: torch.Size([1568, 8, 768])
input_ini - x shape after cat: torch.Size([1568, 9, 768])
input_ini - x shape before final reshape: torch.Size([1568, 8, 768])
input_ini - x shape after final reshape: torch.Size([8, 196, 8, 768])
input_ini - x shape at end: torch.Size([8, 1568, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
cls_token.shape: torch.Size([8, 8, 1, 768])
patch_token.shape: torch.Size([8, 8, 196, 768])
x.shape: torch.Size([64, 197, 768])
x2.shape: torch.Size([64, 197, 768])
temporal.shape: torch.Size([64, 768])
cls_token.shape: torch.Size([64, 768])
### cls_token.shape: torch.Size([8, 768])
features.shape: torch.Size([8, 768])
pred.shape: torch.Size([8, 2])
label.shape: torch.Size([8])
pred.shape: torch.Size([8, 2])
x.shape: torch.Size([8, 8, 3, 224, 224])
x.ndim: 5
x.shape: torch.Size([64, 3, 224, 224])
batch_size: 64
embeddings.shape: torch.Size([64, 197, 768])
input_ini - x shape before view: torch.Size([8, 8, 196, 768])
input_ini - x shape after first reshape: torch.Size([1568, 8, 768])
input_ini - x shape after cat: torch.Size([1568, 9, 768])
input_ini - x shape before final reshape: torch.Size([1568, 8, 768])
input_ini - x shape after final reshape: torch.Size([8, 196, 8, 768])
input_ini - x shape at end: torch.Size([8, 1568, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
cls_token.shape: torch.Size([8, 8, 1, 768])
patch_token.shape: torch.Size([8, 8, 196, 768])
x.shape: torch.Size([64, 197, 768])
x2.shape: torch.Size([64, 197, 768])
temporal.shape: torch.Size([64, 768])
cls_token.shape: torch.Size([64, 768])
### cls_token.shape: torch.Size([8, 768])
features.shape: torch.Size([8, 768])
pred.shape: torch.Size([8, 2])
label.shape: torch.Size([8])
pred.shape: torch.Size([8, 2])
x.shape: torch.Size([8, 8, 3, 224, 224])
x.ndim: 5
x.shape: torch.Size([64, 3, 224, 224])
batch_size: 64
embeddings.shape: torch.Size([64, 197, 768])
input_ini - x shape before view: torch.Size([8, 8, 196, 768])
input_ini - x shape after first reshape: torch.Size([1568, 8, 768])
input_ini - x shape after cat: torch.Size([1568, 9, 768])
input_ini - x shape before final reshape: torch.Size([1568, 8, 768])
input_ini - x shape after final reshape: torch.Size([8, 196, 8, 768])
input_ini - x shape at end: torch.Size([8, 1568, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
cls_token.shape: torch.Size([8, 8, 1, 768])
patch_token.shape: torch.Size([8, 8, 196, 768])
x.shape: torch.Size([64, 197, 768])
x2.shape: torch.Size([64, 197, 768])
temporal.shape: torch.Size([64, 768])
cls_token.shape: torch.Size([64, 768])
### cls_token.shape: torch.Size([8, 768])
features.shape: torch.Size([8, 768])
pred.shape: torch.Size([8, 2])
label.shape: torch.Size([8])
pred.shape: torch.Size([8, 2])
x.shape: torch.Size([8, 8, 3, 224, 224])
x.ndim: 5
x.shape: torch.Size([64, 3, 224, 224])
batch_size: 64
embeddings.shape: torch.Size([64, 197, 768])
input_ini - x shape before view: torch.Size([8, 8, 196, 768])
input_ini - x shape after first reshape: torch.Size([1568, 8, 768])
input_ini - x shape after cat: torch.Size([1568, 9, 768])
input_ini - x shape before final reshape: torch.Size([1568, 8, 768])

 54%|█████▍    | 7/13 [00:01<00:00,  6.53it/s][A
 62%|██████▏   | 8/13 [00:01<00:00,  6.81it/s][A
 69%|██████▉   | 9/13 [00:01<00:00,  7.01it/s][A
 77%|███████▋  | 10/13 [00:01<00:00,  7.15it/s][A
 85%|████████▍ | 11/13 [00:01<00:00,  7.26it/s][A
 92%|█████████▏| 12/13 [00:02<00:00,  7.33it/s][Ainput_ini - x shape after final reshape: torch.Size([8, 196, 8, 768])
input_ini - x shape at end: torch.Size([8, 1568, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
cls_token.shape: torch.Size([8, 8, 1, 768])
patch_token.shape: torch.Size([8, 8, 196, 768])
x.shape: torch.Size([64, 197, 768])
x2.shape: torch.Size([64, 197, 768])
temporal.shape: torch.Size([64, 768])
cls_token.shape: torch.Size([64, 768])
### cls_token.shape: torch.Size([8, 768])
features.shape: torch.Size([8, 768])
pred.shape: torch.Size([8, 2])
label.shape: torch.Size([8])
pred.shape: torch.Size([8, 2])
x.shape: torch.Size([8, 8, 3, 224, 224])
x.ndim: 5
x.shape: torch.Size([64, 3, 224, 224])
batch_size: 64
embeddings.shape: torch.Size([64, 197, 768])
input_ini - x shape before view: torch.Size([8, 8, 196, 768])
input_ini - x shape after first reshape: torch.Size([1568, 8, 768])
input_ini - x shape after cat: torch.Size([1568, 9, 768])
input_ini - x shape before final reshape: torch.Size([1568, 8, 768])
input_ini - x shape after final reshape: torch.Size([8, 196, 8, 768])
input_ini - x shape at end: torch.Size([8, 1568, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
cls_token.shape: torch.Size([8, 8, 1, 768])
patch_token.shape: torch.Size([8, 8, 196, 768])
x.shape: torch.Size([64, 197, 768])
x2.shape: torch.Size([64, 197, 768])
temporal.shape: torch.Size([64, 768])
cls_token.shape: torch.Size([64, 768])
### cls_token.shape: torch.Size([8, 768])
features.shape: torch.Size([8, 768])
pred.shape: torch.Size([8, 2])
label.shape: torch.Size([8])
pred.shape: torch.Size([8, 2])
x.shape: torch.Size([8, 8, 3, 224, 224])
x.ndim: 5
x.shape: torch.Size([64, 3, 224, 224])
batch_size: 64
embeddings.shape: torch.Size([64, 197, 768])
input_ini - x shape before view: torch.Size([8, 8, 196, 768])
input_ini - x shape after first reshape: torch.Size([1568, 8, 768])
input_ini - x shape after cat: torch.Size([1568, 9, 768])
input_ini - x shape before final reshape: torch.Size([1568, 8, 768])
input_ini - x shape after final reshape: torch.Size([8, 196, 8, 768])
input_ini - x shape at end: torch.Size([8, 1568, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
cls_token.shape: torch.Size([8, 8, 1, 768])
patch_token.shape: torch.Size([8, 8, 196, 768])
x.shape: torch.Size([64, 197, 768])
x2.shape: torch.Size([64, 197, 768])
temporal.shape: torch.Size([64, 768])
cls_token.shape: torch.Size([64, 768])
### cls_token.shape: torch.Size([8, 768])
features.shape: torch.Size([8, 768])
pred.shape: torch.Size([8, 2])
label.shape: torch.Size([8])
pred.shape: torch.Size([8, 2])
x.shape: torch.Size([8, 8, 3, 224, 224])
x.ndim: 5
x.shape: torch.Size([64, 3, 224, 224])
batch_size: 64
embeddings.shape: torch.Size([64, 197, 768])
input_ini - x shape before view: torch.Size([8, 8, 196, 768])
input_ini - x shape after first reshape: torch.Size([1568, 8, 768])
input_ini - x shape after cat: torch.Size([1568, 9, 768])
input_ini - x shape before final reshape: torch.Size([1568, 8, 768])
input_ini - x shape after final reshape: torch.Size([8, 196, 8, 768])
input_ini - x shape at end: torch.Size([8, 1568, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
cls_token.shape: torch.Size([8, 8, 1, 768])
patch_token.shape: torch.Size([8, 8, 196, 768])
x.shape: torch.Size([64, 197, 768])
x2.shape: torch.Size([64, 197, 768])
temporal.shape: torch.Size([64, 768])
cls_token.shape: torch.Size([64, 768])
### cls_token.shape: torch.Size([8, 768])
features.shape: torch.Size([8, 768])
pred.shape: torch.Size([8, 2])
label.shape: torch.Size([8])
pred.shape: torch.Size([8, 2])
x.shape: torch.Size([8, 8, 3, 224, 224])
x.ndim: 5
x.shape: torch.Size([64, 3, 224, 224])
batch_size: 64
embeddings.shape: torch.Size([64, 197, 768])
input_ini - x shape before view: torch.Size([8, 8, 196, 768])
input_ini - x shape after first reshape: torch.Size([1568, 8, 768])
input_ini - x shape after cat: torch.Size([1568, 9, 768])
input_ini - x shape before final reshape: torch.Size([1568, 8, 768])
input_ini - x shape after final reshape: torch.Size([8, 196, 8, 768])
input_ini - x shape at end: torch.Size([8, 1568, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
cls_token.shape: torch.Size([8, 8, 1, 768])
patch_token.shape: torch.Size([8, 8, 196, 768])
x.shape: torch.Size([64, 197, 768])
x2.shape: torch.Size([64, 197, 768])
temporal.shape: torch.Size([64, 768])
cls_token.shape: torch.Size([64, 768])
### cls_token.shape: torch.Size([8, 768])
features.shape: torch.Size([8, 768])
pred.shape: torch.Size([8, 2])
label.shape: torch.Size([8])
pred.shape: torch.Size([8, 2])
x.shape: torch.Size([8, 8, 3, 224, 224])
x.ndim: 5
x.shape: torch.Size([64, 3, 224, 224])
batch_size: 64
embeddings.shape: torch.Size([64, 197, 768])
input_ini - x shape before view: torch.Size([8, 8, 196, 768])
input_ini - x shape after first reshape: torch.Size([1568, 8, 768])
input_ini - x shape after cat: torch.Size([1568, 9, 768])
input_ini - x shape before final reshape: torch.Size([1568, 8, 768])
input_ini - x shape after final reshape: torch.Size([8, 196, 8, 768])
input_ini - x shape at end: torch.Size([8, 1568, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
cls_token.shape: torch.Size([8, 8, 1, 768])
patch_token.shape: torch.Size([8, 8, 196, 768])
x.shape: torch.Size([64, 197, 768])
x2.shape: torch.Size([64, 197, 768])
temporal.shape: torch.Size([64, 768])
cls_token.shape: torch.Size([64, 768])
### cls_token.shape: torch.Size([8, 768])
features.shape: torch.Size([8, 768])
pred.shape: torch.Size([8, 2])
label.shape: torch.Size([8])
pred.shape: torch.Size([8, 2])
x.shape: torch.Size([4, 8, 3, 224, 224])
x.ndim: 5
x.shape: torch.Size([32, 3, 224, 224])
batch_size: 32
embeddings.shape: torch.Size([32, 197, 768])
input_ini - x shape before view: torch.Size([4, 8, 196, 768])
input_ini - x shape after first reshape: torch.Size([784, 8, 768])
input_ini - x shape after cat: torch.Size([784, 9, 768])
input_ini - x shape before final reshape: torch.Size([784, 8, 768])
input_ini - x shape after final reshape: torch.Size([4, 196, 8, 768])
input_ini - x shape at end: torch.Size([4, 1568, 768])
x2.shape): torch.Size([4, 1569, 768])
(x1.shape): torch.Size([4, 1569, 768])
(x2.shape): torch.Size([4, 1569, 768])
x2.shape): torch.Size([4, 1569, 768])
(x1.shape): torch.Size([4, 1569, 768])
(x2.shape): torch.Size([4, 1569, 768])
x2.shape): torch.Size([4, 1569, 768])
(x1.shape): torch.Size([4, 1569, 768])
100%|██████████| 13/13 [00:02<00:00,  5.95it/s]
2025-05-30 10:56:29,327 - INFO - dataset: DFDC    step: 9    testing-loss, overall: 0.6845703125    
2025-05-30 10:56:29,328 - INFO - dataset: DFDC    step: 9    testing-metric, acc: 0.65    testing-metric, auc: 0.5068131868131869    testing-metric, eer: 0.4857142857142857    testing-metric, ap: 0.702999476278336    testing-metric, video_auc: 0.5068131868131869    testing-metric, acc_real:0.7714285714285715; acc_fake:0.5846153846153846
2025-05-30 10:56:29,329 - INFO - dataset: avg    step: 9    testing-metric, acc: 0.65    testing-metric, auc: 0.5068131868131869    testing-metric, eer: 0.4857142857142857    testing-metric, ap: 0.702999476278336    testing-metric, video_auc: 0.5068131868131869    
2025-05-30 10:56:29,329 - INFO - ===> Test Done!
 50%|█████     | 2/4 [00:05<00:05,  2.57s/it] 75%|███████▌  | 3/4 [00:05<00:01,  1.63s/it]2025-05-30 10:56:29,920 - INFO - ===> Test start!
2025-05-30 10:56:29,923 - INFO - data_dict saved to ./logs/training/clip_stan_2025-05-30-10-56-05/test/DFDC/data_dict_test.pickle
(x2.shape): torch.Size([4, 1569, 768])
cls_token.shape: torch.Size([4, 8, 1, 768])
patch_token.shape: torch.Size([4, 8, 196, 768])
x.shape: torch.Size([32, 197, 768])
x2.shape: torch.Size([32, 197, 768])
temporal.shape: torch.Size([32, 768])
cls_token.shape: torch.Size([32, 768])
### cls_token.shape: torch.Size([4, 768])
features.shape: torch.Size([4, 768])
pred.shape: torch.Size([4, 2])
label.shape: torch.Size([4])
pred.shape: torch.Size([4, 2])
len(y_pred): 100
len(y_true): 100
x.shape: torch.Size([32, 8, 3, 224, 224])
x.ndim: 5
x.shape: torch.Size([256, 3, 224, 224])
batch_size: 256
embeddings.shape: torch.Size([256, 197, 768])
input_ini - x shape before view: torch.Size([32, 8, 196, 768])
input_ini - x shape after first reshape: torch.Size([6272, 8, 768])
input_ini - x shape after cat: torch.Size([6272, 9, 768])
input_ini - x shape before final reshape: torch.Size([6272, 8, 768])
input_ini - x shape after final reshape: torch.Size([32, 196, 8, 768])
input_ini - x shape at end: torch.Size([32, 1568, 768])
x2.shape): torch.Size([32, 1569, 768])
(x1.shape): torch.Size([32, 1569, 768])
(x2.shape): torch.Size([32, 1569, 768])
x2.shape): torch.Size([32, 1569, 768])
(x1.shape): torch.Size([32, 1569, 768])
(x2.shape): torch.Size([32, 1569, 768])
x2.shape): torch.Size([32, 1569, 768])
(x1.shape): torch.Size([32, 1569, 768])
(x2.shape): torch.Size([32, 1569, 768])
cls_token.shape: torch.Size([32, 8, 1, 768])
patch_token.shape: torch.Size([32, 8, 196, 768])
x.shape: torch.Size([256, 197, 768])
x2.shape: torch.Size([256, 197, 768])
temporal.shape: torch.Size([256, 768])
cls_token.shape: torch.Size([256, 768])
### cls_token.shape: torch.Size([32, 768])
features.shape: torch.Size([32, 768])
pred.shape: torch.Size([32, 2])
label.shape: torch.Size([32])
pred.shape: torch.Size([32, 2])
x.shape: torch.Size([4, 8, 3, 224, 224])
x.ndim: 5
x.shape: torch.Size([32, 3, 224, 224])
batch_size: 32
embeddings.shape: torch.Size([32, 197, 768])
input_ini - x shape before view: torch.Size([4, 8, 196, 768])
input_ini - x shape after first reshape: torch.Size([784, 8, 768])
input_ini - x shape after cat: torch.Size([784, 9, 768])
input_ini - x shape before final reshape: torch.Size([784, 8, 768])
input_ini - x shape after final reshape: torch.Size([4, 196, 8, 768])
input_ini - x shape at end: torch.Size([4, 1568, 768])
x2.shape): torch.Size([4, 1569, 768])
(x1.shape): torch.Size([4, 1569, 768])
(x2.shape): torch.Size([4, 1569, 768])
x2.shape): torch.Size([4, 1569, 768])
(x1.shape): torch.Size([4, 1569, 768])
(x2.shape): torch.Size([4, 1569, 768])
x2.shape): torch.Size([4, 1569, 768])
(x1.shape): torch.Size([4, 1569, 768])
(x2.shape): torch.Size([4, 1569, 768])
cls_token.shape: torch.Size([4, 8, 1, 768])
patch_token.shape: torch.Size([4, 8, 196, 768])
x.shape: torch.Size([32, 197, 768])
x2.shape: torch.Size([32, 197, 768])
temporal.shape: torch.Size([32, 768])
cls_token.shape: torch.Size([32, 768])
### cls_token.shape: torch.Size([4, 768])
features.shape: torch.Size([4, 768])
pred.shape: torch.Size([4, 2])
label.shape: torch.Size([4])
pred.shape: torch.Size([4, 2])

  0%|          | 0/13 [00:00<?, ?it/s][A
  8%|▊         | 1/13 [00:00<00:08,  1.48it/s][A
 15%|█▌        | 2/13 [00:00<00:03,  2.80it/s][A
 23%|██▎       | 3/13 [00:00<00:02,  3.93it/s][A
 31%|███       | 4/13 [00:01<00:01,  4.84it/s][A
 38%|███▊      | 5/13 [00:01<00:01,  5.55it/s][A
 46%|████▌     | 6/13 [00:01<00:01,  6.09it/s][Ax.shape: torch.Size([8, 8, 3, 224, 224])
x.ndim: 5
x.shape: torch.Size([64, 3, 224, 224])
batch_size: 64
embeddings.shape: torch.Size([64, 197, 768])
input_ini - x shape before view: torch.Size([8, 8, 196, 768])
input_ini - x shape after first reshape: torch.Size([1568, 8, 768])
input_ini - x shape after cat: torch.Size([1568, 9, 768])
input_ini - x shape before final reshape: torch.Size([1568, 8, 768])
input_ini - x shape after final reshape: torch.Size([8, 196, 8, 768])
input_ini - x shape at end: torch.Size([8, 1568, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
cls_token.shape: torch.Size([8, 8, 1, 768])
patch_token.shape: torch.Size([8, 8, 196, 768])
x.shape: torch.Size([64, 197, 768])
x2.shape: torch.Size([64, 197, 768])
temporal.shape: torch.Size([64, 768])
cls_token.shape: torch.Size([64, 768])
### cls_token.shape: torch.Size([8, 768])
features.shape: torch.Size([8, 768])
pred.shape: torch.Size([8, 2])
label.shape: torch.Size([8])
pred.shape: torch.Size([8, 2])
x.shape: torch.Size([8, 8, 3, 224, 224])
x.ndim: 5
x.shape: torch.Size([64, 3, 224, 224])
batch_size: 64
embeddings.shape: torch.Size([64, 197, 768])
input_ini - x shape before view: torch.Size([8, 8, 196, 768])
input_ini - x shape after first reshape: torch.Size([1568, 8, 768])
input_ini - x shape after cat: torch.Size([1568, 9, 768])
input_ini - x shape before final reshape: torch.Size([1568, 8, 768])
input_ini - x shape after final reshape: torch.Size([8, 196, 8, 768])
input_ini - x shape at end: torch.Size([8, 1568, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
cls_token.shape: torch.Size([8, 8, 1, 768])
patch_token.shape: torch.Size([8, 8, 196, 768])
x.shape: torch.Size([64, 197, 768])
x2.shape: torch.Size([64, 197, 768])
temporal.shape: torch.Size([64, 768])
cls_token.shape: torch.Size([64, 768])
### cls_token.shape: torch.Size([8, 768])
features.shape: torch.Size([8, 768])
pred.shape: torch.Size([8, 2])
label.shape: torch.Size([8])
pred.shape: torch.Size([8, 2])
x.shape: torch.Size([8, 8, 3, 224, 224])
x.ndim: 5
x.shape: torch.Size([64, 3, 224, 224])
batch_size: 64
embeddings.shape: torch.Size([64, 197, 768])
input_ini - x shape before view: torch.Size([8, 8, 196, 768])
input_ini - x shape after first reshape: torch.Size([1568, 8, 768])
input_ini - x shape after cat: torch.Size([1568, 9, 768])
input_ini - x shape before final reshape: torch.Size([1568, 8, 768])
input_ini - x shape after final reshape: torch.Size([8, 196, 8, 768])
input_ini - x shape at end: torch.Size([8, 1568, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
cls_token.shape: torch.Size([8, 8, 1, 768])
patch_token.shape: torch.Size([8, 8, 196, 768])
x.shape: torch.Size([64, 197, 768])
x2.shape: torch.Size([64, 197, 768])
temporal.shape: torch.Size([64, 768])
cls_token.shape: torch.Size([64, 768])
### cls_token.shape: torch.Size([8, 768])
features.shape: torch.Size([8, 768])
pred.shape: torch.Size([8, 2])
label.shape: torch.Size([8])
pred.shape: torch.Size([8, 2])
x.shape: torch.Size([8, 8, 3, 224, 224])
x.ndim: 5
x.shape: torch.Size([64, 3, 224, 224])
batch_size: 64
embeddings.shape: torch.Size([64, 197, 768])
input_ini - x shape before view: torch.Size([8, 8, 196, 768])
input_ini - x shape after first reshape: torch.Size([1568, 8, 768])
input_ini - x shape after cat: torch.Size([1568, 9, 768])
input_ini - x shape before final reshape: torch.Size([1568, 8, 768])
input_ini - x shape after final reshape: torch.Size([8, 196, 8, 768])
input_ini - x shape at end: torch.Size([8, 1568, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
cls_token.shape: torch.Size([8, 8, 1, 768])
patch_token.shape: torch.Size([8, 8, 196, 768])
x.shape: torch.Size([64, 197, 768])
x2.shape: torch.Size([64, 197, 768])
temporal.shape: torch.Size([64, 768])
cls_token.shape: torch.Size([64, 768])
### cls_token.shape: torch.Size([8, 768])
features.shape: torch.Size([8, 768])
pred.shape: torch.Size([8, 2])
label.shape: torch.Size([8])
pred.shape: torch.Size([8, 2])
x.shape: torch.Size([8, 8, 3, 224, 224])
x.ndim: 5
x.shape: torch.Size([64, 3, 224, 224])
batch_size: 64
embeddings.shape: torch.Size([64, 197, 768])
input_ini - x shape before view: torch.Size([8, 8, 196, 768])
input_ini - x shape after first reshape: torch.Size([1568, 8, 768])
input_ini - x shape after cat: torch.Size([1568, 9, 768])
input_ini - x shape before final reshape: torch.Size([1568, 8, 768])
input_ini - x shape after final reshape: torch.Size([8, 196, 8, 768])
input_ini - x shape at end: torch.Size([8, 1568, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
cls_token.shape: torch.Size([8, 8, 1, 768])
patch_token.shape: torch.Size([8, 8, 196, 768])
x.shape: torch.Size([64, 197, 768])
x2.shape: torch.Size([64, 197, 768])
temporal.shape: torch.Size([64, 768])
cls_token.shape: torch.Size([64, 768])
### cls_token.shape: torch.Size([8, 768])
features.shape: torch.Size([8, 768])
pred.shape: torch.Size([8, 2])
label.shape: torch.Size([8])
pred.shape: torch.Size([8, 2])
x.shape: torch.Size([8, 8, 3, 224, 224])
x.ndim: 5
x.shape: torch.Size([64, 3, 224, 224])
batch_size: 64
embeddings.shape: torch.Size([64, 197, 768])
input_ini - x shape before view: torch.Size([8, 8, 196, 768])
input_ini - x shape after first reshape: torch.Size([1568, 8, 768])
input_ini - x shape after cat: torch.Size([1568, 9, 768])
input_ini - x shape before final reshape: torch.Size([1568, 8, 768])
input_ini - x shape after final reshape: torch.Size([8, 196, 8, 768])
input_ini - x shape at end: torch.Size([8, 1568, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
cls_token.shape: torch.Size([8, 8, 1, 768])
patch_token.shape: torch.Size([8, 8, 196, 768])
x.shape: torch.Size([64, 197, 768])
x2.shape: torch.Size([64, 197, 768])
temporal.shape: torch.Size([64, 768])
cls_token.shape: torch.Size([64, 768])
### cls_token.shape: torch.Size([8, 768])
features.shape: torch.Size([8, 768])
pred.shape: torch.Size([8, 2])
label.shape: torch.Size([8])
pred.shape: torch.Size([8, 2])
x.shape: torch.Size([8, 8, 3, 224, 224])
x.ndim: 5
x.shape: torch.Size([64, 3, 224, 224])
batch_size: 64
embeddings.shape: torch.Size([64, 197, 768])
input_ini - x shape before view: torch.Size([8, 8, 196, 768])
input_ini - x shape after first reshape: torch.Size([1568, 8, 768])
input_ini - x shape after cat: torch.Size([1568, 9, 768])
input_ini - x shape before final reshape: torch.Size([1568, 8, 768])

 54%|█████▍    | 7/13 [00:01<00:00,  6.49it/s][A
 62%|██████▏   | 8/13 [00:01<00:00,  6.79it/s][A
 69%|██████▉   | 9/13 [00:01<00:00,  7.00it/s][A
 77%|███████▋  | 10/13 [00:01<00:00,  7.15it/s][A
 85%|████████▍ | 11/13 [00:02<00:00,  7.25it/s][A
 92%|█████████▏| 12/13 [00:02<00:00,  7.33it/s][Ainput_ini - x shape after final reshape: torch.Size([8, 196, 8, 768])
input_ini - x shape at end: torch.Size([8, 1568, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
cls_token.shape: torch.Size([8, 8, 1, 768])
patch_token.shape: torch.Size([8, 8, 196, 768])
x.shape: torch.Size([64, 197, 768])
x2.shape: torch.Size([64, 197, 768])
temporal.shape: torch.Size([64, 768])
cls_token.shape: torch.Size([64, 768])
### cls_token.shape: torch.Size([8, 768])
features.shape: torch.Size([8, 768])
pred.shape: torch.Size([8, 2])
label.shape: torch.Size([8])
pred.shape: torch.Size([8, 2])
x.shape: torch.Size([8, 8, 3, 224, 224])
x.ndim: 5
x.shape: torch.Size([64, 3, 224, 224])
batch_size: 64
embeddings.shape: torch.Size([64, 197, 768])
input_ini - x shape before view: torch.Size([8, 8, 196, 768])
input_ini - x shape after first reshape: torch.Size([1568, 8, 768])
input_ini - x shape after cat: torch.Size([1568, 9, 768])
input_ini - x shape before final reshape: torch.Size([1568, 8, 768])
input_ini - x shape after final reshape: torch.Size([8, 196, 8, 768])
input_ini - x shape at end: torch.Size([8, 1568, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
cls_token.shape: torch.Size([8, 8, 1, 768])
patch_token.shape: torch.Size([8, 8, 196, 768])
x.shape: torch.Size([64, 197, 768])
x2.shape: torch.Size([64, 197, 768])
temporal.shape: torch.Size([64, 768])
cls_token.shape: torch.Size([64, 768])
### cls_token.shape: torch.Size([8, 768])
features.shape: torch.Size([8, 768])
pred.shape: torch.Size([8, 2])
label.shape: torch.Size([8])
pred.shape: torch.Size([8, 2])
x.shape: torch.Size([8, 8, 3, 224, 224])
x.ndim: 5
x.shape: torch.Size([64, 3, 224, 224])
batch_size: 64
embeddings.shape: torch.Size([64, 197, 768])
input_ini - x shape before view: torch.Size([8, 8, 196, 768])
input_ini - x shape after first reshape: torch.Size([1568, 8, 768])
input_ini - x shape after cat: torch.Size([1568, 9, 768])
input_ini - x shape before final reshape: torch.Size([1568, 8, 768])
input_ini - x shape after final reshape: torch.Size([8, 196, 8, 768])
input_ini - x shape at end: torch.Size([8, 1568, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
cls_token.shape: torch.Size([8, 8, 1, 768])
patch_token.shape: torch.Size([8, 8, 196, 768])
x.shape: torch.Size([64, 197, 768])
x2.shape: torch.Size([64, 197, 768])
temporal.shape: torch.Size([64, 768])
cls_token.shape: torch.Size([64, 768])
### cls_token.shape: torch.Size([8, 768])
features.shape: torch.Size([8, 768])
pred.shape: torch.Size([8, 2])
label.shape: torch.Size([8])
pred.shape: torch.Size([8, 2])
x.shape: torch.Size([8, 8, 3, 224, 224])
x.ndim: 5
x.shape: torch.Size([64, 3, 224, 224])
batch_size: 64
embeddings.shape: torch.Size([64, 197, 768])
input_ini - x shape before view: torch.Size([8, 8, 196, 768])
input_ini - x shape after first reshape: torch.Size([1568, 8, 768])
input_ini - x shape after cat: torch.Size([1568, 9, 768])
input_ini - x shape before final reshape: torch.Size([1568, 8, 768])
input_ini - x shape after final reshape: torch.Size([8, 196, 8, 768])
input_ini - x shape at end: torch.Size([8, 1568, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
cls_token.shape: torch.Size([8, 8, 1, 768])
patch_token.shape: torch.Size([8, 8, 196, 768])
x.shape: torch.Size([64, 197, 768])
x2.shape: torch.Size([64, 197, 768])
temporal.shape: torch.Size([64, 768])
cls_token.shape: torch.Size([64, 768])
### cls_token.shape: torch.Size([8, 768])
features.shape: torch.Size([8, 768])
pred.shape: torch.Size([8, 2])
label.shape: torch.Size([8])
pred.shape: torch.Size([8, 2])
x.shape: torch.Size([8, 8, 3, 224, 224])
x.ndim: 5
x.shape: torch.Size([64, 3, 224, 224])
batch_size: 64
embeddings.shape: torch.Size([64, 197, 768])
input_ini - x shape before view: torch.Size([8, 8, 196, 768])
input_ini - x shape after first reshape: torch.Size([1568, 8, 768])
input_ini - x shape after cat: torch.Size([1568, 9, 768])
input_ini - x shape before final reshape: torch.Size([1568, 8, 768])
input_ini - x shape after final reshape: torch.Size([8, 196, 8, 768])
input_ini - x shape at end: torch.Size([8, 1568, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
cls_token.shape: torch.Size([8, 8, 1, 768])
patch_token.shape: torch.Size([8, 8, 196, 768])
x.shape: torch.Size([64, 197, 768])
x2.shape: torch.Size([64, 197, 768])
temporal.shape: torch.Size([64, 768])
cls_token.shape: torch.Size([64, 768])
### cls_token.shape: torch.Size([8, 768])
features.shape: torch.Size([8, 768])
pred.shape: torch.Size([8, 2])
label.shape: torch.Size([8])
pred.shape: torch.Size([8, 2])
x.shape: torch.Size([8, 8, 3, 224, 224])
x.ndim: 5
x.shape: torch.Size([64, 3, 224, 224])
batch_size: 64
embeddings.shape: torch.Size([64, 197, 768])
input_ini - x shape before view: torch.Size([8, 8, 196, 768])
input_ini - x shape after first reshape: torch.Size([1568, 8, 768])
input_ini - x shape after cat: torch.Size([1568, 9, 768])
input_ini - x shape before final reshape: torch.Size([1568, 8, 768])
input_ini - x shape after final reshape: torch.Size([8, 196, 8, 768])
input_ini - x shape at end: torch.Size([8, 1568, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
cls_token.shape: torch.Size([8, 8, 1, 768])
patch_token.shape: torch.Size([8, 8, 196, 768])
x.shape: torch.Size([64, 197, 768])
x2.shape: torch.Size([64, 197, 768])
temporal.shape: torch.Size([64, 768])
cls_token.shape: torch.Size([64, 768])
### cls_token.shape: torch.Size([8, 768])
features.shape: torch.Size([8, 768])
pred.shape: torch.Size([8, 2])
label.shape: torch.Size([8])
pred.shape: torch.Size([8, 2])
x.shape: torch.Size([4, 8, 3, 224, 224])
x.ndim: 5
x.shape: torch.Size([32, 3, 224, 224])
batch_size: 32
embeddings.shape: torch.Size([32, 197, 768])
input_ini - x shape before view: torch.Size([4, 8, 196, 768])
input_ini - x shape after first reshape: torch.Size([784, 8, 768])
input_ini - x shape after cat: torch.Size([784, 9, 768])
input_ini - x shape before final reshape: torch.Size([784, 8, 768])
input_ini - x shape after final reshape: torch.Size([4, 196, 8, 768])
input_ini - x shape at end: torch.Size([4, 1568, 768])
x2.shape): torch.Size([4, 1569, 768])
(x1.shape): torch.Size([4, 1569, 768])
(x2.shape): torch.Size([4, 1569, 768])
x2.shape): torch.Size([4, 1569, 768])
(x1.shape): torch.Size([4, 1569, 768])
(x2.shape): torch.Size([4, 1569, 768])
x2.shape): torch.Size([4, 1569, 768])
(x1.shape): torch.Size([4, 1569, 768])
100%|██████████| 13/13 [00:02<00:00,  5.88it/s]
2025-05-30 10:56:32,146 - INFO - dataset: DFDC    step: 11    testing-loss, overall: 0.68408203125    
2025-05-30 10:56:32,146 - INFO - dataset: DFDC    step: 11    testing-metric, acc: 0.65    testing-metric, auc: 0.5070329670329671    testing-metric, eer: 0.4857142857142857    testing-metric, ap: 0.7027967956462151    testing-metric, video_auc: 0.5070329670329671    testing-metric, acc_real:0.7714285714285715; acc_fake:0.5846153846153846
2025-05-30 10:56:32,147 - INFO - dataset: avg    step: 11    testing-metric, acc: 0.65    testing-metric, auc: 0.5070329670329671    testing-metric, eer: 0.4857142857142857    testing-metric, ap: 0.7027967956462151    testing-metric, video_auc: 0.5070329670329671    
2025-05-30 10:56:32,147 - INFO - ===> Test Done!
100%|██████████| 4/4 [00:07<00:00,  1.90s/it]100%|██████████| 4/4 [00:07<00:00,  1.97s/it]
2025-05-30 10:56:32,154 - INFO - ===> Epoch[2] end with testing auc: 
================================ Each dataset best metric ================================ 
| DFDC:  auc=0.5090109890109891 | 
============================================================================================= 
================================== Average best metric ====================================== 
| avg auc: 0.5090109890109891 | 
| DFDC: 0.5090109890109891 | 
=============================================================================================!
2025-05-30 10:56:32,154 - INFO - ===> Epoch[3] start!
2025-05-30 10:56:32,155 - INFO - data_dict saved to ./logs/training/clip_stan_2025-05-30-10-56-05/train/FaceForensics++/data_dict_train.pickle
(x2.shape): torch.Size([4, 1569, 768])
cls_token.shape: torch.Size([4, 8, 1, 768])
patch_token.shape: torch.Size([4, 8, 196, 768])
x.shape: torch.Size([32, 197, 768])
x2.shape: torch.Size([32, 197, 768])
temporal.shape: torch.Size([32, 768])
cls_token.shape: torch.Size([32, 768])
### cls_token.shape: torch.Size([4, 768])
features.shape: torch.Size([4, 768])
pred.shape: torch.Size([4, 2])
label.shape: torch.Size([4])
pred.shape: torch.Size([4, 2])
len(y_pred): 100
len(y_true): 100
  0%|          | 0/4 [00:00<?, ?it/s]2025-05-30 10:56:34,391 - INFO - Iter: 12    training-loss, overall: 0.6775665283203125    
2025-05-30 10:56:34,392 - INFO - Iter: 12    training-metric, acc: 0.75    training-metric, auc: 0.6822916666666667    training-metric, eer: 0.375    training-metric, ap: 0.8924590793763063    
 25%|██▌       | 1/4 [00:02<00:06,  2.23s/it]2025-05-30 10:56:34,906 - INFO - ===> Test start!
2025-05-30 10:56:34,908 - INFO - data_dict saved to ./logs/training/clip_stan_2025-05-30-10-56-05/test/DFDC/data_dict_test.pickle
x.shape: torch.Size([32, 8, 3, 224, 224])
x.ndim: 5
x.shape: torch.Size([256, 3, 224, 224])
batch_size: 256
embeddings.shape: torch.Size([256, 197, 768])
input_ini - x shape before view: torch.Size([32, 8, 196, 768])
input_ini - x shape after first reshape: torch.Size([6272, 8, 768])
input_ini - x shape after cat: torch.Size([6272, 9, 768])
input_ini - x shape before final reshape: torch.Size([6272, 8, 768])
input_ini - x shape after final reshape: torch.Size([32, 196, 8, 768])
input_ini - x shape at end: torch.Size([32, 1568, 768])
x2.shape): torch.Size([32, 1569, 768])
(x1.shape): torch.Size([32, 1569, 768])
(x2.shape): torch.Size([32, 1569, 768])
x2.shape): torch.Size([32, 1569, 768])
(x1.shape): torch.Size([32, 1569, 768])
(x2.shape): torch.Size([32, 1569, 768])
x2.shape): torch.Size([32, 1569, 768])
(x1.shape): torch.Size([32, 1569, 768])
(x2.shape): torch.Size([32, 1569, 768])
cls_token.shape: torch.Size([32, 8, 1, 768])
patch_token.shape: torch.Size([32, 8, 196, 768])
x.shape: torch.Size([256, 197, 768])
x2.shape: torch.Size([256, 197, 768])
temporal.shape: torch.Size([256, 768])
cls_token.shape: torch.Size([256, 768])
### cls_token.shape: torch.Size([32, 768])
features.shape: torch.Size([32, 768])
pred.shape: torch.Size([32, 2])
label.shape: torch.Size([32])
pred.shape: torch.Size([32, 2])
x.shape: torch.Size([32, 8, 3, 224, 224])
x.ndim: 5
x.shape: torch.Size([256, 3, 224, 224])
batch_size: 256
embeddings.shape: torch.Size([256, 197, 768])
input_ini - x shape before view: torch.Size([32, 8, 196, 768])
input_ini - x shape after first reshape: torch.Size([6272, 8, 768])
input_ini - x shape after cat: torch.Size([6272, 9, 768])
input_ini - x shape before final reshape: torch.Size([6272, 8, 768])
input_ini - x shape after final reshape: torch.Size([32, 196, 8, 768])
input_ini - x shape at end: torch.Size([32, 1568, 768])
x2.shape): torch.Size([32, 1569, 768])
(x1.shape): torch.Size([32, 1569, 768])
(x2.shape): torch.Size([32, 1569, 768])
x2.shape): torch.Size([32, 1569, 768])
(x1.shape): torch.Size([32, 1569, 768])
(x2.shape): torch.Size([32, 1569, 768])
x2.shape): torch.Size([32, 1569, 768])
(x1.shape): torch.Size([32, 1569, 768])
(x2.shape): torch.Size([32, 1569, 768])
cls_token.shape: torch.Size([32, 8, 1, 768])
patch_token.shape: torch.Size([32, 8, 196, 768])
x.shape: torch.Size([256, 197, 768])
x2.shape: torch.Size([256, 197, 768])
temporal.shape: torch.Size([256, 768])
cls_token.shape: torch.Size([256, 768])
### cls_token.shape: torch.Size([32, 768])
features.shape: torch.Size([32, 768])
pred.shape: torch.Size([32, 2])
label.shape: torch.Size([32])
pred.shape: torch.Size([32, 2])

  0%|          | 0/13 [00:00<?, ?it/s][A
  8%|▊         | 1/13 [00:00<00:07,  1.65it/s][A
 15%|█▌        | 2/13 [00:00<00:03,  3.05it/s][A
 23%|██▎       | 3/13 [00:00<00:02,  4.19it/s][A
 31%|███       | 4/13 [00:01<00:01,  5.08it/s][A
 38%|███▊      | 5/13 [00:01<00:01,  5.75it/s][A
 46%|████▌     | 6/13 [00:01<00:01,  6.25it/s][Ax.shape: torch.Size([8, 8, 3, 224, 224])
x.ndim: 5
x.shape: torch.Size([64, 3, 224, 224])
batch_size: 64
embeddings.shape: torch.Size([64, 197, 768])
input_ini - x shape before view: torch.Size([8, 8, 196, 768])
input_ini - x shape after first reshape: torch.Size([1568, 8, 768])
input_ini - x shape after cat: torch.Size([1568, 9, 768])
input_ini - x shape before final reshape: torch.Size([1568, 8, 768])
input_ini - x shape after final reshape: torch.Size([8, 196, 8, 768])
input_ini - x shape at end: torch.Size([8, 1568, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
cls_token.shape: torch.Size([8, 8, 1, 768])
patch_token.shape: torch.Size([8, 8, 196, 768])
x.shape: torch.Size([64, 197, 768])
x2.shape: torch.Size([64, 197, 768])
temporal.shape: torch.Size([64, 768])
cls_token.shape: torch.Size([64, 768])
### cls_token.shape: torch.Size([8, 768])
features.shape: torch.Size([8, 768])
pred.shape: torch.Size([8, 2])
label.shape: torch.Size([8])
pred.shape: torch.Size([8, 2])
x.shape: torch.Size([8, 8, 3, 224, 224])
x.ndim: 5
x.shape: torch.Size([64, 3, 224, 224])
batch_size: 64
embeddings.shape: torch.Size([64, 197, 768])
input_ini - x shape before view: torch.Size([8, 8, 196, 768])
input_ini - x shape after first reshape: torch.Size([1568, 8, 768])
input_ini - x shape after cat: torch.Size([1568, 9, 768])
input_ini - x shape before final reshape: torch.Size([1568, 8, 768])
input_ini - x shape after final reshape: torch.Size([8, 196, 8, 768])
input_ini - x shape at end: torch.Size([8, 1568, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
cls_token.shape: torch.Size([8, 8, 1, 768])
patch_token.shape: torch.Size([8, 8, 196, 768])
x.shape: torch.Size([64, 197, 768])
x2.shape: torch.Size([64, 197, 768])
temporal.shape: torch.Size([64, 768])
cls_token.shape: torch.Size([64, 768])
### cls_token.shape: torch.Size([8, 768])
features.shape: torch.Size([8, 768])
pred.shape: torch.Size([8, 2])
label.shape: torch.Size([8])
pred.shape: torch.Size([8, 2])
x.shape: torch.Size([8, 8, 3, 224, 224])
x.ndim: 5
x.shape: torch.Size([64, 3, 224, 224])
batch_size: 64
embeddings.shape: torch.Size([64, 197, 768])
input_ini - x shape before view: torch.Size([8, 8, 196, 768])
input_ini - x shape after first reshape: torch.Size([1568, 8, 768])
input_ini - x shape after cat: torch.Size([1568, 9, 768])
input_ini - x shape before final reshape: torch.Size([1568, 8, 768])
input_ini - x shape after final reshape: torch.Size([8, 196, 8, 768])
input_ini - x shape at end: torch.Size([8, 1568, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
cls_token.shape: torch.Size([8, 8, 1, 768])
patch_token.shape: torch.Size([8, 8, 196, 768])
x.shape: torch.Size([64, 197, 768])
x2.shape: torch.Size([64, 197, 768])
temporal.shape: torch.Size([64, 768])
cls_token.shape: torch.Size([64, 768])
### cls_token.shape: torch.Size([8, 768])
features.shape: torch.Size([8, 768])
pred.shape: torch.Size([8, 2])
label.shape: torch.Size([8])
pred.shape: torch.Size([8, 2])
x.shape: torch.Size([8, 8, 3, 224, 224])
x.ndim: 5
x.shape: torch.Size([64, 3, 224, 224])
batch_size: 64
embeddings.shape: torch.Size([64, 197, 768])
input_ini - x shape before view: torch.Size([8, 8, 196, 768])
input_ini - x shape after first reshape: torch.Size([1568, 8, 768])
input_ini - x shape after cat: torch.Size([1568, 9, 768])
input_ini - x shape before final reshape: torch.Size([1568, 8, 768])
input_ini - x shape after final reshape: torch.Size([8, 196, 8, 768])
input_ini - x shape at end: torch.Size([8, 1568, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
cls_token.shape: torch.Size([8, 8, 1, 768])
patch_token.shape: torch.Size([8, 8, 196, 768])
x.shape: torch.Size([64, 197, 768])
x2.shape: torch.Size([64, 197, 768])
temporal.shape: torch.Size([64, 768])
cls_token.shape: torch.Size([64, 768])
### cls_token.shape: torch.Size([8, 768])
features.shape: torch.Size([8, 768])
pred.shape: torch.Size([8, 2])
label.shape: torch.Size([8])
pred.shape: torch.Size([8, 2])
x.shape: torch.Size([8, 8, 3, 224, 224])
x.ndim: 5
x.shape: torch.Size([64, 3, 224, 224])
batch_size: 64
embeddings.shape: torch.Size([64, 197, 768])
input_ini - x shape before view: torch.Size([8, 8, 196, 768])
input_ini - x shape after first reshape: torch.Size([1568, 8, 768])
input_ini - x shape after cat: torch.Size([1568, 9, 768])
input_ini - x shape before final reshape: torch.Size([1568, 8, 768])
input_ini - x shape after final reshape: torch.Size([8, 196, 8, 768])
input_ini - x shape at end: torch.Size([8, 1568, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
cls_token.shape: torch.Size([8, 8, 1, 768])
patch_token.shape: torch.Size([8, 8, 196, 768])
x.shape: torch.Size([64, 197, 768])
x2.shape: torch.Size([64, 197, 768])
temporal.shape: torch.Size([64, 768])
cls_token.shape: torch.Size([64, 768])
### cls_token.shape: torch.Size([8, 768])
features.shape: torch.Size([8, 768])
pred.shape: torch.Size([8, 2])
label.shape: torch.Size([8])
pred.shape: torch.Size([8, 2])
x.shape: torch.Size([8, 8, 3, 224, 224])
x.ndim: 5
x.shape: torch.Size([64, 3, 224, 224])
batch_size: 64
embeddings.shape: torch.Size([64, 197, 768])
input_ini - x shape before view: torch.Size([8, 8, 196, 768])
input_ini - x shape after first reshape: torch.Size([1568, 8, 768])
input_ini - x shape after cat: torch.Size([1568, 9, 768])
input_ini - x shape before final reshape: torch.Size([1568, 8, 768])
input_ini - x shape after final reshape: torch.Size([8, 196, 8, 768])
input_ini - x shape at end: torch.Size([8, 1568, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
cls_token.shape: torch.Size([8, 8, 1, 768])
patch_token.shape: torch.Size([8, 8, 196, 768])
x.shape: torch.Size([64, 197, 768])
x2.shape: torch.Size([64, 197, 768])
temporal.shape: torch.Size([64, 768])
cls_token.shape: torch.Size([64, 768])
### cls_token.shape: torch.Size([8, 768])
features.shape: torch.Size([8, 768])
pred.shape: torch.Size([8, 2])
label.shape: torch.Size([8])
pred.shape: torch.Size([8, 2])
x.shape: torch.Size([8, 8, 3, 224, 224])
x.ndim: 5
x.shape: torch.Size([64, 3, 224, 224])
batch_size: 64
embeddings.shape: torch.Size([64, 197, 768])
input_ini - x shape before view: torch.Size([8, 8, 196, 768])
input_ini - x shape after first reshape: torch.Size([1568, 8, 768])
input_ini - x shape after cat: torch.Size([1568, 9, 768])
input_ini - x shape before final reshape: torch.Size([1568, 8, 768])

 54%|█████▍    | 7/13 [00:01<00:00,  6.61it/s][A
 62%|██████▏   | 8/13 [00:01<00:00,  6.89it/s][A
 69%|██████▉   | 9/13 [00:01<00:00,  7.07it/s][A
 77%|███████▋  | 10/13 [00:01<00:00,  7.20it/s][A
 85%|████████▍ | 11/13 [00:01<00:00,  7.29it/s][A
 92%|█████████▏| 12/13 [00:02<00:00,  7.36it/s][Ainput_ini - x shape after final reshape: torch.Size([8, 196, 8, 768])
input_ini - x shape at end: torch.Size([8, 1568, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
cls_token.shape: torch.Size([8, 8, 1, 768])
patch_token.shape: torch.Size([8, 8, 196, 768])
x.shape: torch.Size([64, 197, 768])
x2.shape: torch.Size([64, 197, 768])
temporal.shape: torch.Size([64, 768])
cls_token.shape: torch.Size([64, 768])
### cls_token.shape: torch.Size([8, 768])
features.shape: torch.Size([8, 768])
pred.shape: torch.Size([8, 2])
label.shape: torch.Size([8])
pred.shape: torch.Size([8, 2])
x.shape: torch.Size([8, 8, 3, 224, 224])
x.ndim: 5
x.shape: torch.Size([64, 3, 224, 224])
batch_size: 64
embeddings.shape: torch.Size([64, 197, 768])
input_ini - x shape before view: torch.Size([8, 8, 196, 768])
input_ini - x shape after first reshape: torch.Size([1568, 8, 768])
input_ini - x shape after cat: torch.Size([1568, 9, 768])
input_ini - x shape before final reshape: torch.Size([1568, 8, 768])
input_ini - x shape after final reshape: torch.Size([8, 196, 8, 768])
input_ini - x shape at end: torch.Size([8, 1568, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
cls_token.shape: torch.Size([8, 8, 1, 768])
patch_token.shape: torch.Size([8, 8, 196, 768])
x.shape: torch.Size([64, 197, 768])
x2.shape: torch.Size([64, 197, 768])
temporal.shape: torch.Size([64, 768])
cls_token.shape: torch.Size([64, 768])
### cls_token.shape: torch.Size([8, 768])
features.shape: torch.Size([8, 768])
pred.shape: torch.Size([8, 2])
label.shape: torch.Size([8])
pred.shape: torch.Size([8, 2])
x.shape: torch.Size([8, 8, 3, 224, 224])
x.ndim: 5
x.shape: torch.Size([64, 3, 224, 224])
batch_size: 64
embeddings.shape: torch.Size([64, 197, 768])
input_ini - x shape before view: torch.Size([8, 8, 196, 768])
input_ini - x shape after first reshape: torch.Size([1568, 8, 768])
input_ini - x shape after cat: torch.Size([1568, 9, 768])
input_ini - x shape before final reshape: torch.Size([1568, 8, 768])
input_ini - x shape after final reshape: torch.Size([8, 196, 8, 768])
input_ini - x shape at end: torch.Size([8, 1568, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
cls_token.shape: torch.Size([8, 8, 1, 768])
patch_token.shape: torch.Size([8, 8, 196, 768])
x.shape: torch.Size([64, 197, 768])
x2.shape: torch.Size([64, 197, 768])
temporal.shape: torch.Size([64, 768])
cls_token.shape: torch.Size([64, 768])
### cls_token.shape: torch.Size([8, 768])
features.shape: torch.Size([8, 768])
pred.shape: torch.Size([8, 2])
label.shape: torch.Size([8])
pred.shape: torch.Size([8, 2])
x.shape: torch.Size([8, 8, 3, 224, 224])
x.ndim: 5
x.shape: torch.Size([64, 3, 224, 224])
batch_size: 64
embeddings.shape: torch.Size([64, 197, 768])
input_ini - x shape before view: torch.Size([8, 8, 196, 768])
input_ini - x shape after first reshape: torch.Size([1568, 8, 768])
input_ini - x shape after cat: torch.Size([1568, 9, 768])
input_ini - x shape before final reshape: torch.Size([1568, 8, 768])
input_ini - x shape after final reshape: torch.Size([8, 196, 8, 768])
input_ini - x shape at end: torch.Size([8, 1568, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
cls_token.shape: torch.Size([8, 8, 1, 768])
patch_token.shape: torch.Size([8, 8, 196, 768])
x.shape: torch.Size([64, 197, 768])
x2.shape: torch.Size([64, 197, 768])
temporal.shape: torch.Size([64, 768])
cls_token.shape: torch.Size([64, 768])
### cls_token.shape: torch.Size([8, 768])
features.shape: torch.Size([8, 768])
pred.shape: torch.Size([8, 2])
label.shape: torch.Size([8])
pred.shape: torch.Size([8, 2])
x.shape: torch.Size([8, 8, 3, 224, 224])
x.ndim: 5
x.shape: torch.Size([64, 3, 224, 224])
batch_size: 64
embeddings.shape: torch.Size([64, 197, 768])
input_ini - x shape before view: torch.Size([8, 8, 196, 768])
input_ini - x shape after first reshape: torch.Size([1568, 8, 768])
input_ini - x shape after cat: torch.Size([1568, 9, 768])
input_ini - x shape before final reshape: torch.Size([1568, 8, 768])
input_ini - x shape after final reshape: torch.Size([8, 196, 8, 768])
input_ini - x shape at end: torch.Size([8, 1568, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
cls_token.shape: torch.Size([8, 8, 1, 768])
patch_token.shape: torch.Size([8, 8, 196, 768])
x.shape: torch.Size([64, 197, 768])
x2.shape: torch.Size([64, 197, 768])
temporal.shape: torch.Size([64, 768])
cls_token.shape: torch.Size([64, 768])
### cls_token.shape: torch.Size([8, 768])
features.shape: torch.Size([8, 768])
pred.shape: torch.Size([8, 2])
label.shape: torch.Size([8])
pred.shape: torch.Size([8, 2])
x.shape: torch.Size([8, 8, 3, 224, 224])
x.ndim: 5
x.shape: torch.Size([64, 3, 224, 224])
batch_size: 64
embeddings.shape: torch.Size([64, 197, 768])
input_ini - x shape before view: torch.Size([8, 8, 196, 768])
input_ini - x shape after first reshape: torch.Size([1568, 8, 768])
input_ini - x shape after cat: torch.Size([1568, 9, 768])
input_ini - x shape before final reshape: torch.Size([1568, 8, 768])
input_ini - x shape after final reshape: torch.Size([8, 196, 8, 768])
input_ini - x shape at end: torch.Size([8, 1568, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
cls_token.shape: torch.Size([8, 8, 1, 768])
patch_token.shape: torch.Size([8, 8, 196, 768])
x.shape: torch.Size([64, 197, 768])
x2.shape: torch.Size([64, 197, 768])
temporal.shape: torch.Size([64, 768])
cls_token.shape: torch.Size([64, 768])
### cls_token.shape: torch.Size([8, 768])
features.shape: torch.Size([8, 768])
pred.shape: torch.Size([8, 2])
label.shape: torch.Size([8])
pred.shape: torch.Size([8, 2])
x.shape: torch.Size([4, 8, 3, 224, 224])
x.ndim: 5
x.shape: torch.Size([32, 3, 224, 224])
batch_size: 32
embeddings.shape: torch.Size([32, 197, 768])
input_ini - x shape before view: torch.Size([4, 8, 196, 768])
input_ini - x shape after first reshape: torch.Size([784, 8, 768])
input_ini - x shape after cat: torch.Size([784, 9, 768])
input_ini - x shape before final reshape: torch.Size([784, 8, 768])
input_ini - x shape after final reshape: torch.Size([4, 196, 8, 768])
input_ini - x shape at end: torch.Size([4, 1568, 768])
x2.shape): torch.Size([4, 1569, 768])
(x1.shape): torch.Size([4, 1569, 768])
(x2.shape): torch.Size([4, 1569, 768])
x2.shape): torch.Size([4, 1569, 768])
(x1.shape): torch.Size([4, 1569, 768])
(x2.shape): torch.Size([4, 1569, 768])
x2.shape): torch.Size([4, 1569, 768])
(x1.shape): torch.Size([4, 1569, 768])
100%|██████████| 13/13 [00:02<00:00,  6.08it/s]
2025-05-30 10:56:37,064 - INFO - dataset: DFDC    step: 13    testing-loss, overall: 0.6826171875    
2025-05-30 10:56:37,065 - INFO - dataset: DFDC    step: 13    testing-metric, acc: 0.65    testing-metric, auc: 0.5072527472527473    testing-metric, eer: 0.4857142857142857    testing-metric, ap: 0.7030924298199541    testing-metric, video_auc: 0.5072527472527473    testing-metric, acc_real:0.7714285714285715; acc_fake:0.5846153846153846
2025-05-30 10:56:37,066 - INFO - dataset: avg    step: 13    testing-metric, acc: 0.65    testing-metric, auc: 0.5072527472527473    testing-metric, eer: 0.4857142857142857    testing-metric, ap: 0.7030924298199541    testing-metric, video_auc: 0.5072527472527473    
2025-05-30 10:56:37,066 - INFO - ===> Test Done!
 50%|█████     | 2/4 [00:04<00:04,  2.49s/it] 75%|███████▌  | 3/4 [00:05<00:01,  1.59s/it]2025-05-30 10:56:37,662 - INFO - ===> Test start!
2025-05-30 10:56:37,664 - INFO - data_dict saved to ./logs/training/clip_stan_2025-05-30-10-56-05/test/DFDC/data_dict_test.pickle
(x2.shape): torch.Size([4, 1569, 768])
cls_token.shape: torch.Size([4, 8, 1, 768])
patch_token.shape: torch.Size([4, 8, 196, 768])
x.shape: torch.Size([32, 197, 768])
x2.shape: torch.Size([32, 197, 768])
temporal.shape: torch.Size([32, 768])
cls_token.shape: torch.Size([32, 768])
### cls_token.shape: torch.Size([4, 768])
features.shape: torch.Size([4, 768])
pred.shape: torch.Size([4, 2])
label.shape: torch.Size([4])
pred.shape: torch.Size([4, 2])
len(y_pred): 100
len(y_true): 100
x.shape: torch.Size([32, 8, 3, 224, 224])
x.ndim: 5
x.shape: torch.Size([256, 3, 224, 224])
batch_size: 256
embeddings.shape: torch.Size([256, 197, 768])
input_ini - x shape before view: torch.Size([32, 8, 196, 768])
input_ini - x shape after first reshape: torch.Size([6272, 8, 768])
input_ini - x shape after cat: torch.Size([6272, 9, 768])
input_ini - x shape before final reshape: torch.Size([6272, 8, 768])
input_ini - x shape after final reshape: torch.Size([32, 196, 8, 768])
input_ini - x shape at end: torch.Size([32, 1568, 768])
x2.shape): torch.Size([32, 1569, 768])
(x1.shape): torch.Size([32, 1569, 768])
(x2.shape): torch.Size([32, 1569, 768])
x2.shape): torch.Size([32, 1569, 768])
(x1.shape): torch.Size([32, 1569, 768])
(x2.shape): torch.Size([32, 1569, 768])
x2.shape): torch.Size([32, 1569, 768])
(x1.shape): torch.Size([32, 1569, 768])
(x2.shape): torch.Size([32, 1569, 768])
cls_token.shape: torch.Size([32, 8, 1, 768])
patch_token.shape: torch.Size([32, 8, 196, 768])
x.shape: torch.Size([256, 197, 768])
x2.shape: torch.Size([256, 197, 768])
temporal.shape: torch.Size([256, 768])
cls_token.shape: torch.Size([256, 768])
### cls_token.shape: torch.Size([32, 768])
features.shape: torch.Size([32, 768])
pred.shape: torch.Size([32, 2])
label.shape: torch.Size([32])
pred.shape: torch.Size([32, 2])
x.shape: torch.Size([4, 8, 3, 224, 224])
x.ndim: 5
x.shape: torch.Size([32, 3, 224, 224])
batch_size: 32
embeddings.shape: torch.Size([32, 197, 768])
input_ini - x shape before view: torch.Size([4, 8, 196, 768])
input_ini - x shape after first reshape: torch.Size([784, 8, 768])
input_ini - x shape after cat: torch.Size([784, 9, 768])
input_ini - x shape before final reshape: torch.Size([784, 8, 768])
input_ini - x shape after final reshape: torch.Size([4, 196, 8, 768])
input_ini - x shape at end: torch.Size([4, 1568, 768])
x2.shape): torch.Size([4, 1569, 768])
(x1.shape): torch.Size([4, 1569, 768])
(x2.shape): torch.Size([4, 1569, 768])
x2.shape): torch.Size([4, 1569, 768])
(x1.shape): torch.Size([4, 1569, 768])
(x2.shape): torch.Size([4, 1569, 768])
x2.shape): torch.Size([4, 1569, 768])
(x1.shape): torch.Size([4, 1569, 768])
(x2.shape): torch.Size([4, 1569, 768])
cls_token.shape: torch.Size([4, 8, 1, 768])
patch_token.shape: torch.Size([4, 8, 196, 768])
x.shape: torch.Size([32, 197, 768])
x2.shape: torch.Size([32, 197, 768])
temporal.shape: torch.Size([32, 768])
cls_token.shape: torch.Size([32, 768])
### cls_token.shape: torch.Size([4, 768])
features.shape: torch.Size([4, 768])
pred.shape: torch.Size([4, 2])
label.shape: torch.Size([4])
pred.shape: torch.Size([4, 2])

  0%|          | 0/13 [00:00<?, ?it/s][A
  8%|▊         | 1/13 [00:00<00:08,  1.44it/s][A
 15%|█▌        | 2/13 [00:00<00:04,  2.75it/s][A
 23%|██▎       | 3/13 [00:00<00:02,  3.87it/s][A
 31%|███       | 4/13 [00:01<00:01,  4.78it/s][A
 38%|███▊      | 5/13 [00:01<00:01,  5.50it/s][A
 46%|████▌     | 6/13 [00:01<00:01,  6.04it/s][Ax.shape: torch.Size([8, 8, 3, 224, 224])
x.ndim: 5
x.shape: torch.Size([64, 3, 224, 224])
batch_size: 64
embeddings.shape: torch.Size([64, 197, 768])
input_ini - x shape before view: torch.Size([8, 8, 196, 768])
input_ini - x shape after first reshape: torch.Size([1568, 8, 768])
input_ini - x shape after cat: torch.Size([1568, 9, 768])
input_ini - x shape before final reshape: torch.Size([1568, 8, 768])
input_ini - x shape after final reshape: torch.Size([8, 196, 8, 768])
input_ini - x shape at end: torch.Size([8, 1568, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
cls_token.shape: torch.Size([8, 8, 1, 768])
patch_token.shape: torch.Size([8, 8, 196, 768])
x.shape: torch.Size([64, 197, 768])
x2.shape: torch.Size([64, 197, 768])
temporal.shape: torch.Size([64, 768])
cls_token.shape: torch.Size([64, 768])
### cls_token.shape: torch.Size([8, 768])
features.shape: torch.Size([8, 768])
pred.shape: torch.Size([8, 2])
label.shape: torch.Size([8])
pred.shape: torch.Size([8, 2])
x.shape: torch.Size([8, 8, 3, 224, 224])
x.ndim: 5
x.shape: torch.Size([64, 3, 224, 224])
batch_size: 64
embeddings.shape: torch.Size([64, 197, 768])
input_ini - x shape before view: torch.Size([8, 8, 196, 768])
input_ini - x shape after first reshape: torch.Size([1568, 8, 768])
input_ini - x shape after cat: torch.Size([1568, 9, 768])
input_ini - x shape before final reshape: torch.Size([1568, 8, 768])
input_ini - x shape after final reshape: torch.Size([8, 196, 8, 768])
input_ini - x shape at end: torch.Size([8, 1568, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
cls_token.shape: torch.Size([8, 8, 1, 768])
patch_token.shape: torch.Size([8, 8, 196, 768])
x.shape: torch.Size([64, 197, 768])
x2.shape: torch.Size([64, 197, 768])
temporal.shape: torch.Size([64, 768])
cls_token.shape: torch.Size([64, 768])
### cls_token.shape: torch.Size([8, 768])
features.shape: torch.Size([8, 768])
pred.shape: torch.Size([8, 2])
label.shape: torch.Size([8])
pred.shape: torch.Size([8, 2])
x.shape: torch.Size([8, 8, 3, 224, 224])
x.ndim: 5
x.shape: torch.Size([64, 3, 224, 224])
batch_size: 64
embeddings.shape: torch.Size([64, 197, 768])
input_ini - x shape before view: torch.Size([8, 8, 196, 768])
input_ini - x shape after first reshape: torch.Size([1568, 8, 768])
input_ini - x shape after cat: torch.Size([1568, 9, 768])
input_ini - x shape before final reshape: torch.Size([1568, 8, 768])
input_ini - x shape after final reshape: torch.Size([8, 196, 8, 768])
input_ini - x shape at end: torch.Size([8, 1568, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
cls_token.shape: torch.Size([8, 8, 1, 768])
patch_token.shape: torch.Size([8, 8, 196, 768])
x.shape: torch.Size([64, 197, 768])
x2.shape: torch.Size([64, 197, 768])
temporal.shape: torch.Size([64, 768])
cls_token.shape: torch.Size([64, 768])
### cls_token.shape: torch.Size([8, 768])
features.shape: torch.Size([8, 768])
pred.shape: torch.Size([8, 2])
label.shape: torch.Size([8])
pred.shape: torch.Size([8, 2])
x.shape: torch.Size([8, 8, 3, 224, 224])
x.ndim: 5
x.shape: torch.Size([64, 3, 224, 224])
batch_size: 64
embeddings.shape: torch.Size([64, 197, 768])
input_ini - x shape before view: torch.Size([8, 8, 196, 768])
input_ini - x shape after first reshape: torch.Size([1568, 8, 768])
input_ini - x shape after cat: torch.Size([1568, 9, 768])
input_ini - x shape before final reshape: torch.Size([1568, 8, 768])
input_ini - x shape after final reshape: torch.Size([8, 196, 8, 768])
input_ini - x shape at end: torch.Size([8, 1568, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
cls_token.shape: torch.Size([8, 8, 1, 768])
patch_token.shape: torch.Size([8, 8, 196, 768])
x.shape: torch.Size([64, 197, 768])
x2.shape: torch.Size([64, 197, 768])
temporal.shape: torch.Size([64, 768])
cls_token.shape: torch.Size([64, 768])
### cls_token.shape: torch.Size([8, 768])
features.shape: torch.Size([8, 768])
pred.shape: torch.Size([8, 2])
label.shape: torch.Size([8])
pred.shape: torch.Size([8, 2])
x.shape: torch.Size([8, 8, 3, 224, 224])
x.ndim: 5
x.shape: torch.Size([64, 3, 224, 224])
batch_size: 64
embeddings.shape: torch.Size([64, 197, 768])
input_ini - x shape before view: torch.Size([8, 8, 196, 768])
input_ini - x shape after first reshape: torch.Size([1568, 8, 768])
input_ini - x shape after cat: torch.Size([1568, 9, 768])
input_ini - x shape before final reshape: torch.Size([1568, 8, 768])
input_ini - x shape after final reshape: torch.Size([8, 196, 8, 768])
input_ini - x shape at end: torch.Size([8, 1568, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
cls_token.shape: torch.Size([8, 8, 1, 768])
patch_token.shape: torch.Size([8, 8, 196, 768])
x.shape: torch.Size([64, 197, 768])
x2.shape: torch.Size([64, 197, 768])
temporal.shape: torch.Size([64, 768])
cls_token.shape: torch.Size([64, 768])
### cls_token.shape: torch.Size([8, 768])
features.shape: torch.Size([8, 768])
pred.shape: torch.Size([8, 2])
label.shape: torch.Size([8])
pred.shape: torch.Size([8, 2])
x.shape: torch.Size([8, 8, 3, 224, 224])
x.ndim: 5
x.shape: torch.Size([64, 3, 224, 224])
batch_size: 64
embeddings.shape: torch.Size([64, 197, 768])
input_ini - x shape before view: torch.Size([8, 8, 196, 768])
input_ini - x shape after first reshape: torch.Size([1568, 8, 768])
input_ini - x shape after cat: torch.Size([1568, 9, 768])
input_ini - x shape before final reshape: torch.Size([1568, 8, 768])
input_ini - x shape after final reshape: torch.Size([8, 196, 8, 768])
input_ini - x shape at end: torch.Size([8, 1568, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
cls_token.shape: torch.Size([8, 8, 1, 768])
patch_token.shape: torch.Size([8, 8, 196, 768])
x.shape: torch.Size([64, 197, 768])
x2.shape: torch.Size([64, 197, 768])
temporal.shape: torch.Size([64, 768])
cls_token.shape: torch.Size([64, 768])
### cls_token.shape: torch.Size([8, 768])
features.shape: torch.Size([8, 768])
pred.shape: torch.Size([8, 2])
label.shape: torch.Size([8])
pred.shape: torch.Size([8, 2])
x.shape: torch.Size([8, 8, 3, 224, 224])
x.ndim: 5
x.shape: torch.Size([64, 3, 224, 224])
batch_size: 64
embeddings.shape: torch.Size([64, 197, 768])
input_ini - x shape before view: torch.Size([8, 8, 196, 768])
input_ini - x shape after first reshape: torch.Size([1568, 8, 768])
input_ini - x shape after cat: torch.Size([1568, 9, 768])
input_ini - x shape before final reshape: torch.Size([1568, 8, 768])

 54%|█████▍    | 7/13 [00:01<00:00,  6.45it/s][A
 62%|██████▏   | 8/13 [00:01<00:00,  6.75it/s][A
 69%|██████▉   | 9/13 [00:01<00:00,  6.96it/s][A
 77%|███████▋  | 10/13 [00:01<00:00,  7.12it/s][A
 85%|████████▍ | 11/13 [00:02<00:00,  7.23it/s][A
 92%|█████████▏| 12/13 [00:02<00:00,  7.30it/s][Ainput_ini - x shape after final reshape: torch.Size([8, 196, 8, 768])
input_ini - x shape at end: torch.Size([8, 1568, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
cls_token.shape: torch.Size([8, 8, 1, 768])
patch_token.shape: torch.Size([8, 8, 196, 768])
x.shape: torch.Size([64, 197, 768])
x2.shape: torch.Size([64, 197, 768])
temporal.shape: torch.Size([64, 768])
cls_token.shape: torch.Size([64, 768])
### cls_token.shape: torch.Size([8, 768])
features.shape: torch.Size([8, 768])
pred.shape: torch.Size([8, 2])
label.shape: torch.Size([8])
pred.shape: torch.Size([8, 2])
x.shape: torch.Size([8, 8, 3, 224, 224])
x.ndim: 5
x.shape: torch.Size([64, 3, 224, 224])
batch_size: 64
embeddings.shape: torch.Size([64, 197, 768])
input_ini - x shape before view: torch.Size([8, 8, 196, 768])
input_ini - x shape after first reshape: torch.Size([1568, 8, 768])
input_ini - x shape after cat: torch.Size([1568, 9, 768])
input_ini - x shape before final reshape: torch.Size([1568, 8, 768])
input_ini - x shape after final reshape: torch.Size([8, 196, 8, 768])
input_ini - x shape at end: torch.Size([8, 1568, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
cls_token.shape: torch.Size([8, 8, 1, 768])
patch_token.shape: torch.Size([8, 8, 196, 768])
x.shape: torch.Size([64, 197, 768])
x2.shape: torch.Size([64, 197, 768])
temporal.shape: torch.Size([64, 768])
cls_token.shape: torch.Size([64, 768])
### cls_token.shape: torch.Size([8, 768])
features.shape: torch.Size([8, 768])
pred.shape: torch.Size([8, 2])
label.shape: torch.Size([8])
pred.shape: torch.Size([8, 2])
x.shape: torch.Size([8, 8, 3, 224, 224])
x.ndim: 5
x.shape: torch.Size([64, 3, 224, 224])
batch_size: 64
embeddings.shape: torch.Size([64, 197, 768])
input_ini - x shape before view: torch.Size([8, 8, 196, 768])
input_ini - x shape after first reshape: torch.Size([1568, 8, 768])
input_ini - x shape after cat: torch.Size([1568, 9, 768])
input_ini - x shape before final reshape: torch.Size([1568, 8, 768])
input_ini - x shape after final reshape: torch.Size([8, 196, 8, 768])
input_ini - x shape at end: torch.Size([8, 1568, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
cls_token.shape: torch.Size([8, 8, 1, 768])
patch_token.shape: torch.Size([8, 8, 196, 768])
x.shape: torch.Size([64, 197, 768])
x2.shape: torch.Size([64, 197, 768])
temporal.shape: torch.Size([64, 768])
cls_token.shape: torch.Size([64, 768])
### cls_token.shape: torch.Size([8, 768])
features.shape: torch.Size([8, 768])
pred.shape: torch.Size([8, 2])
label.shape: torch.Size([8])
pred.shape: torch.Size([8, 2])
x.shape: torch.Size([8, 8, 3, 224, 224])
x.ndim: 5
x.shape: torch.Size([64, 3, 224, 224])
batch_size: 64
embeddings.shape: torch.Size([64, 197, 768])
input_ini - x shape before view: torch.Size([8, 8, 196, 768])
input_ini - x shape after first reshape: torch.Size([1568, 8, 768])
input_ini - x shape after cat: torch.Size([1568, 9, 768])
input_ini - x shape before final reshape: torch.Size([1568, 8, 768])
input_ini - x shape after final reshape: torch.Size([8, 196, 8, 768])
input_ini - x shape at end: torch.Size([8, 1568, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
cls_token.shape: torch.Size([8, 8, 1, 768])
patch_token.shape: torch.Size([8, 8, 196, 768])
x.shape: torch.Size([64, 197, 768])
x2.shape: torch.Size([64, 197, 768])
temporal.shape: torch.Size([64, 768])
cls_token.shape: torch.Size([64, 768])
### cls_token.shape: torch.Size([8, 768])
features.shape: torch.Size([8, 768])
pred.shape: torch.Size([8, 2])
label.shape: torch.Size([8])
pred.shape: torch.Size([8, 2])
x.shape: torch.Size([8, 8, 3, 224, 224])
x.ndim: 5
x.shape: torch.Size([64, 3, 224, 224])
batch_size: 64
embeddings.shape: torch.Size([64, 197, 768])
input_ini - x shape before view: torch.Size([8, 8, 196, 768])
input_ini - x shape after first reshape: torch.Size([1568, 8, 768])
input_ini - x shape after cat: torch.Size([1568, 9, 768])
input_ini - x shape before final reshape: torch.Size([1568, 8, 768])
input_ini - x shape after final reshape: torch.Size([8, 196, 8, 768])
input_ini - x shape at end: torch.Size([8, 1568, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
cls_token.shape: torch.Size([8, 8, 1, 768])
patch_token.shape: torch.Size([8, 8, 196, 768])
x.shape: torch.Size([64, 197, 768])
x2.shape: torch.Size([64, 197, 768])
temporal.shape: torch.Size([64, 768])
cls_token.shape: torch.Size([64, 768])
### cls_token.shape: torch.Size([8, 768])
features.shape: torch.Size([8, 768])
pred.shape: torch.Size([8, 2])
label.shape: torch.Size([8])
pred.shape: torch.Size([8, 2])
x.shape: torch.Size([8, 8, 3, 224, 224])
x.ndim: 5
x.shape: torch.Size([64, 3, 224, 224])
batch_size: 64
embeddings.shape: torch.Size([64, 197, 768])
input_ini - x shape before view: torch.Size([8, 8, 196, 768])
input_ini - x shape after first reshape: torch.Size([1568, 8, 768])
input_ini - x shape after cat: torch.Size([1568, 9, 768])
input_ini - x shape before final reshape: torch.Size([1568, 8, 768])
input_ini - x shape after final reshape: torch.Size([8, 196, 8, 768])
input_ini - x shape at end: torch.Size([8, 1568, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
cls_token.shape: torch.Size([8, 8, 1, 768])
patch_token.shape: torch.Size([8, 8, 196, 768])
x.shape: torch.Size([64, 197, 768])
x2.shape: torch.Size([64, 197, 768])
temporal.shape: torch.Size([64, 768])
cls_token.shape: torch.Size([64, 768])
### cls_token.shape: torch.Size([8, 768])
features.shape: torch.Size([8, 768])
pred.shape: torch.Size([8, 2])
label.shape: torch.Size([8])
pred.shape: torch.Size([8, 2])
x.shape: torch.Size([4, 8, 3, 224, 224])
x.ndim: 5
x.shape: torch.Size([32, 3, 224, 224])
batch_size: 32
embeddings.shape: torch.Size([32, 197, 768])
input_ini - x shape before view: torch.Size([4, 8, 196, 768])
input_ini - x shape after first reshape: torch.Size([784, 8, 768])
input_ini - x shape after cat: torch.Size([784, 9, 768])
input_ini - x shape before final reshape: torch.Size([784, 8, 768])
input_ini - x shape after final reshape: torch.Size([4, 196, 8, 768])
input_ini - x shape at end: torch.Size([4, 1568, 768])
x2.shape): torch.Size([4, 1569, 768])
(x1.shape): torch.Size([4, 1569, 768])
(x2.shape): torch.Size([4, 1569, 768])
x2.shape): torch.Size([4, 1569, 768])
(x1.shape): torch.Size([4, 1569, 768])
(x2.shape): torch.Size([4, 1569, 768])
x2.shape): torch.Size([4, 1569, 768])
(x1.shape): torch.Size([4, 1569, 768])
100%|██████████| 13/13 [00:02<00:00,  5.82it/s]
2025-05-30 10:56:39,906 - INFO - dataset: DFDC    step: 15    testing-loss, overall: 0.68212890625    
2025-05-30 10:56:39,907 - INFO - dataset: DFDC    step: 15    testing-metric, acc: 0.65    testing-metric, auc: 0.5072527472527473    testing-metric, eer: 0.4857142857142857    testing-metric, ap: 0.7034490082453086    testing-metric, video_auc: 0.5072527472527473    testing-metric, acc_real:0.7714285714285715; acc_fake:0.5846153846153846
2025-05-30 10:56:39,907 - INFO - dataset: avg    step: 15    testing-metric, acc: 0.65    testing-metric, auc: 0.5072527472527473    testing-metric, eer: 0.4857142857142857    testing-metric, ap: 0.7034490082453086    testing-metric, video_auc: 0.5072527472527473    
2025-05-30 10:56:39,907 - INFO - ===> Test Done!
100%|██████████| 4/4 [00:07<00:00,  1.88s/it]100%|██████████| 4/4 [00:07<00:00,  1.94s/it]
2025-05-30 10:56:39,916 - INFO - ===> Epoch[3] end with testing auc: 
================================ Each dataset best metric ================================ 
| DFDC:  auc=0.5090109890109891 | 
============================================================================================= 
================================== Average best metric ====================================== 
| avg auc: 0.5090109890109891 | 
| DFDC: 0.5090109890109891 | 
=============================================================================================!
2025-05-30 10:56:39,916 - INFO - ===> Epoch[4] start!
2025-05-30 10:56:39,917 - INFO - data_dict saved to ./logs/training/clip_stan_2025-05-30-10-56-05/train/FaceForensics++/data_dict_train.pickle
(x2.shape): torch.Size([4, 1569, 768])
cls_token.shape: torch.Size([4, 8, 1, 768])
patch_token.shape: torch.Size([4, 8, 196, 768])
x.shape: torch.Size([32, 197, 768])
x2.shape: torch.Size([32, 197, 768])
temporal.shape: torch.Size([32, 768])
cls_token.shape: torch.Size([32, 768])
### cls_token.shape: torch.Size([4, 768])
features.shape: torch.Size([4, 768])
pred.shape: torch.Size([4, 2])
label.shape: torch.Size([4])
pred.shape: torch.Size([4, 2])
len(y_pred): 100
len(y_true): 100
  0%|          | 0/4 [00:00<?, ?it/s]2025-05-30 10:56:42,462 - INFO - Iter: 16    training-loss, overall: 0.671875    
2025-05-30 10:56:42,462 - INFO - Iter: 16    training-metric, acc: 0.78125    training-metric, auc: 0.7771428571428571    training-metric, eer: 0.2857142857142857    training-metric, ap: 0.9193639784782603    
 25%|██▌       | 1/4 [00:02<00:07,  2.54s/it]2025-05-30 10:56:42,979 - INFO - ===> Test start!
2025-05-30 10:56:42,981 - INFO - data_dict saved to ./logs/training/clip_stan_2025-05-30-10-56-05/test/DFDC/data_dict_test.pickle
x.shape: torch.Size([32, 8, 3, 224, 224])
x.ndim: 5
x.shape: torch.Size([256, 3, 224, 224])
batch_size: 256
embeddings.shape: torch.Size([256, 197, 768])
input_ini - x shape before view: torch.Size([32, 8, 196, 768])
input_ini - x shape after first reshape: torch.Size([6272, 8, 768])
input_ini - x shape after cat: torch.Size([6272, 9, 768])
input_ini - x shape before final reshape: torch.Size([6272, 8, 768])
input_ini - x shape after final reshape: torch.Size([32, 196, 8, 768])
input_ini - x shape at end: torch.Size([32, 1568, 768])
x2.shape): torch.Size([32, 1569, 768])
(x1.shape): torch.Size([32, 1569, 768])
(x2.shape): torch.Size([32, 1569, 768])
x2.shape): torch.Size([32, 1569, 768])
(x1.shape): torch.Size([32, 1569, 768])
(x2.shape): torch.Size([32, 1569, 768])
x2.shape): torch.Size([32, 1569, 768])
(x1.shape): torch.Size([32, 1569, 768])
(x2.shape): torch.Size([32, 1569, 768])
cls_token.shape: torch.Size([32, 8, 1, 768])
patch_token.shape: torch.Size([32, 8, 196, 768])
x.shape: torch.Size([256, 197, 768])
x2.shape: torch.Size([256, 197, 768])
temporal.shape: torch.Size([256, 768])
cls_token.shape: torch.Size([256, 768])
### cls_token.shape: torch.Size([32, 768])
features.shape: torch.Size([32, 768])
pred.shape: torch.Size([32, 2])
label.shape: torch.Size([32])
pred.shape: torch.Size([32, 2])
x.shape: torch.Size([32, 8, 3, 224, 224])
x.ndim: 5
x.shape: torch.Size([256, 3, 224, 224])
batch_size: 256
embeddings.shape: torch.Size([256, 197, 768])
input_ini - x shape before view: torch.Size([32, 8, 196, 768])
input_ini - x shape after first reshape: torch.Size([6272, 8, 768])
input_ini - x shape after cat: torch.Size([6272, 9, 768])
input_ini - x shape before final reshape: torch.Size([6272, 8, 768])
input_ini - x shape after final reshape: torch.Size([32, 196, 8, 768])
input_ini - x shape at end: torch.Size([32, 1568, 768])
x2.shape): torch.Size([32, 1569, 768])
(x1.shape): torch.Size([32, 1569, 768])
(x2.shape): torch.Size([32, 1569, 768])
x2.shape): torch.Size([32, 1569, 768])
(x1.shape): torch.Size([32, 1569, 768])
(x2.shape): torch.Size([32, 1569, 768])
x2.shape): torch.Size([32, 1569, 768])
(x1.shape): torch.Size([32, 1569, 768])
(x2.shape): torch.Size([32, 1569, 768])
cls_token.shape: torch.Size([32, 8, 1, 768])
patch_token.shape: torch.Size([32, 8, 196, 768])
x.shape: torch.Size([256, 197, 768])
x2.shape: torch.Size([256, 197, 768])
temporal.shape: torch.Size([256, 768])
cls_token.shape: torch.Size([256, 768])
### cls_token.shape: torch.Size([32, 768])
features.shape: torch.Size([32, 768])
pred.shape: torch.Size([32, 2])
label.shape: torch.Size([32])
pred.shape: torch.Size([32, 2])

  0%|          | 0/13 [00:00<?, ?it/s][A
  8%|▊         | 1/13 [00:00<00:06,  1.78it/s][A
 15%|█▌        | 2/13 [00:00<00:03,  3.23it/s][A
 23%|██▎       | 3/13 [00:00<00:02,  4.36it/s][A
 31%|███       | 4/13 [00:00<00:01,  5.22it/s][A
 38%|███▊      | 5/13 [00:01<00:01,  5.86it/s][A
 46%|████▌     | 6/13 [00:01<00:01,  6.33it/s][Ax.shape: torch.Size([8, 8, 3, 224, 224])
x.ndim: 5
x.shape: torch.Size([64, 3, 224, 224])
batch_size: 64
embeddings.shape: torch.Size([64, 197, 768])
input_ini - x shape before view: torch.Size([8, 8, 196, 768])
input_ini - x shape after first reshape: torch.Size([1568, 8, 768])
input_ini - x shape after cat: torch.Size([1568, 9, 768])
input_ini - x shape before final reshape: torch.Size([1568, 8, 768])
input_ini - x shape after final reshape: torch.Size([8, 196, 8, 768])
input_ini - x shape at end: torch.Size([8, 1568, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
cls_token.shape: torch.Size([8, 8, 1, 768])
patch_token.shape: torch.Size([8, 8, 196, 768])
x.shape: torch.Size([64, 197, 768])
x2.shape: torch.Size([64, 197, 768])
temporal.shape: torch.Size([64, 768])
cls_token.shape: torch.Size([64, 768])
### cls_token.shape: torch.Size([8, 768])
features.shape: torch.Size([8, 768])
pred.shape: torch.Size([8, 2])
label.shape: torch.Size([8])
pred.shape: torch.Size([8, 2])
x.shape: torch.Size([8, 8, 3, 224, 224])
x.ndim: 5
x.shape: torch.Size([64, 3, 224, 224])
batch_size: 64
embeddings.shape: torch.Size([64, 197, 768])
input_ini - x shape before view: torch.Size([8, 8, 196, 768])
input_ini - x shape after first reshape: torch.Size([1568, 8, 768])
input_ini - x shape after cat: torch.Size([1568, 9, 768])
input_ini - x shape before final reshape: torch.Size([1568, 8, 768])
input_ini - x shape after final reshape: torch.Size([8, 196, 8, 768])
input_ini - x shape at end: torch.Size([8, 1568, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
cls_token.shape: torch.Size([8, 8, 1, 768])
patch_token.shape: torch.Size([8, 8, 196, 768])
x.shape: torch.Size([64, 197, 768])
x2.shape: torch.Size([64, 197, 768])
temporal.shape: torch.Size([64, 768])
cls_token.shape: torch.Size([64, 768])
### cls_token.shape: torch.Size([8, 768])
features.shape: torch.Size([8, 768])
pred.shape: torch.Size([8, 2])
label.shape: torch.Size([8])
pred.shape: torch.Size([8, 2])
x.shape: torch.Size([8, 8, 3, 224, 224])
x.ndim: 5
x.shape: torch.Size([64, 3, 224, 224])
batch_size: 64
embeddings.shape: torch.Size([64, 197, 768])
input_ini - x shape before view: torch.Size([8, 8, 196, 768])
input_ini - x shape after first reshape: torch.Size([1568, 8, 768])
input_ini - x shape after cat: torch.Size([1568, 9, 768])
input_ini - x shape before final reshape: torch.Size([1568, 8, 768])
input_ini - x shape after final reshape: torch.Size([8, 196, 8, 768])
input_ini - x shape at end: torch.Size([8, 1568, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
cls_token.shape: torch.Size([8, 8, 1, 768])
patch_token.shape: torch.Size([8, 8, 196, 768])
x.shape: torch.Size([64, 197, 768])
x2.shape: torch.Size([64, 197, 768])
temporal.shape: torch.Size([64, 768])
cls_token.shape: torch.Size([64, 768])
### cls_token.shape: torch.Size([8, 768])
features.shape: torch.Size([8, 768])
pred.shape: torch.Size([8, 2])
label.shape: torch.Size([8])
pred.shape: torch.Size([8, 2])
x.shape: torch.Size([8, 8, 3, 224, 224])
x.ndim: 5
x.shape: torch.Size([64, 3, 224, 224])
batch_size: 64
embeddings.shape: torch.Size([64, 197, 768])
input_ini - x shape before view: torch.Size([8, 8, 196, 768])
input_ini - x shape after first reshape: torch.Size([1568, 8, 768])
input_ini - x shape after cat: torch.Size([1568, 9, 768])
input_ini - x shape before final reshape: torch.Size([1568, 8, 768])
input_ini - x shape after final reshape: torch.Size([8, 196, 8, 768])
input_ini - x shape at end: torch.Size([8, 1568, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
cls_token.shape: torch.Size([8, 8, 1, 768])
patch_token.shape: torch.Size([8, 8, 196, 768])
x.shape: torch.Size([64, 197, 768])
x2.shape: torch.Size([64, 197, 768])
temporal.shape: torch.Size([64, 768])
cls_token.shape: torch.Size([64, 768])
### cls_token.shape: torch.Size([8, 768])
features.shape: torch.Size([8, 768])
pred.shape: torch.Size([8, 2])
label.shape: torch.Size([8])
pred.shape: torch.Size([8, 2])
x.shape: torch.Size([8, 8, 3, 224, 224])
x.ndim: 5
x.shape: torch.Size([64, 3, 224, 224])
batch_size: 64
embeddings.shape: torch.Size([64, 197, 768])
input_ini - x shape before view: torch.Size([8, 8, 196, 768])
input_ini - x shape after first reshape: torch.Size([1568, 8, 768])
input_ini - x shape after cat: torch.Size([1568, 9, 768])
input_ini - x shape before final reshape: torch.Size([1568, 8, 768])
input_ini - x shape after final reshape: torch.Size([8, 196, 8, 768])
input_ini - x shape at end: torch.Size([8, 1568, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
cls_token.shape: torch.Size([8, 8, 1, 768])
patch_token.shape: torch.Size([8, 8, 196, 768])
x.shape: torch.Size([64, 197, 768])
x2.shape: torch.Size([64, 197, 768])
temporal.shape: torch.Size([64, 768])
cls_token.shape: torch.Size([64, 768])
### cls_token.shape: torch.Size([8, 768])
features.shape: torch.Size([8, 768])
pred.shape: torch.Size([8, 2])
label.shape: torch.Size([8])
pred.shape: torch.Size([8, 2])
x.shape: torch.Size([8, 8, 3, 224, 224])
x.ndim: 5
x.shape: torch.Size([64, 3, 224, 224])
batch_size: 64
embeddings.shape: torch.Size([64, 197, 768])
input_ini - x shape before view: torch.Size([8, 8, 196, 768])
input_ini - x shape after first reshape: torch.Size([1568, 8, 768])
input_ini - x shape after cat: torch.Size([1568, 9, 768])
input_ini - x shape before final reshape: torch.Size([1568, 8, 768])
input_ini - x shape after final reshape: torch.Size([8, 196, 8, 768])
input_ini - x shape at end: torch.Size([8, 1568, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
cls_token.shape: torch.Size([8, 8, 1, 768])
patch_token.shape: torch.Size([8, 8, 196, 768])
x.shape: torch.Size([64, 197, 768])
x2.shape: torch.Size([64, 197, 768])
temporal.shape: torch.Size([64, 768])
cls_token.shape: torch.Size([64, 768])
### cls_token.shape: torch.Size([8, 768])
features.shape: torch.Size([8, 768])
pred.shape: torch.Size([8, 2])
label.shape: torch.Size([8])
pred.shape: torch.Size([8, 2])
x.shape: torch.Size([8, 8, 3, 224, 224])
x.ndim: 5
x.shape: torch.Size([64, 3, 224, 224])
batch_size: 64
embeddings.shape: torch.Size([64, 197, 768])
input_ini - x shape before view: torch.Size([8, 8, 196, 768])
input_ini - x shape after first reshape: torch.Size([1568, 8, 768])
input_ini - x shape after cat: torch.Size([1568, 9, 768])
input_ini - x shape before final reshape: torch.Size([1568, 8, 768])

 54%|█████▍    | 7/13 [00:01<00:00,  6.67it/s][A
 62%|██████▏   | 8/13 [00:01<00:00,  6.91it/s][A
 69%|██████▉   | 9/13 [00:01<00:00,  7.08it/s][A
 77%|███████▋  | 10/13 [00:01<00:00,  7.20it/s][A
 85%|████████▍ | 11/13 [00:01<00:00,  7.28it/s][A
 92%|█████████▏| 12/13 [00:02<00:00,  7.34it/s][Ainput_ini - x shape after final reshape: torch.Size([8, 196, 8, 768])
input_ini - x shape at end: torch.Size([8, 1568, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
cls_token.shape: torch.Size([8, 8, 1, 768])
patch_token.shape: torch.Size([8, 8, 196, 768])
x.shape: torch.Size([64, 197, 768])
x2.shape: torch.Size([64, 197, 768])
temporal.shape: torch.Size([64, 768])
cls_token.shape: torch.Size([64, 768])
### cls_token.shape: torch.Size([8, 768])
features.shape: torch.Size([8, 768])
pred.shape: torch.Size([8, 2])
label.shape: torch.Size([8])
pred.shape: torch.Size([8, 2])
x.shape: torch.Size([8, 8, 3, 224, 224])
x.ndim: 5
x.shape: torch.Size([64, 3, 224, 224])
batch_size: 64
embeddings.shape: torch.Size([64, 197, 768])
input_ini - x shape before view: torch.Size([8, 8, 196, 768])
input_ini - x shape after first reshape: torch.Size([1568, 8, 768])
input_ini - x shape after cat: torch.Size([1568, 9, 768])
input_ini - x shape before final reshape: torch.Size([1568, 8, 768])
input_ini - x shape after final reshape: torch.Size([8, 196, 8, 768])
input_ini - x shape at end: torch.Size([8, 1568, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
cls_token.shape: torch.Size([8, 8, 1, 768])
patch_token.shape: torch.Size([8, 8, 196, 768])
x.shape: torch.Size([64, 197, 768])
x2.shape: torch.Size([64, 197, 768])
temporal.shape: torch.Size([64, 768])
cls_token.shape: torch.Size([64, 768])
### cls_token.shape: torch.Size([8, 768])
features.shape: torch.Size([8, 768])
pred.shape: torch.Size([8, 2])
label.shape: torch.Size([8])
pred.shape: torch.Size([8, 2])
x.shape: torch.Size([8, 8, 3, 224, 224])
x.ndim: 5
x.shape: torch.Size([64, 3, 224, 224])
batch_size: 64
embeddings.shape: torch.Size([64, 197, 768])
input_ini - x shape before view: torch.Size([8, 8, 196, 768])
input_ini - x shape after first reshape: torch.Size([1568, 8, 768])
input_ini - x shape after cat: torch.Size([1568, 9, 768])
input_ini - x shape before final reshape: torch.Size([1568, 8, 768])
input_ini - x shape after final reshape: torch.Size([8, 196, 8, 768])
input_ini - x shape at end: torch.Size([8, 1568, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
cls_token.shape: torch.Size([8, 8, 1, 768])
patch_token.shape: torch.Size([8, 8, 196, 768])
x.shape: torch.Size([64, 197, 768])
x2.shape: torch.Size([64, 197, 768])
temporal.shape: torch.Size([64, 768])
cls_token.shape: torch.Size([64, 768])
### cls_token.shape: torch.Size([8, 768])
features.shape: torch.Size([8, 768])
pred.shape: torch.Size([8, 2])
label.shape: torch.Size([8])
pred.shape: torch.Size([8, 2])
x.shape: torch.Size([8, 8, 3, 224, 224])
x.ndim: 5
x.shape: torch.Size([64, 3, 224, 224])
batch_size: 64
embeddings.shape: torch.Size([64, 197, 768])
input_ini - x shape before view: torch.Size([8, 8, 196, 768])
input_ini - x shape after first reshape: torch.Size([1568, 8, 768])
input_ini - x shape after cat: torch.Size([1568, 9, 768])
input_ini - x shape before final reshape: torch.Size([1568, 8, 768])
input_ini - x shape after final reshape: torch.Size([8, 196, 8, 768])
input_ini - x shape at end: torch.Size([8, 1568, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
cls_token.shape: torch.Size([8, 8, 1, 768])
patch_token.shape: torch.Size([8, 8, 196, 768])
x.shape: torch.Size([64, 197, 768])
x2.shape: torch.Size([64, 197, 768])
temporal.shape: torch.Size([64, 768])
cls_token.shape: torch.Size([64, 768])
### cls_token.shape: torch.Size([8, 768])
features.shape: torch.Size([8, 768])
pred.shape: torch.Size([8, 2])
label.shape: torch.Size([8])
pred.shape: torch.Size([8, 2])
x.shape: torch.Size([8, 8, 3, 224, 224])
x.ndim: 5
x.shape: torch.Size([64, 3, 224, 224])
batch_size: 64
embeddings.shape: torch.Size([64, 197, 768])
input_ini - x shape before view: torch.Size([8, 8, 196, 768])
input_ini - x shape after first reshape: torch.Size([1568, 8, 768])
input_ini - x shape after cat: torch.Size([1568, 9, 768])
input_ini - x shape before final reshape: torch.Size([1568, 8, 768])
input_ini - x shape after final reshape: torch.Size([8, 196, 8, 768])
input_ini - x shape at end: torch.Size([8, 1568, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
cls_token.shape: torch.Size([8, 8, 1, 768])
patch_token.shape: torch.Size([8, 8, 196, 768])
x.shape: torch.Size([64, 197, 768])
x2.shape: torch.Size([64, 197, 768])
temporal.shape: torch.Size([64, 768])
cls_token.shape: torch.Size([64, 768])
### cls_token.shape: torch.Size([8, 768])
features.shape: torch.Size([8, 768])
pred.shape: torch.Size([8, 2])
label.shape: torch.Size([8])
pred.shape: torch.Size([8, 2])
x.shape: torch.Size([8, 8, 3, 224, 224])
x.ndim: 5
x.shape: torch.Size([64, 3, 224, 224])
batch_size: 64
embeddings.shape: torch.Size([64, 197, 768])
input_ini - x shape before view: torch.Size([8, 8, 196, 768])
input_ini - x shape after first reshape: torch.Size([1568, 8, 768])
input_ini - x shape after cat: torch.Size([1568, 9, 768])
input_ini - x shape before final reshape: torch.Size([1568, 8, 768])
input_ini - x shape after final reshape: torch.Size([8, 196, 8, 768])
input_ini - x shape at end: torch.Size([8, 1568, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
cls_token.shape: torch.Size([8, 8, 1, 768])
patch_token.shape: torch.Size([8, 8, 196, 768])
x.shape: torch.Size([64, 197, 768])
x2.shape: torch.Size([64, 197, 768])
temporal.shape: torch.Size([64, 768])
cls_token.shape: torch.Size([64, 768])
### cls_token.shape: torch.Size([8, 768])
features.shape: torch.Size([8, 768])
pred.shape: torch.Size([8, 2])
label.shape: torch.Size([8])
pred.shape: torch.Size([8, 2])
x.shape: torch.Size([4, 8, 3, 224, 224])
x.ndim: 5
x.shape: torch.Size([32, 3, 224, 224])
batch_size: 32
embeddings.shape: torch.Size([32, 197, 768])
input_ini - x shape before view: torch.Size([4, 8, 196, 768])
input_ini - x shape after first reshape: torch.Size([784, 8, 768])
input_ini - x shape after cat: torch.Size([784, 9, 768])
input_ini - x shape before final reshape: torch.Size([784, 8, 768])
input_ini - x shape after final reshape: torch.Size([4, 196, 8, 768])
input_ini - x shape at end: torch.Size([4, 1568, 768])
x2.shape): torch.Size([4, 1569, 768])
(x1.shape): torch.Size([4, 1569, 768])
(x2.shape): torch.Size([4, 1569, 768])
x2.shape): torch.Size([4, 1569, 768])
(x1.shape): torch.Size([4, 1569, 768])
(x2.shape): torch.Size([4, 1569, 768])
x2.shape): torch.Size([4, 1569, 768])
(x1.shape): torch.Size([4, 1569, 768])
100%|██████████| 13/13 [00:02<00:00,  6.18it/s]
2025-05-30 10:56:45,093 - INFO - dataset: DFDC    step: 17    testing-loss, overall: 0.681640625    
2025-05-30 10:56:45,094 - INFO - dataset: DFDC    step: 17    testing-metric, acc: 0.65    testing-metric, auc: 0.5048351648351649    testing-metric, eer: 0.4857142857142857    testing-metric, ap: 0.7018616639711412    testing-metric, video_auc: 0.5048351648351649    testing-metric, acc_real:0.7714285714285715; acc_fake:0.5846153846153846
2025-05-30 10:56:45,094 - INFO - dataset: avg    step: 17    testing-metric, acc: 0.65    testing-metric, auc: 0.5048351648351649    testing-metric, eer: 0.4857142857142857    testing-metric, ap: 0.7018616639711412    testing-metric, video_auc: 0.5048351648351649    
2025-05-30 10:56:45,098 - INFO - ===> Test Done!
 50%|█████     | 2/4 [00:05<00:05,  2.60s/it] 75%|███████▌  | 3/4 [00:05<00:01,  1.65s/it]2025-05-30 10:56:45,689 - INFO - ===> Test start!
2025-05-30 10:56:45,692 - INFO - data_dict saved to ./logs/training/clip_stan_2025-05-30-10-56-05/test/DFDC/data_dict_test.pickle
(x2.shape): torch.Size([4, 1569, 768])
cls_token.shape: torch.Size([4, 8, 1, 768])
patch_token.shape: torch.Size([4, 8, 196, 768])
x.shape: torch.Size([32, 197, 768])
x2.shape: torch.Size([32, 197, 768])
temporal.shape: torch.Size([32, 768])
cls_token.shape: torch.Size([32, 768])
### cls_token.shape: torch.Size([4, 768])
features.shape: torch.Size([4, 768])
pred.shape: torch.Size([4, 2])
label.shape: torch.Size([4])
pred.shape: torch.Size([4, 2])
len(y_pred): 100
len(y_true): 100
x.shape: torch.Size([32, 8, 3, 224, 224])
x.ndim: 5
x.shape: torch.Size([256, 3, 224, 224])
batch_size: 256
embeddings.shape: torch.Size([256, 197, 768])
input_ini - x shape before view: torch.Size([32, 8, 196, 768])
input_ini - x shape after first reshape: torch.Size([6272, 8, 768])
input_ini - x shape after cat: torch.Size([6272, 9, 768])
input_ini - x shape before final reshape: torch.Size([6272, 8, 768])
input_ini - x shape after final reshape: torch.Size([32, 196, 8, 768])
input_ini - x shape at end: torch.Size([32, 1568, 768])
x2.shape): torch.Size([32, 1569, 768])
(x1.shape): torch.Size([32, 1569, 768])
(x2.shape): torch.Size([32, 1569, 768])
x2.shape): torch.Size([32, 1569, 768])
(x1.shape): torch.Size([32, 1569, 768])
(x2.shape): torch.Size([32, 1569, 768])
x2.shape): torch.Size([32, 1569, 768])
(x1.shape): torch.Size([32, 1569, 768])
(x2.shape): torch.Size([32, 1569, 768])
cls_token.shape: torch.Size([32, 8, 1, 768])
patch_token.shape: torch.Size([32, 8, 196, 768])
x.shape: torch.Size([256, 197, 768])
x2.shape: torch.Size([256, 197, 768])
temporal.shape: torch.Size([256, 768])
cls_token.shape: torch.Size([256, 768])
### cls_token.shape: torch.Size([32, 768])
features.shape: torch.Size([32, 768])
pred.shape: torch.Size([32, 2])
label.shape: torch.Size([32])
pred.shape: torch.Size([32, 2])
x.shape: torch.Size([4, 8, 3, 224, 224])
x.ndim: 5
x.shape: torch.Size([32, 3, 224, 224])
batch_size: 32
embeddings.shape: torch.Size([32, 197, 768])
input_ini - x shape before view: torch.Size([4, 8, 196, 768])
input_ini - x shape after first reshape: torch.Size([784, 8, 768])
input_ini - x shape after cat: torch.Size([784, 9, 768])
input_ini - x shape before final reshape: torch.Size([784, 8, 768])
input_ini - x shape after final reshape: torch.Size([4, 196, 8, 768])
input_ini - x shape at end: torch.Size([4, 1568, 768])
x2.shape): torch.Size([4, 1569, 768])
(x1.shape): torch.Size([4, 1569, 768])
(x2.shape): torch.Size([4, 1569, 768])
x2.shape): torch.Size([4, 1569, 768])
(x1.shape): torch.Size([4, 1569, 768])
(x2.shape): torch.Size([4, 1569, 768])
x2.shape): torch.Size([4, 1569, 768])
(x1.shape): torch.Size([4, 1569, 768])
(x2.shape): torch.Size([4, 1569, 768])
cls_token.shape: torch.Size([4, 8, 1, 768])
patch_token.shape: torch.Size([4, 8, 196, 768])
x.shape: torch.Size([32, 197, 768])
x2.shape: torch.Size([32, 197, 768])
temporal.shape: torch.Size([32, 768])
cls_token.shape: torch.Size([32, 768])
### cls_token.shape: torch.Size([4, 768])
features.shape: torch.Size([4, 768])
pred.shape: torch.Size([4, 2])
label.shape: torch.Size([4])
pred.shape: torch.Size([4, 2])

  0%|          | 0/13 [00:00<?, ?it/s][A
  8%|▊         | 1/13 [00:00<00:08,  1.48it/s][A
 15%|█▌        | 2/13 [00:00<00:03,  2.80it/s][A
 23%|██▎       | 3/13 [00:00<00:02,  3.92it/s][A
 31%|███       | 4/13 [00:01<00:01,  4.82it/s][A
 38%|███▊      | 5/13 [00:01<00:01,  5.54it/s][A
 46%|████▌     | 6/13 [00:01<00:01,  6.08it/s][Ax.shape: torch.Size([8, 8, 3, 224, 224])
x.ndim: 5
x.shape: torch.Size([64, 3, 224, 224])
batch_size: 64
embeddings.shape: torch.Size([64, 197, 768])
input_ini - x shape before view: torch.Size([8, 8, 196, 768])
input_ini - x shape after first reshape: torch.Size([1568, 8, 768])
input_ini - x shape after cat: torch.Size([1568, 9, 768])
input_ini - x shape before final reshape: torch.Size([1568, 8, 768])
input_ini - x shape after final reshape: torch.Size([8, 196, 8, 768])
input_ini - x shape at end: torch.Size([8, 1568, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
cls_token.shape: torch.Size([8, 8, 1, 768])
patch_token.shape: torch.Size([8, 8, 196, 768])
x.shape: torch.Size([64, 197, 768])
x2.shape: torch.Size([64, 197, 768])
temporal.shape: torch.Size([64, 768])
cls_token.shape: torch.Size([64, 768])
### cls_token.shape: torch.Size([8, 768])
features.shape: torch.Size([8, 768])
pred.shape: torch.Size([8, 2])
label.shape: torch.Size([8])
pred.shape: torch.Size([8, 2])
x.shape: torch.Size([8, 8, 3, 224, 224])
x.ndim: 5
x.shape: torch.Size([64, 3, 224, 224])
batch_size: 64
embeddings.shape: torch.Size([64, 197, 768])
input_ini - x shape before view: torch.Size([8, 8, 196, 768])
input_ini - x shape after first reshape: torch.Size([1568, 8, 768])
input_ini - x shape after cat: torch.Size([1568, 9, 768])
input_ini - x shape before final reshape: torch.Size([1568, 8, 768])
input_ini - x shape after final reshape: torch.Size([8, 196, 8, 768])
input_ini - x shape at end: torch.Size([8, 1568, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
cls_token.shape: torch.Size([8, 8, 1, 768])
patch_token.shape: torch.Size([8, 8, 196, 768])
x.shape: torch.Size([64, 197, 768])
x2.shape: torch.Size([64, 197, 768])
temporal.shape: torch.Size([64, 768])
cls_token.shape: torch.Size([64, 768])
### cls_token.shape: torch.Size([8, 768])
features.shape: torch.Size([8, 768])
pred.shape: torch.Size([8, 2])
label.shape: torch.Size([8])
pred.shape: torch.Size([8, 2])
x.shape: torch.Size([8, 8, 3, 224, 224])
x.ndim: 5
x.shape: torch.Size([64, 3, 224, 224])
batch_size: 64
embeddings.shape: torch.Size([64, 197, 768])
input_ini - x shape before view: torch.Size([8, 8, 196, 768])
input_ini - x shape after first reshape: torch.Size([1568, 8, 768])
input_ini - x shape after cat: torch.Size([1568, 9, 768])
input_ini - x shape before final reshape: torch.Size([1568, 8, 768])
input_ini - x shape after final reshape: torch.Size([8, 196, 8, 768])
input_ini - x shape at end: torch.Size([8, 1568, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
cls_token.shape: torch.Size([8, 8, 1, 768])
patch_token.shape: torch.Size([8, 8, 196, 768])
x.shape: torch.Size([64, 197, 768])
x2.shape: torch.Size([64, 197, 768])
temporal.shape: torch.Size([64, 768])
cls_token.shape: torch.Size([64, 768])
### cls_token.shape: torch.Size([8, 768])
features.shape: torch.Size([8, 768])
pred.shape: torch.Size([8, 2])
label.shape: torch.Size([8])
pred.shape: torch.Size([8, 2])
x.shape: torch.Size([8, 8, 3, 224, 224])
x.ndim: 5
x.shape: torch.Size([64, 3, 224, 224])
batch_size: 64
embeddings.shape: torch.Size([64, 197, 768])
input_ini - x shape before view: torch.Size([8, 8, 196, 768])
input_ini - x shape after first reshape: torch.Size([1568, 8, 768])
input_ini - x shape after cat: torch.Size([1568, 9, 768])
input_ini - x shape before final reshape: torch.Size([1568, 8, 768])
input_ini - x shape after final reshape: torch.Size([8, 196, 8, 768])
input_ini - x shape at end: torch.Size([8, 1568, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
cls_token.shape: torch.Size([8, 8, 1, 768])
patch_token.shape: torch.Size([8, 8, 196, 768])
x.shape: torch.Size([64, 197, 768])
x2.shape: torch.Size([64, 197, 768])
temporal.shape: torch.Size([64, 768])
cls_token.shape: torch.Size([64, 768])
### cls_token.shape: torch.Size([8, 768])
features.shape: torch.Size([8, 768])
pred.shape: torch.Size([8, 2])
label.shape: torch.Size([8])
pred.shape: torch.Size([8, 2])
x.shape: torch.Size([8, 8, 3, 224, 224])
x.ndim: 5
x.shape: torch.Size([64, 3, 224, 224])
batch_size: 64
embeddings.shape: torch.Size([64, 197, 768])
input_ini - x shape before view: torch.Size([8, 8, 196, 768])
input_ini - x shape after first reshape: torch.Size([1568, 8, 768])
input_ini - x shape after cat: torch.Size([1568, 9, 768])
input_ini - x shape before final reshape: torch.Size([1568, 8, 768])
input_ini - x shape after final reshape: torch.Size([8, 196, 8, 768])
input_ini - x shape at end: torch.Size([8, 1568, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
cls_token.shape: torch.Size([8, 8, 1, 768])
patch_token.shape: torch.Size([8, 8, 196, 768])
x.shape: torch.Size([64, 197, 768])
x2.shape: torch.Size([64, 197, 768])
temporal.shape: torch.Size([64, 768])
cls_token.shape: torch.Size([64, 768])
### cls_token.shape: torch.Size([8, 768])
features.shape: torch.Size([8, 768])
pred.shape: torch.Size([8, 2])
label.shape: torch.Size([8])
pred.shape: torch.Size([8, 2])
x.shape: torch.Size([8, 8, 3, 224, 224])
x.ndim: 5
x.shape: torch.Size([64, 3, 224, 224])
batch_size: 64
embeddings.shape: torch.Size([64, 197, 768])
input_ini - x shape before view: torch.Size([8, 8, 196, 768])
input_ini - x shape after first reshape: torch.Size([1568, 8, 768])
input_ini - x shape after cat: torch.Size([1568, 9, 768])
input_ini - x shape before final reshape: torch.Size([1568, 8, 768])
input_ini - x shape after final reshape: torch.Size([8, 196, 8, 768])
input_ini - x shape at end: torch.Size([8, 1568, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
cls_token.shape: torch.Size([8, 8, 1, 768])
patch_token.shape: torch.Size([8, 8, 196, 768])
x.shape: torch.Size([64, 197, 768])
x2.shape: torch.Size([64, 197, 768])
temporal.shape: torch.Size([64, 768])
cls_token.shape: torch.Size([64, 768])
### cls_token.shape: torch.Size([8, 768])
features.shape: torch.Size([8, 768])
pred.shape: torch.Size([8, 2])
label.shape: torch.Size([8])
pred.shape: torch.Size([8, 2])
x.shape: torch.Size([8, 8, 3, 224, 224])
x.ndim: 5
x.shape: torch.Size([64, 3, 224, 224])
batch_size: 64
embeddings.shape: torch.Size([64, 197, 768])
input_ini - x shape before view: torch.Size([8, 8, 196, 768])
input_ini - x shape after first reshape: torch.Size([1568, 8, 768])
input_ini - x shape after cat: torch.Size([1568, 9, 768])
input_ini - x shape before final reshape: torch.Size([1568, 8, 768])

 54%|█████▍    | 7/13 [00:01<00:00,  6.48it/s][A
 62%|██████▏   | 8/13 [00:01<00:00,  6.76it/s][A
 69%|██████▉   | 9/13 [00:01<00:00,  6.98it/s][A
 77%|███████▋  | 10/13 [00:01<00:00,  7.12it/s][A
 85%|████████▍ | 11/13 [00:02<00:00,  7.23it/s][A
 92%|█████████▏| 12/13 [00:02<00:00,  7.30it/s][Ainput_ini - x shape after final reshape: torch.Size([8, 196, 8, 768])
input_ini - x shape at end: torch.Size([8, 1568, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
cls_token.shape: torch.Size([8, 8, 1, 768])
patch_token.shape: torch.Size([8, 8, 196, 768])
x.shape: torch.Size([64, 197, 768])
x2.shape: torch.Size([64, 197, 768])
temporal.shape: torch.Size([64, 768])
cls_token.shape: torch.Size([64, 768])
### cls_token.shape: torch.Size([8, 768])
features.shape: torch.Size([8, 768])
pred.shape: torch.Size([8, 2])
label.shape: torch.Size([8])
pred.shape: torch.Size([8, 2])
x.shape: torch.Size([8, 8, 3, 224, 224])
x.ndim: 5
x.shape: torch.Size([64, 3, 224, 224])
batch_size: 64
embeddings.shape: torch.Size([64, 197, 768])
input_ini - x shape before view: torch.Size([8, 8, 196, 768])
input_ini - x shape after first reshape: torch.Size([1568, 8, 768])
input_ini - x shape after cat: torch.Size([1568, 9, 768])
input_ini - x shape before final reshape: torch.Size([1568, 8, 768])
input_ini - x shape after final reshape: torch.Size([8, 196, 8, 768])
input_ini - x shape at end: torch.Size([8, 1568, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
cls_token.shape: torch.Size([8, 8, 1, 768])
patch_token.shape: torch.Size([8, 8, 196, 768])
x.shape: torch.Size([64, 197, 768])
x2.shape: torch.Size([64, 197, 768])
temporal.shape: torch.Size([64, 768])
cls_token.shape: torch.Size([64, 768])
### cls_token.shape: torch.Size([8, 768])
features.shape: torch.Size([8, 768])
pred.shape: torch.Size([8, 2])
label.shape: torch.Size([8])
pred.shape: torch.Size([8, 2])
x.shape: torch.Size([8, 8, 3, 224, 224])
x.ndim: 5
x.shape: torch.Size([64, 3, 224, 224])
batch_size: 64
embeddings.shape: torch.Size([64, 197, 768])
input_ini - x shape before view: torch.Size([8, 8, 196, 768])
input_ini - x shape after first reshape: torch.Size([1568, 8, 768])
input_ini - x shape after cat: torch.Size([1568, 9, 768])
input_ini - x shape before final reshape: torch.Size([1568, 8, 768])
input_ini - x shape after final reshape: torch.Size([8, 196, 8, 768])
input_ini - x shape at end: torch.Size([8, 1568, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
cls_token.shape: torch.Size([8, 8, 1, 768])
patch_token.shape: torch.Size([8, 8, 196, 768])
x.shape: torch.Size([64, 197, 768])
x2.shape: torch.Size([64, 197, 768])
temporal.shape: torch.Size([64, 768])
cls_token.shape: torch.Size([64, 768])
### cls_token.shape: torch.Size([8, 768])
features.shape: torch.Size([8, 768])
pred.shape: torch.Size([8, 2])
label.shape: torch.Size([8])
pred.shape: torch.Size([8, 2])
x.shape: torch.Size([8, 8, 3, 224, 224])
x.ndim: 5
x.shape: torch.Size([64, 3, 224, 224])
batch_size: 64
embeddings.shape: torch.Size([64, 197, 768])
input_ini - x shape before view: torch.Size([8, 8, 196, 768])
input_ini - x shape after first reshape: torch.Size([1568, 8, 768])
input_ini - x shape after cat: torch.Size([1568, 9, 768])
input_ini - x shape before final reshape: torch.Size([1568, 8, 768])
input_ini - x shape after final reshape: torch.Size([8, 196, 8, 768])
input_ini - x shape at end: torch.Size([8, 1568, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
cls_token.shape: torch.Size([8, 8, 1, 768])
patch_token.shape: torch.Size([8, 8, 196, 768])
x.shape: torch.Size([64, 197, 768])
x2.shape: torch.Size([64, 197, 768])
temporal.shape: torch.Size([64, 768])
cls_token.shape: torch.Size([64, 768])
### cls_token.shape: torch.Size([8, 768])
features.shape: torch.Size([8, 768])
pred.shape: torch.Size([8, 2])
label.shape: torch.Size([8])
pred.shape: torch.Size([8, 2])
x.shape: torch.Size([8, 8, 3, 224, 224])
x.ndim: 5
x.shape: torch.Size([64, 3, 224, 224])
batch_size: 64
embeddings.shape: torch.Size([64, 197, 768])
input_ini - x shape before view: torch.Size([8, 8, 196, 768])
input_ini - x shape after first reshape: torch.Size([1568, 8, 768])
input_ini - x shape after cat: torch.Size([1568, 9, 768])
input_ini - x shape before final reshape: torch.Size([1568, 8, 768])
input_ini - x shape after final reshape: torch.Size([8, 196, 8, 768])
input_ini - x shape at end: torch.Size([8, 1568, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
cls_token.shape: torch.Size([8, 8, 1, 768])
patch_token.shape: torch.Size([8, 8, 196, 768])
x.shape: torch.Size([64, 197, 768])
x2.shape: torch.Size([64, 197, 768])
temporal.shape: torch.Size([64, 768])
cls_token.shape: torch.Size([64, 768])
### cls_token.shape: torch.Size([8, 768])
features.shape: torch.Size([8, 768])
pred.shape: torch.Size([8, 2])
label.shape: torch.Size([8])
pred.shape: torch.Size([8, 2])
x.shape: torch.Size([8, 8, 3, 224, 224])
x.ndim: 5
x.shape: torch.Size([64, 3, 224, 224])
batch_size: 64
embeddings.shape: torch.Size([64, 197, 768])
input_ini - x shape before view: torch.Size([8, 8, 196, 768])
input_ini - x shape after first reshape: torch.Size([1568, 8, 768])
input_ini - x shape after cat: torch.Size([1568, 9, 768])
input_ini - x shape before final reshape: torch.Size([1568, 8, 768])
input_ini - x shape after final reshape: torch.Size([8, 196, 8, 768])
input_ini - x shape at end: torch.Size([8, 1568, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
cls_token.shape: torch.Size([8, 8, 1, 768])
patch_token.shape: torch.Size([8, 8, 196, 768])
x.shape: torch.Size([64, 197, 768])
x2.shape: torch.Size([64, 197, 768])
temporal.shape: torch.Size([64, 768])
cls_token.shape: torch.Size([64, 768])
### cls_token.shape: torch.Size([8, 768])
features.shape: torch.Size([8, 768])
pred.shape: torch.Size([8, 2])
label.shape: torch.Size([8])
pred.shape: torch.Size([8, 2])
x.shape: torch.Size([4, 8, 3, 224, 224])
x.ndim: 5
x.shape: torch.Size([32, 3, 224, 224])
batch_size: 32
embeddings.shape: torch.Size([32, 197, 768])
input_ini - x shape before view: torch.Size([4, 8, 196, 768])
input_ini - x shape after first reshape: torch.Size([784, 8, 768])
input_ini - x shape after cat: torch.Size([784, 9, 768])
input_ini - x shape before final reshape: torch.Size([784, 8, 768])
input_ini - x shape after final reshape: torch.Size([4, 196, 8, 768])
input_ini - x shape at end: torch.Size([4, 1568, 768])
x2.shape): torch.Size([4, 1569, 768])
(x1.shape): torch.Size([4, 1569, 768])
(x2.shape): torch.Size([4, 1569, 768])
x2.shape): torch.Size([4, 1569, 768])
(x1.shape): torch.Size([4, 1569, 768])
(x2.shape): torch.Size([4, 1569, 768])
x2.shape): torch.Size([4, 1569, 768])
(x1.shape): torch.Size([4, 1569, 768])
100%|██████████| 13/13 [00:02<00:00,  5.86it/s]
2025-05-30 10:56:47,925 - INFO - dataset: DFDC    step: 19    testing-loss, overall: 0.6806640625    
2025-05-30 10:56:47,927 - INFO - dataset: DFDC    step: 19    testing-metric, acc: 0.65    testing-metric, auc: 0.5028571428571429    testing-metric, eer: 0.4857142857142857    testing-metric, ap: 0.7012204282331784    testing-metric, video_auc: 0.5028571428571429    testing-metric, acc_real:0.7714285714285715; acc_fake:0.5846153846153846
2025-05-30 10:56:47,930 - INFO - dataset: avg    step: 19    testing-metric, acc: 0.65    testing-metric, auc: 0.5028571428571429    testing-metric, eer: 0.4857142857142857    testing-metric, ap: 0.7012204282331784    testing-metric, video_auc: 0.5028571428571429    
2025-05-30 10:56:47,930 - INFO - ===> Test Done!
100%|██████████| 4/4 [00:08<00:00,  1.91s/it]100%|██████████| 4/4 [00:08<00:00,  2.00s/it]
2025-05-30 10:56:47,934 - INFO - ===> Epoch[4] end with testing auc: 
================================ Each dataset best metric ================================ 
| DFDC:  auc=0.5090109890109891 | 
============================================================================================= 
================================== Average best metric ====================================== 
| avg auc: 0.5090109890109891 | 
| DFDC: 0.5090109890109891 | 
=============================================================================================!
2025-05-30 10:56:47,934 - INFO - ===> Epoch[5] start!
2025-05-30 10:56:47,935 - INFO - data_dict saved to ./logs/training/clip_stan_2025-05-30-10-56-05/train/FaceForensics++/data_dict_train.pickle
(x2.shape): torch.Size([4, 1569, 768])
cls_token.shape: torch.Size([4, 8, 1, 768])
patch_token.shape: torch.Size([4, 8, 196, 768])
x.shape: torch.Size([32, 197, 768])
x2.shape: torch.Size([32, 197, 768])
temporal.shape: torch.Size([32, 768])
cls_token.shape: torch.Size([32, 768])
### cls_token.shape: torch.Size([4, 768])
features.shape: torch.Size([4, 768])
pred.shape: torch.Size([4, 2])
label.shape: torch.Size([4])
pred.shape: torch.Size([4, 2])
len(y_pred): 100
len(y_true): 100
  0%|          | 0/4 [00:00<?, ?it/s]2025-05-30 10:56:50,084 - INFO - Iter: 20    training-loss, overall: 0.6786956787109375    
2025-05-30 10:56:50,085 - INFO - Iter: 20    training-metric, acc: 0.65625    training-metric, auc: 0.7748917748917747    training-metric, eer: 0.36363636363636365    training-metric, ap: 0.8725988412172623    
 25%|██▌       | 1/4 [00:02<00:06,  2.14s/it]2025-05-30 10:56:50,599 - INFO - ===> Test start!
2025-05-30 10:56:50,602 - INFO - data_dict saved to ./logs/training/clip_stan_2025-05-30-10-56-05/test/DFDC/data_dict_test.pickle
x.shape: torch.Size([32, 8, 3, 224, 224])
x.ndim: 5
x.shape: torch.Size([256, 3, 224, 224])
batch_size: 256
embeddings.shape: torch.Size([256, 197, 768])
input_ini - x shape before view: torch.Size([32, 8, 196, 768])
input_ini - x shape after first reshape: torch.Size([6272, 8, 768])
input_ini - x shape after cat: torch.Size([6272, 9, 768])
input_ini - x shape before final reshape: torch.Size([6272, 8, 768])
input_ini - x shape after final reshape: torch.Size([32, 196, 8, 768])
input_ini - x shape at end: torch.Size([32, 1568, 768])
x2.shape): torch.Size([32, 1569, 768])
(x1.shape): torch.Size([32, 1569, 768])
(x2.shape): torch.Size([32, 1569, 768])
x2.shape): torch.Size([32, 1569, 768])
(x1.shape): torch.Size([32, 1569, 768])
(x2.shape): torch.Size([32, 1569, 768])
x2.shape): torch.Size([32, 1569, 768])
(x1.shape): torch.Size([32, 1569, 768])
(x2.shape): torch.Size([32, 1569, 768])
cls_token.shape: torch.Size([32, 8, 1, 768])
patch_token.shape: torch.Size([32, 8, 196, 768])
x.shape: torch.Size([256, 197, 768])
x2.shape: torch.Size([256, 197, 768])
temporal.shape: torch.Size([256, 768])
cls_token.shape: torch.Size([256, 768])
### cls_token.shape: torch.Size([32, 768])
features.shape: torch.Size([32, 768])
pred.shape: torch.Size([32, 2])
label.shape: torch.Size([32])
pred.shape: torch.Size([32, 2])
x.shape: torch.Size([32, 8, 3, 224, 224])
x.ndim: 5
x.shape: torch.Size([256, 3, 224, 224])
batch_size: 256
embeddings.shape: torch.Size([256, 197, 768])
input_ini - x shape before view: torch.Size([32, 8, 196, 768])
input_ini - x shape after first reshape: torch.Size([6272, 8, 768])
input_ini - x shape after cat: torch.Size([6272, 9, 768])
input_ini - x shape before final reshape: torch.Size([6272, 8, 768])
input_ini - x shape after final reshape: torch.Size([32, 196, 8, 768])
input_ini - x shape at end: torch.Size([32, 1568, 768])
x2.shape): torch.Size([32, 1569, 768])
(x1.shape): torch.Size([32, 1569, 768])
(x2.shape): torch.Size([32, 1569, 768])
x2.shape): torch.Size([32, 1569, 768])
(x1.shape): torch.Size([32, 1569, 768])
(x2.shape): torch.Size([32, 1569, 768])
x2.shape): torch.Size([32, 1569, 768])
(x1.shape): torch.Size([32, 1569, 768])
(x2.shape): torch.Size([32, 1569, 768])
cls_token.shape: torch.Size([32, 8, 1, 768])
patch_token.shape: torch.Size([32, 8, 196, 768])
x.shape: torch.Size([256, 197, 768])
x2.shape: torch.Size([256, 197, 768])
temporal.shape: torch.Size([256, 768])
cls_token.shape: torch.Size([256, 768])
### cls_token.shape: torch.Size([32, 768])
features.shape: torch.Size([32, 768])
pred.shape: torch.Size([32, 2])
label.shape: torch.Size([32])
pred.shape: torch.Size([32, 2])

  0%|          | 0/13 [00:00<?, ?it/s][A
  8%|▊         | 1/13 [00:00<00:08,  1.50it/s][A
 15%|█▌        | 2/13 [00:00<00:03,  2.82it/s][A
 23%|██▎       | 3/13 [00:00<00:02,  3.95it/s][A
 31%|███       | 4/13 [00:01<00:01,  4.85it/s][A
 38%|███▊      | 5/13 [00:01<00:01,  5.55it/s][A
 46%|████▌     | 6/13 [00:01<00:01,  6.08it/s][Ax.shape: torch.Size([8, 8, 3, 224, 224])
x.ndim: 5
x.shape: torch.Size([64, 3, 224, 224])
batch_size: 64
embeddings.shape: torch.Size([64, 197, 768])
input_ini - x shape before view: torch.Size([8, 8, 196, 768])
input_ini - x shape after first reshape: torch.Size([1568, 8, 768])
input_ini - x shape after cat: torch.Size([1568, 9, 768])
input_ini - x shape before final reshape: torch.Size([1568, 8, 768])
input_ini - x shape after final reshape: torch.Size([8, 196, 8, 768])
input_ini - x shape at end: torch.Size([8, 1568, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
cls_token.shape: torch.Size([8, 8, 1, 768])
patch_token.shape: torch.Size([8, 8, 196, 768])
x.shape: torch.Size([64, 197, 768])
x2.shape: torch.Size([64, 197, 768])
temporal.shape: torch.Size([64, 768])
cls_token.shape: torch.Size([64, 768])
### cls_token.shape: torch.Size([8, 768])
features.shape: torch.Size([8, 768])
pred.shape: torch.Size([8, 2])
label.shape: torch.Size([8])
pred.shape: torch.Size([8, 2])
x.shape: torch.Size([8, 8, 3, 224, 224])
x.ndim: 5
x.shape: torch.Size([64, 3, 224, 224])
batch_size: 64
embeddings.shape: torch.Size([64, 197, 768])
input_ini - x shape before view: torch.Size([8, 8, 196, 768])
input_ini - x shape after first reshape: torch.Size([1568, 8, 768])
input_ini - x shape after cat: torch.Size([1568, 9, 768])
input_ini - x shape before final reshape: torch.Size([1568, 8, 768])
input_ini - x shape after final reshape: torch.Size([8, 196, 8, 768])
input_ini - x shape at end: torch.Size([8, 1568, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
cls_token.shape: torch.Size([8, 8, 1, 768])
patch_token.shape: torch.Size([8, 8, 196, 768])
x.shape: torch.Size([64, 197, 768])
x2.shape: torch.Size([64, 197, 768])
temporal.shape: torch.Size([64, 768])
cls_token.shape: torch.Size([64, 768])
### cls_token.shape: torch.Size([8, 768])
features.shape: torch.Size([8, 768])
pred.shape: torch.Size([8, 2])
label.shape: torch.Size([8])
pred.shape: torch.Size([8, 2])
x.shape: torch.Size([8, 8, 3, 224, 224])
x.ndim: 5
x.shape: torch.Size([64, 3, 224, 224])
batch_size: 64
embeddings.shape: torch.Size([64, 197, 768])
input_ini - x shape before view: torch.Size([8, 8, 196, 768])
input_ini - x shape after first reshape: torch.Size([1568, 8, 768])
input_ini - x shape after cat: torch.Size([1568, 9, 768])
input_ini - x shape before final reshape: torch.Size([1568, 8, 768])
input_ini - x shape after final reshape: torch.Size([8, 196, 8, 768])
input_ini - x shape at end: torch.Size([8, 1568, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
cls_token.shape: torch.Size([8, 8, 1, 768])
patch_token.shape: torch.Size([8, 8, 196, 768])
x.shape: torch.Size([64, 197, 768])
x2.shape: torch.Size([64, 197, 768])
temporal.shape: torch.Size([64, 768])
cls_token.shape: torch.Size([64, 768])
### cls_token.shape: torch.Size([8, 768])
features.shape: torch.Size([8, 768])
pred.shape: torch.Size([8, 2])
label.shape: torch.Size([8])
pred.shape: torch.Size([8, 2])
x.shape: torch.Size([8, 8, 3, 224, 224])
x.ndim: 5
x.shape: torch.Size([64, 3, 224, 224])
batch_size: 64
embeddings.shape: torch.Size([64, 197, 768])
input_ini - x shape before view: torch.Size([8, 8, 196, 768])
input_ini - x shape after first reshape: torch.Size([1568, 8, 768])
input_ini - x shape after cat: torch.Size([1568, 9, 768])
input_ini - x shape before final reshape: torch.Size([1568, 8, 768])
input_ini - x shape after final reshape: torch.Size([8, 196, 8, 768])
input_ini - x shape at end: torch.Size([8, 1568, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
cls_token.shape: torch.Size([8, 8, 1, 768])
patch_token.shape: torch.Size([8, 8, 196, 768])
x.shape: torch.Size([64, 197, 768])
x2.shape: torch.Size([64, 197, 768])
temporal.shape: torch.Size([64, 768])
cls_token.shape: torch.Size([64, 768])
### cls_token.shape: torch.Size([8, 768])
features.shape: torch.Size([8, 768])
pred.shape: torch.Size([8, 2])
label.shape: torch.Size([8])
pred.shape: torch.Size([8, 2])
x.shape: torch.Size([8, 8, 3, 224, 224])
x.ndim: 5
x.shape: torch.Size([64, 3, 224, 224])
batch_size: 64
embeddings.shape: torch.Size([64, 197, 768])
input_ini - x shape before view: torch.Size([8, 8, 196, 768])
input_ini - x shape after first reshape: torch.Size([1568, 8, 768])
input_ini - x shape after cat: torch.Size([1568, 9, 768])
input_ini - x shape before final reshape: torch.Size([1568, 8, 768])
input_ini - x shape after final reshape: torch.Size([8, 196, 8, 768])
input_ini - x shape at end: torch.Size([8, 1568, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
cls_token.shape: torch.Size([8, 8, 1, 768])
patch_token.shape: torch.Size([8, 8, 196, 768])
x.shape: torch.Size([64, 197, 768])
x2.shape: torch.Size([64, 197, 768])
temporal.shape: torch.Size([64, 768])
cls_token.shape: torch.Size([64, 768])
### cls_token.shape: torch.Size([8, 768])
features.shape: torch.Size([8, 768])
pred.shape: torch.Size([8, 2])
label.shape: torch.Size([8])
pred.shape: torch.Size([8, 2])
x.shape: torch.Size([8, 8, 3, 224, 224])
x.ndim: 5
x.shape: torch.Size([64, 3, 224, 224])
batch_size: 64
embeddings.shape: torch.Size([64, 197, 768])
input_ini - x shape before view: torch.Size([8, 8, 196, 768])
input_ini - x shape after first reshape: torch.Size([1568, 8, 768])
input_ini - x shape after cat: torch.Size([1568, 9, 768])
input_ini - x shape before final reshape: torch.Size([1568, 8, 768])
input_ini - x shape after final reshape: torch.Size([8, 196, 8, 768])
input_ini - x shape at end: torch.Size([8, 1568, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
cls_token.shape: torch.Size([8, 8, 1, 768])
patch_token.shape: torch.Size([8, 8, 196, 768])
x.shape: torch.Size([64, 197, 768])
x2.shape: torch.Size([64, 197, 768])
temporal.shape: torch.Size([64, 768])
cls_token.shape: torch.Size([64, 768])
### cls_token.shape: torch.Size([8, 768])
features.shape: torch.Size([8, 768])
pred.shape: torch.Size([8, 2])
label.shape: torch.Size([8])
pred.shape: torch.Size([8, 2])
x.shape: torch.Size([8, 8, 3, 224, 224])
x.ndim: 5
x.shape: torch.Size([64, 3, 224, 224])
batch_size: 64
embeddings.shape: torch.Size([64, 197, 768])
input_ini - x shape before view: torch.Size([8, 8, 196, 768])
input_ini - x shape after first reshape: torch.Size([1568, 8, 768])
input_ini - x shape after cat: torch.Size([1568, 9, 768])
input_ini - x shape before final reshape: torch.Size([1568, 8, 768])

 54%|█████▍    | 7/13 [00:01<00:00,  6.48it/s][A
 62%|██████▏   | 8/13 [00:01<00:00,  6.76it/s][A
 69%|██████▉   | 9/13 [00:01<00:00,  6.97it/s][A
 77%|███████▋  | 10/13 [00:01<00:00,  7.12it/s][A
 85%|████████▍ | 11/13 [00:02<00:00,  7.22it/s][A
 92%|█████████▏| 12/13 [00:02<00:00,  7.29it/s][Ainput_ini - x shape after final reshape: torch.Size([8, 196, 8, 768])
input_ini - x shape at end: torch.Size([8, 1568, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
cls_token.shape: torch.Size([8, 8, 1, 768])
patch_token.shape: torch.Size([8, 8, 196, 768])
x.shape: torch.Size([64, 197, 768])
x2.shape: torch.Size([64, 197, 768])
temporal.shape: torch.Size([64, 768])
cls_token.shape: torch.Size([64, 768])
### cls_token.shape: torch.Size([8, 768])
features.shape: torch.Size([8, 768])
pred.shape: torch.Size([8, 2])
label.shape: torch.Size([8])
pred.shape: torch.Size([8, 2])
x.shape: torch.Size([8, 8, 3, 224, 224])
x.ndim: 5
x.shape: torch.Size([64, 3, 224, 224])
batch_size: 64
embeddings.shape: torch.Size([64, 197, 768])
input_ini - x shape before view: torch.Size([8, 8, 196, 768])
input_ini - x shape after first reshape: torch.Size([1568, 8, 768])
input_ini - x shape after cat: torch.Size([1568, 9, 768])
input_ini - x shape before final reshape: torch.Size([1568, 8, 768])
input_ini - x shape after final reshape: torch.Size([8, 196, 8, 768])
input_ini - x shape at end: torch.Size([8, 1568, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
cls_token.shape: torch.Size([8, 8, 1, 768])
patch_token.shape: torch.Size([8, 8, 196, 768])
x.shape: torch.Size([64, 197, 768])
x2.shape: torch.Size([64, 197, 768])
temporal.shape: torch.Size([64, 768])
cls_token.shape: torch.Size([64, 768])
### cls_token.shape: torch.Size([8, 768])
features.shape: torch.Size([8, 768])
pred.shape: torch.Size([8, 2])
label.shape: torch.Size([8])
pred.shape: torch.Size([8, 2])
x.shape: torch.Size([8, 8, 3, 224, 224])
x.ndim: 5
x.shape: torch.Size([64, 3, 224, 224])
batch_size: 64
embeddings.shape: torch.Size([64, 197, 768])
input_ini - x shape before view: torch.Size([8, 8, 196, 768])
input_ini - x shape after first reshape: torch.Size([1568, 8, 768])
input_ini - x shape after cat: torch.Size([1568, 9, 768])
input_ini - x shape before final reshape: torch.Size([1568, 8, 768])
input_ini - x shape after final reshape: torch.Size([8, 196, 8, 768])
input_ini - x shape at end: torch.Size([8, 1568, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
cls_token.shape: torch.Size([8, 8, 1, 768])
patch_token.shape: torch.Size([8, 8, 196, 768])
x.shape: torch.Size([64, 197, 768])
x2.shape: torch.Size([64, 197, 768])
temporal.shape: torch.Size([64, 768])
cls_token.shape: torch.Size([64, 768])
### cls_token.shape: torch.Size([8, 768])
features.shape: torch.Size([8, 768])
pred.shape: torch.Size([8, 2])
label.shape: torch.Size([8])
pred.shape: torch.Size([8, 2])
x.shape: torch.Size([8, 8, 3, 224, 224])
x.ndim: 5
x.shape: torch.Size([64, 3, 224, 224])
batch_size: 64
embeddings.shape: torch.Size([64, 197, 768])
input_ini - x shape before view: torch.Size([8, 8, 196, 768])
input_ini - x shape after first reshape: torch.Size([1568, 8, 768])
input_ini - x shape after cat: torch.Size([1568, 9, 768])
input_ini - x shape before final reshape: torch.Size([1568, 8, 768])
input_ini - x shape after final reshape: torch.Size([8, 196, 8, 768])
input_ini - x shape at end: torch.Size([8, 1568, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
cls_token.shape: torch.Size([8, 8, 1, 768])
patch_token.shape: torch.Size([8, 8, 196, 768])
x.shape: torch.Size([64, 197, 768])
x2.shape: torch.Size([64, 197, 768])
temporal.shape: torch.Size([64, 768])
cls_token.shape: torch.Size([64, 768])
### cls_token.shape: torch.Size([8, 768])
features.shape: torch.Size([8, 768])
pred.shape: torch.Size([8, 2])
label.shape: torch.Size([8])
pred.shape: torch.Size([8, 2])
x.shape: torch.Size([8, 8, 3, 224, 224])
x.ndim: 5
x.shape: torch.Size([64, 3, 224, 224])
batch_size: 64
embeddings.shape: torch.Size([64, 197, 768])
input_ini - x shape before view: torch.Size([8, 8, 196, 768])
input_ini - x shape after first reshape: torch.Size([1568, 8, 768])
input_ini - x shape after cat: torch.Size([1568, 9, 768])
input_ini - x shape before final reshape: torch.Size([1568, 8, 768])
input_ini - x shape after final reshape: torch.Size([8, 196, 8, 768])
input_ini - x shape at end: torch.Size([8, 1568, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
cls_token.shape: torch.Size([8, 8, 1, 768])
patch_token.shape: torch.Size([8, 8, 196, 768])
x.shape: torch.Size([64, 197, 768])
x2.shape: torch.Size([64, 197, 768])
temporal.shape: torch.Size([64, 768])
cls_token.shape: torch.Size([64, 768])
### cls_token.shape: torch.Size([8, 768])
features.shape: torch.Size([8, 768])
pred.shape: torch.Size([8, 2])
label.shape: torch.Size([8])
pred.shape: torch.Size([8, 2])
x.shape: torch.Size([8, 8, 3, 224, 224])
x.ndim: 5
x.shape: torch.Size([64, 3, 224, 224])
batch_size: 64
embeddings.shape: torch.Size([64, 197, 768])
input_ini - x shape before view: torch.Size([8, 8, 196, 768])
input_ini - x shape after first reshape: torch.Size([1568, 8, 768])
input_ini - x shape after cat: torch.Size([1568, 9, 768])
input_ini - x shape before final reshape: torch.Size([1568, 8, 768])
input_ini - x shape after final reshape: torch.Size([8, 196, 8, 768])
input_ini - x shape at end: torch.Size([8, 1568, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
cls_token.shape: torch.Size([8, 8, 1, 768])
patch_token.shape: torch.Size([8, 8, 196, 768])
x.shape: torch.Size([64, 197, 768])
x2.shape: torch.Size([64, 197, 768])
temporal.shape: torch.Size([64, 768])
cls_token.shape: torch.Size([64, 768])
### cls_token.shape: torch.Size([8, 768])
features.shape: torch.Size([8, 768])
pred.shape: torch.Size([8, 2])
label.shape: torch.Size([8])
pred.shape: torch.Size([8, 2])
x.shape: torch.Size([4, 8, 3, 224, 224])
x.ndim: 5
x.shape: torch.Size([32, 3, 224, 224])
batch_size: 32
embeddings.shape: torch.Size([32, 197, 768])
input_ini - x shape before view: torch.Size([4, 8, 196, 768])
input_ini - x shape after first reshape: torch.Size([784, 8, 768])
input_ini - x shape after cat: torch.Size([784, 9, 768])
input_ini - x shape before final reshape: torch.Size([784, 8, 768])
input_ini - x shape after final reshape: torch.Size([4, 196, 8, 768])
input_ini - x shape at end: torch.Size([4, 1568, 768])
x2.shape): torch.Size([4, 1569, 768])
(x1.shape): torch.Size([4, 1569, 768])
(x2.shape): torch.Size([4, 1569, 768])
x2.shape): torch.Size([4, 1569, 768])
(x1.shape): torch.Size([4, 1569, 768])
(x2.shape): torch.Size([4, 1569, 768])
x2.shape): torch.Size([4, 1569, 768])
(x1.shape): torch.Size([4, 1569, 768])
100%|██████████| 13/13 [00:02<00:00,  5.88it/s]
2025-05-30 10:56:52,824 - INFO - dataset: DFDC    step: 21    testing-loss, overall: 0.68017578125    
2025-05-30 10:56:52,824 - INFO - dataset: DFDC    step: 21    testing-metric, acc: 0.65    testing-metric, auc: 0.501978021978022    testing-metric, eer: 0.4857142857142857    testing-metric, ap: 0.7011498704413794    testing-metric, video_auc: 0.501978021978022    testing-metric, acc_real:0.7714285714285715; acc_fake:0.5846153846153846
2025-05-30 10:56:52,825 - INFO - dataset: avg    step: 21    testing-metric, acc: 0.65    testing-metric, auc: 0.501978021978022    testing-metric, eer: 0.4857142857142857    testing-metric, ap: 0.7011498704413794    testing-metric, video_auc: 0.501978021978022    
2025-05-30 10:56:52,825 - INFO - ===> Test Done!
 50%|█████     | 2/4 [00:04<00:04,  2.49s/it] 75%|███████▌  | 3/4 [00:05<00:01,  1.59s/it]2025-05-30 10:56:53,416 - INFO - ===> Test start!
2025-05-30 10:56:53,419 - INFO - data_dict saved to ./logs/training/clip_stan_2025-05-30-10-56-05/test/DFDC/data_dict_test.pickle
(x2.shape): torch.Size([4, 1569, 768])
cls_token.shape: torch.Size([4, 8, 1, 768])
patch_token.shape: torch.Size([4, 8, 196, 768])
x.shape: torch.Size([32, 197, 768])
x2.shape: torch.Size([32, 197, 768])
temporal.shape: torch.Size([32, 768])
cls_token.shape: torch.Size([32, 768])
### cls_token.shape: torch.Size([4, 768])
features.shape: torch.Size([4, 768])
pred.shape: torch.Size([4, 2])
label.shape: torch.Size([4])
pred.shape: torch.Size([4, 2])
len(y_pred): 100
len(y_true): 100
x.shape: torch.Size([32, 8, 3, 224, 224])
x.ndim: 5
x.shape: torch.Size([256, 3, 224, 224])
batch_size: 256
embeddings.shape: torch.Size([256, 197, 768])
input_ini - x shape before view: torch.Size([32, 8, 196, 768])
input_ini - x shape after first reshape: torch.Size([6272, 8, 768])
input_ini - x shape after cat: torch.Size([6272, 9, 768])
input_ini - x shape before final reshape: torch.Size([6272, 8, 768])
input_ini - x shape after final reshape: torch.Size([32, 196, 8, 768])
input_ini - x shape at end: torch.Size([32, 1568, 768])
x2.shape): torch.Size([32, 1569, 768])
(x1.shape): torch.Size([32, 1569, 768])
(x2.shape): torch.Size([32, 1569, 768])
x2.shape): torch.Size([32, 1569, 768])
(x1.shape): torch.Size([32, 1569, 768])
(x2.shape): torch.Size([32, 1569, 768])
x2.shape): torch.Size([32, 1569, 768])
(x1.shape): torch.Size([32, 1569, 768])
(x2.shape): torch.Size([32, 1569, 768])
cls_token.shape: torch.Size([32, 8, 1, 768])
patch_token.shape: torch.Size([32, 8, 196, 768])
x.shape: torch.Size([256, 197, 768])
x2.shape: torch.Size([256, 197, 768])
temporal.shape: torch.Size([256, 768])
cls_token.shape: torch.Size([256, 768])
### cls_token.shape: torch.Size([32, 768])
features.shape: torch.Size([32, 768])
pred.shape: torch.Size([32, 2])
label.shape: torch.Size([32])
pred.shape: torch.Size([32, 2])
x.shape: torch.Size([4, 8, 3, 224, 224])
x.ndim: 5
x.shape: torch.Size([32, 3, 224, 224])
batch_size: 32
embeddings.shape: torch.Size([32, 197, 768])
input_ini - x shape before view: torch.Size([4, 8, 196, 768])
input_ini - x shape after first reshape: torch.Size([784, 8, 768])
input_ini - x shape after cat: torch.Size([784, 9, 768])
input_ini - x shape before final reshape: torch.Size([784, 8, 768])
input_ini - x shape after final reshape: torch.Size([4, 196, 8, 768])
input_ini - x shape at end: torch.Size([4, 1568, 768])
x2.shape): torch.Size([4, 1569, 768])
(x1.shape): torch.Size([4, 1569, 768])
(x2.shape): torch.Size([4, 1569, 768])
x2.shape): torch.Size([4, 1569, 768])
(x1.shape): torch.Size([4, 1569, 768])
(x2.shape): torch.Size([4, 1569, 768])
x2.shape): torch.Size([4, 1569, 768])
(x1.shape): torch.Size([4, 1569, 768])
(x2.shape): torch.Size([4, 1569, 768])
cls_token.shape: torch.Size([4, 8, 1, 768])
patch_token.shape: torch.Size([4, 8, 196, 768])
x.shape: torch.Size([32, 197, 768])
x2.shape: torch.Size([32, 197, 768])
temporal.shape: torch.Size([32, 768])
cls_token.shape: torch.Size([32, 768])
### cls_token.shape: torch.Size([4, 768])
features.shape: torch.Size([4, 768])
pred.shape: torch.Size([4, 2])
label.shape: torch.Size([4])
pred.shape: torch.Size([4, 2])

  0%|          | 0/13 [00:00<?, ?it/s][A
  8%|▊         | 1/13 [00:00<00:08,  1.44it/s][A
 15%|█▌        | 2/13 [00:00<00:04,  2.74it/s][A
 23%|██▎       | 3/13 [00:00<00:02,  3.85it/s][A
 31%|███       | 4/13 [00:01<00:01,  4.76it/s][A
 38%|███▊      | 5/13 [00:01<00:01,  5.48it/s][A
 46%|████▌     | 6/13 [00:01<00:01,  6.03it/s][Ax.shape: torch.Size([8, 8, 3, 224, 224])
x.ndim: 5
x.shape: torch.Size([64, 3, 224, 224])
batch_size: 64
embeddings.shape: torch.Size([64, 197, 768])
input_ini - x shape before view: torch.Size([8, 8, 196, 768])
input_ini - x shape after first reshape: torch.Size([1568, 8, 768])
input_ini - x shape after cat: torch.Size([1568, 9, 768])
input_ini - x shape before final reshape: torch.Size([1568, 8, 768])
input_ini - x shape after final reshape: torch.Size([8, 196, 8, 768])
input_ini - x shape at end: torch.Size([8, 1568, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
cls_token.shape: torch.Size([8, 8, 1, 768])
patch_token.shape: torch.Size([8, 8, 196, 768])
x.shape: torch.Size([64, 197, 768])
x2.shape: torch.Size([64, 197, 768])
temporal.shape: torch.Size([64, 768])
cls_token.shape: torch.Size([64, 768])
### cls_token.shape: torch.Size([8, 768])
features.shape: torch.Size([8, 768])
pred.shape: torch.Size([8, 2])
label.shape: torch.Size([8])
pred.shape: torch.Size([8, 2])
x.shape: torch.Size([8, 8, 3, 224, 224])
x.ndim: 5
x.shape: torch.Size([64, 3, 224, 224])
batch_size: 64
embeddings.shape: torch.Size([64, 197, 768])
input_ini - x shape before view: torch.Size([8, 8, 196, 768])
input_ini - x shape after first reshape: torch.Size([1568, 8, 768])
input_ini - x shape after cat: torch.Size([1568, 9, 768])
input_ini - x shape before final reshape: torch.Size([1568, 8, 768])
input_ini - x shape after final reshape: torch.Size([8, 196, 8, 768])
input_ini - x shape at end: torch.Size([8, 1568, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
cls_token.shape: torch.Size([8, 8, 1, 768])
patch_token.shape: torch.Size([8, 8, 196, 768])
x.shape: torch.Size([64, 197, 768])
x2.shape: torch.Size([64, 197, 768])
temporal.shape: torch.Size([64, 768])
cls_token.shape: torch.Size([64, 768])
### cls_token.shape: torch.Size([8, 768])
features.shape: torch.Size([8, 768])
pred.shape: torch.Size([8, 2])
label.shape: torch.Size([8])
pred.shape: torch.Size([8, 2])
x.shape: torch.Size([8, 8, 3, 224, 224])
x.ndim: 5
x.shape: torch.Size([64, 3, 224, 224])
batch_size: 64
embeddings.shape: torch.Size([64, 197, 768])
input_ini - x shape before view: torch.Size([8, 8, 196, 768])
input_ini - x shape after first reshape: torch.Size([1568, 8, 768])
input_ini - x shape after cat: torch.Size([1568, 9, 768])
input_ini - x shape before final reshape: torch.Size([1568, 8, 768])
input_ini - x shape after final reshape: torch.Size([8, 196, 8, 768])
input_ini - x shape at end: torch.Size([8, 1568, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
cls_token.shape: torch.Size([8, 8, 1, 768])
patch_token.shape: torch.Size([8, 8, 196, 768])
x.shape: torch.Size([64, 197, 768])
x2.shape: torch.Size([64, 197, 768])
temporal.shape: torch.Size([64, 768])
cls_token.shape: torch.Size([64, 768])
### cls_token.shape: torch.Size([8, 768])
features.shape: torch.Size([8, 768])
pred.shape: torch.Size([8, 2])
label.shape: torch.Size([8])
pred.shape: torch.Size([8, 2])
x.shape: torch.Size([8, 8, 3, 224, 224])
x.ndim: 5
x.shape: torch.Size([64, 3, 224, 224])
batch_size: 64
embeddings.shape: torch.Size([64, 197, 768])
input_ini - x shape before view: torch.Size([8, 8, 196, 768])
input_ini - x shape after first reshape: torch.Size([1568, 8, 768])
input_ini - x shape after cat: torch.Size([1568, 9, 768])
input_ini - x shape before final reshape: torch.Size([1568, 8, 768])
input_ini - x shape after final reshape: torch.Size([8, 196, 8, 768])
input_ini - x shape at end: torch.Size([8, 1568, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
cls_token.shape: torch.Size([8, 8, 1, 768])
patch_token.shape: torch.Size([8, 8, 196, 768])
x.shape: torch.Size([64, 197, 768])
x2.shape: torch.Size([64, 197, 768])
temporal.shape: torch.Size([64, 768])
cls_token.shape: torch.Size([64, 768])
### cls_token.shape: torch.Size([8, 768])
features.shape: torch.Size([8, 768])
pred.shape: torch.Size([8, 2])
label.shape: torch.Size([8])
pred.shape: torch.Size([8, 2])
x.shape: torch.Size([8, 8, 3, 224, 224])
x.ndim: 5
x.shape: torch.Size([64, 3, 224, 224])
batch_size: 64
embeddings.shape: torch.Size([64, 197, 768])
input_ini - x shape before view: torch.Size([8, 8, 196, 768])
input_ini - x shape after first reshape: torch.Size([1568, 8, 768])
input_ini - x shape after cat: torch.Size([1568, 9, 768])
input_ini - x shape before final reshape: torch.Size([1568, 8, 768])
input_ini - x shape after final reshape: torch.Size([8, 196, 8, 768])
input_ini - x shape at end: torch.Size([8, 1568, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
cls_token.shape: torch.Size([8, 8, 1, 768])
patch_token.shape: torch.Size([8, 8, 196, 768])
x.shape: torch.Size([64, 197, 768])
x2.shape: torch.Size([64, 197, 768])
temporal.shape: torch.Size([64, 768])
cls_token.shape: torch.Size([64, 768])
### cls_token.shape: torch.Size([8, 768])
features.shape: torch.Size([8, 768])
pred.shape: torch.Size([8, 2])
label.shape: torch.Size([8])
pred.shape: torch.Size([8, 2])
x.shape: torch.Size([8, 8, 3, 224, 224])
x.ndim: 5
x.shape: torch.Size([64, 3, 224, 224])
batch_size: 64
embeddings.shape: torch.Size([64, 197, 768])
input_ini - x shape before view: torch.Size([8, 8, 196, 768])
input_ini - x shape after first reshape: torch.Size([1568, 8, 768])
input_ini - x shape after cat: torch.Size([1568, 9, 768])
input_ini - x shape before final reshape: torch.Size([1568, 8, 768])
input_ini - x shape after final reshape: torch.Size([8, 196, 8, 768])
input_ini - x shape at end: torch.Size([8, 1568, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
cls_token.shape: torch.Size([8, 8, 1, 768])
patch_token.shape: torch.Size([8, 8, 196, 768])
x.shape: torch.Size([64, 197, 768])
x2.shape: torch.Size([64, 197, 768])
temporal.shape: torch.Size([64, 768])
cls_token.shape: torch.Size([64, 768])
### cls_token.shape: torch.Size([8, 768])
features.shape: torch.Size([8, 768])
pred.shape: torch.Size([8, 2])
label.shape: torch.Size([8])
pred.shape: torch.Size([8, 2])
x.shape: torch.Size([8, 8, 3, 224, 224])
x.ndim: 5
x.shape: torch.Size([64, 3, 224, 224])
batch_size: 64
embeddings.shape: torch.Size([64, 197, 768])
input_ini - x shape before view: torch.Size([8, 8, 196, 768])
input_ini - x shape after first reshape: torch.Size([1568, 8, 768])
input_ini - x shape after cat: torch.Size([1568, 9, 768])
input_ini - x shape before final reshape: torch.Size([1568, 8, 768])

 54%|█████▍    | 7/13 [00:01<00:00,  6.44it/s][A
 62%|██████▏   | 8/13 [00:01<00:00,  6.74it/s][A
 69%|██████▉   | 9/13 [00:01<00:00,  6.94it/s][A
 77%|███████▋  | 10/13 [00:01<00:00,  7.10it/s][A
 85%|████████▍ | 11/13 [00:02<00:00,  7.20it/s][A
 92%|█████████▏| 12/13 [00:02<00:00,  7.26it/s][Ainput_ini - x shape after final reshape: torch.Size([8, 196, 8, 768])
input_ini - x shape at end: torch.Size([8, 1568, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
cls_token.shape: torch.Size([8, 8, 1, 768])
patch_token.shape: torch.Size([8, 8, 196, 768])
x.shape: torch.Size([64, 197, 768])
x2.shape: torch.Size([64, 197, 768])
temporal.shape: torch.Size([64, 768])
cls_token.shape: torch.Size([64, 768])
### cls_token.shape: torch.Size([8, 768])
features.shape: torch.Size([8, 768])
pred.shape: torch.Size([8, 2])
label.shape: torch.Size([8])
pred.shape: torch.Size([8, 2])
x.shape: torch.Size([8, 8, 3, 224, 224])
x.ndim: 5
x.shape: torch.Size([64, 3, 224, 224])
batch_size: 64
embeddings.shape: torch.Size([64, 197, 768])
input_ini - x shape before view: torch.Size([8, 8, 196, 768])
input_ini - x shape after first reshape: torch.Size([1568, 8, 768])
input_ini - x shape after cat: torch.Size([1568, 9, 768])
input_ini - x shape before final reshape: torch.Size([1568, 8, 768])
input_ini - x shape after final reshape: torch.Size([8, 196, 8, 768])
input_ini - x shape at end: torch.Size([8, 1568, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
cls_token.shape: torch.Size([8, 8, 1, 768])
patch_token.shape: torch.Size([8, 8, 196, 768])
x.shape: torch.Size([64, 197, 768])
x2.shape: torch.Size([64, 197, 768])
temporal.shape: torch.Size([64, 768])
cls_token.shape: torch.Size([64, 768])
### cls_token.shape: torch.Size([8, 768])
features.shape: torch.Size([8, 768])
pred.shape: torch.Size([8, 2])
label.shape: torch.Size([8])
pred.shape: torch.Size([8, 2])
x.shape: torch.Size([8, 8, 3, 224, 224])
x.ndim: 5
x.shape: torch.Size([64, 3, 224, 224])
batch_size: 64
embeddings.shape: torch.Size([64, 197, 768])
input_ini - x shape before view: torch.Size([8, 8, 196, 768])
input_ini - x shape after first reshape: torch.Size([1568, 8, 768])
input_ini - x shape after cat: torch.Size([1568, 9, 768])
input_ini - x shape before final reshape: torch.Size([1568, 8, 768])
input_ini - x shape after final reshape: torch.Size([8, 196, 8, 768])
input_ini - x shape at end: torch.Size([8, 1568, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
cls_token.shape: torch.Size([8, 8, 1, 768])
patch_token.shape: torch.Size([8, 8, 196, 768])
x.shape: torch.Size([64, 197, 768])
x2.shape: torch.Size([64, 197, 768])
temporal.shape: torch.Size([64, 768])
cls_token.shape: torch.Size([64, 768])
### cls_token.shape: torch.Size([8, 768])
features.shape: torch.Size([8, 768])
pred.shape: torch.Size([8, 2])
label.shape: torch.Size([8])
pred.shape: torch.Size([8, 2])
x.shape: torch.Size([8, 8, 3, 224, 224])
x.ndim: 5
x.shape: torch.Size([64, 3, 224, 224])
batch_size: 64
embeddings.shape: torch.Size([64, 197, 768])
input_ini - x shape before view: torch.Size([8, 8, 196, 768])
input_ini - x shape after first reshape: torch.Size([1568, 8, 768])
input_ini - x shape after cat: torch.Size([1568, 9, 768])
input_ini - x shape before final reshape: torch.Size([1568, 8, 768])
input_ini - x shape after final reshape: torch.Size([8, 196, 8, 768])
input_ini - x shape at end: torch.Size([8, 1568, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
cls_token.shape: torch.Size([8, 8, 1, 768])
patch_token.shape: torch.Size([8, 8, 196, 768])
x.shape: torch.Size([64, 197, 768])
x2.shape: torch.Size([64, 197, 768])
temporal.shape: torch.Size([64, 768])
cls_token.shape: torch.Size([64, 768])
### cls_token.shape: torch.Size([8, 768])
features.shape: torch.Size([8, 768])
pred.shape: torch.Size([8, 2])
label.shape: torch.Size([8])
pred.shape: torch.Size([8, 2])
x.shape: torch.Size([8, 8, 3, 224, 224])
x.ndim: 5
x.shape: torch.Size([64, 3, 224, 224])
batch_size: 64
embeddings.shape: torch.Size([64, 197, 768])
input_ini - x shape before view: torch.Size([8, 8, 196, 768])
input_ini - x shape after first reshape: torch.Size([1568, 8, 768])
input_ini - x shape after cat: torch.Size([1568, 9, 768])
input_ini - x shape before final reshape: torch.Size([1568, 8, 768])
input_ini - x shape after final reshape: torch.Size([8, 196, 8, 768])
input_ini - x shape at end: torch.Size([8, 1568, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
cls_token.shape: torch.Size([8, 8, 1, 768])
patch_token.shape: torch.Size([8, 8, 196, 768])
x.shape: torch.Size([64, 197, 768])
x2.shape: torch.Size([64, 197, 768])
temporal.shape: torch.Size([64, 768])
cls_token.shape: torch.Size([64, 768])
### cls_token.shape: torch.Size([8, 768])
features.shape: torch.Size([8, 768])
pred.shape: torch.Size([8, 2])
label.shape: torch.Size([8])
pred.shape: torch.Size([8, 2])
x.shape: torch.Size([8, 8, 3, 224, 224])
x.ndim: 5
x.shape: torch.Size([64, 3, 224, 224])
batch_size: 64
embeddings.shape: torch.Size([64, 197, 768])
input_ini - x shape before view: torch.Size([8, 8, 196, 768])
input_ini - x shape after first reshape: torch.Size([1568, 8, 768])
input_ini - x shape after cat: torch.Size([1568, 9, 768])
input_ini - x shape before final reshape: torch.Size([1568, 8, 768])
input_ini - x shape after final reshape: torch.Size([8, 196, 8, 768])
input_ini - x shape at end: torch.Size([8, 1568, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
cls_token.shape: torch.Size([8, 8, 1, 768])
patch_token.shape: torch.Size([8, 8, 196, 768])
x.shape: torch.Size([64, 197, 768])
x2.shape: torch.Size([64, 197, 768])
temporal.shape: torch.Size([64, 768])
cls_token.shape: torch.Size([64, 768])
### cls_token.shape: torch.Size([8, 768])
features.shape: torch.Size([8, 768])
pred.shape: torch.Size([8, 2])
label.shape: torch.Size([8])
pred.shape: torch.Size([8, 2])
x.shape: torch.Size([4, 8, 3, 224, 224])
x.ndim: 5
x.shape: torch.Size([32, 3, 224, 224])
batch_size: 32
embeddings.shape: torch.Size([32, 197, 768])
input_ini - x shape before view: torch.Size([4, 8, 196, 768])
input_ini - x shape after first reshape: torch.Size([784, 8, 768])
input_ini - x shape after cat: torch.Size([784, 9, 768])
input_ini - x shape before final reshape: torch.Size([784, 8, 768])
input_ini - x shape after final reshape: torch.Size([4, 196, 8, 768])
input_ini - x shape at end: torch.Size([4, 1568, 768])
x2.shape): torch.Size([4, 1569, 768])
(x1.shape): torch.Size([4, 1569, 768])
(x2.shape): torch.Size([4, 1569, 768])
x2.shape): torch.Size([4, 1569, 768])
(x1.shape): torch.Size([4, 1569, 768])
(x2.shape): torch.Size([4, 1569, 768])
x2.shape): torch.Size([4, 1569, 768])
(x1.shape): torch.Size([4, 1569, 768])
100%|██████████| 13/13 [00:02<00:00,  5.80it/s]
2025-05-30 10:56:55,675 - INFO - dataset: DFDC    step: 23    testing-loss, overall: 0.6796875    
2025-05-30 10:56:55,675 - INFO - dataset: DFDC    step: 23    testing-metric, acc: 0.65    testing-metric, auc: 0.5008791208791209    testing-metric, eer: 0.4857142857142857    testing-metric, ap: 0.7007984087424137    testing-metric, video_auc: 0.5008791208791209    testing-metric, acc_real:0.7714285714285715; acc_fake:0.5846153846153846
2025-05-30 10:56:55,680 - INFO - dataset: avg    step: 23    testing-metric, acc: 0.65    testing-metric, auc: 0.5008791208791209    testing-metric, eer: 0.4857142857142857    testing-metric, ap: 0.7007984087424137    testing-metric, video_auc: 0.5008791208791209    
2025-05-30 10:56:55,680 - INFO - ===> Test Done!
100%|██████████| 4/4 [00:07<00:00,  1.89s/it]100%|██████████| 4/4 [00:07<00:00,  1.93s/it]
2025-05-30 10:56:55,687 - INFO - ===> Epoch[5] end with testing auc: 
================================ Each dataset best metric ================================ 
| DFDC:  auc=0.5090109890109891 | 
============================================================================================= 
================================== Average best metric ====================================== 
| avg auc: 0.5090109890109891 | 
| DFDC: 0.5090109890109891 | 
=============================================================================================!
2025-05-30 10:56:55,687 - INFO - ===> Epoch[6] start!
2025-05-30 10:56:55,688 - INFO - data_dict saved to ./logs/training/clip_stan_2025-05-30-10-56-05/train/FaceForensics++/data_dict_train.pickle
(x2.shape): torch.Size([4, 1569, 768])
cls_token.shape: torch.Size([4, 8, 1, 768])
patch_token.shape: torch.Size([4, 8, 196, 768])
x.shape: torch.Size([32, 197, 768])
x2.shape: torch.Size([32, 197, 768])
temporal.shape: torch.Size([32, 768])
cls_token.shape: torch.Size([32, 768])
### cls_token.shape: torch.Size([4, 768])
features.shape: torch.Size([4, 768])
pred.shape: torch.Size([4, 2])
label.shape: torch.Size([4])
pred.shape: torch.Size([4, 2])
len(y_pred): 100
len(y_true): 100
  0%|          | 0/4 [00:00<?, ?it/s]2025-05-30 10:56:58,278 - INFO - Iter: 24    training-loss, overall: 0.6804351806640625    
2025-05-30 10:56:58,278 - INFO - Iter: 24    training-metric, acc: 0.625    training-metric, auc: 0.7770833333333332    training-metric, eer: 0.4166666666666667    training-metric, ap: 0.8690527347049086    
 25%|██▌       | 1/4 [00:02<00:07,  2.58s/it]2025-05-30 10:56:58,795 - INFO - ===> Test start!
2025-05-30 10:56:58,797 - INFO - data_dict saved to ./logs/training/clip_stan_2025-05-30-10-56-05/test/DFDC/data_dict_test.pickle
x.shape: torch.Size([32, 8, 3, 224, 224])
x.ndim: 5
x.shape: torch.Size([256, 3, 224, 224])
batch_size: 256
embeddings.shape: torch.Size([256, 197, 768])
input_ini - x shape before view: torch.Size([32, 8, 196, 768])
input_ini - x shape after first reshape: torch.Size([6272, 8, 768])
input_ini - x shape after cat: torch.Size([6272, 9, 768])
input_ini - x shape before final reshape: torch.Size([6272, 8, 768])
input_ini - x shape after final reshape: torch.Size([32, 196, 8, 768])
input_ini - x shape at end: torch.Size([32, 1568, 768])
x2.shape): torch.Size([32, 1569, 768])
(x1.shape): torch.Size([32, 1569, 768])
(x2.shape): torch.Size([32, 1569, 768])
x2.shape): torch.Size([32, 1569, 768])
(x1.shape): torch.Size([32, 1569, 768])
(x2.shape): torch.Size([32, 1569, 768])
x2.shape): torch.Size([32, 1569, 768])
(x1.shape): torch.Size([32, 1569, 768])
(x2.shape): torch.Size([32, 1569, 768])
cls_token.shape: torch.Size([32, 8, 1, 768])
patch_token.shape: torch.Size([32, 8, 196, 768])
x.shape: torch.Size([256, 197, 768])
x2.shape: torch.Size([256, 197, 768])
temporal.shape: torch.Size([256, 768])
cls_token.shape: torch.Size([256, 768])
### cls_token.shape: torch.Size([32, 768])
features.shape: torch.Size([32, 768])
pred.shape: torch.Size([32, 2])
label.shape: torch.Size([32])
pred.shape: torch.Size([32, 2])
x.shape: torch.Size([32, 8, 3, 224, 224])
x.ndim: 5
x.shape: torch.Size([256, 3, 224, 224])
batch_size: 256
embeddings.shape: torch.Size([256, 197, 768])
input_ini - x shape before view: torch.Size([32, 8, 196, 768])
input_ini - x shape after first reshape: torch.Size([6272, 8, 768])
input_ini - x shape after cat: torch.Size([6272, 9, 768])
input_ini - x shape before final reshape: torch.Size([6272, 8, 768])
input_ini - x shape after final reshape: torch.Size([32, 196, 8, 768])
input_ini - x shape at end: torch.Size([32, 1568, 768])
x2.shape): torch.Size([32, 1569, 768])
(x1.shape): torch.Size([32, 1569, 768])
(x2.shape): torch.Size([32, 1569, 768])
x2.shape): torch.Size([32, 1569, 768])
(x1.shape): torch.Size([32, 1569, 768])
(x2.shape): torch.Size([32, 1569, 768])
x2.shape): torch.Size([32, 1569, 768])
(x1.shape): torch.Size([32, 1569, 768])
(x2.shape): torch.Size([32, 1569, 768])
cls_token.shape: torch.Size([32, 8, 1, 768])
patch_token.shape: torch.Size([32, 8, 196, 768])
x.shape: torch.Size([256, 197, 768])
x2.shape: torch.Size([256, 197, 768])
temporal.shape: torch.Size([256, 768])
cls_token.shape: torch.Size([256, 768])
### cls_token.shape: torch.Size([32, 768])
features.shape: torch.Size([32, 768])
pred.shape: torch.Size([32, 2])
label.shape: torch.Size([32])
pred.shape: torch.Size([32, 2])

  0%|          | 0/13 [00:00<?, ?it/s][A
  8%|▊         | 1/13 [00:00<00:08,  1.37it/s][A
 15%|█▌        | 2/13 [00:00<00:04,  2.63it/s][A
 23%|██▎       | 3/13 [00:00<00:02,  3.74it/s][A
 31%|███       | 4/13 [00:01<00:01,  4.65it/s][A
 38%|███▊      | 5/13 [00:01<00:01,  5.39it/s][A
 46%|████▌     | 6/13 [00:01<00:01,  5.95it/s][Ax.shape: torch.Size([8, 8, 3, 224, 224])
x.ndim: 5
x.shape: torch.Size([64, 3, 224, 224])
batch_size: 64
embeddings.shape: torch.Size([64, 197, 768])
input_ini - x shape before view: torch.Size([8, 8, 196, 768])
input_ini - x shape after first reshape: torch.Size([1568, 8, 768])
input_ini - x shape after cat: torch.Size([1568, 9, 768])
input_ini - x shape before final reshape: torch.Size([1568, 8, 768])
input_ini - x shape after final reshape: torch.Size([8, 196, 8, 768])
input_ini - x shape at end: torch.Size([8, 1568, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
cls_token.shape: torch.Size([8, 8, 1, 768])
patch_token.shape: torch.Size([8, 8, 196, 768])
x.shape: torch.Size([64, 197, 768])
x2.shape: torch.Size([64, 197, 768])
temporal.shape: torch.Size([64, 768])
cls_token.shape: torch.Size([64, 768])
### cls_token.shape: torch.Size([8, 768])
features.shape: torch.Size([8, 768])
pred.shape: torch.Size([8, 2])
label.shape: torch.Size([8])
pred.shape: torch.Size([8, 2])
x.shape: torch.Size([8, 8, 3, 224, 224])
x.ndim: 5
x.shape: torch.Size([64, 3, 224, 224])
batch_size: 64
embeddings.shape: torch.Size([64, 197, 768])
input_ini - x shape before view: torch.Size([8, 8, 196, 768])
input_ini - x shape after first reshape: torch.Size([1568, 8, 768])
input_ini - x shape after cat: torch.Size([1568, 9, 768])
input_ini - x shape before final reshape: torch.Size([1568, 8, 768])
input_ini - x shape after final reshape: torch.Size([8, 196, 8, 768])
input_ini - x shape at end: torch.Size([8, 1568, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
cls_token.shape: torch.Size([8, 8, 1, 768])
patch_token.shape: torch.Size([8, 8, 196, 768])
x.shape: torch.Size([64, 197, 768])
x2.shape: torch.Size([64, 197, 768])
temporal.shape: torch.Size([64, 768])
cls_token.shape: torch.Size([64, 768])
### cls_token.shape: torch.Size([8, 768])
features.shape: torch.Size([8, 768])
pred.shape: torch.Size([8, 2])
label.shape: torch.Size([8])
pred.shape: torch.Size([8, 2])
x.shape: torch.Size([8, 8, 3, 224, 224])
x.ndim: 5
x.shape: torch.Size([64, 3, 224, 224])
batch_size: 64
embeddings.shape: torch.Size([64, 197, 768])
input_ini - x shape before view: torch.Size([8, 8, 196, 768])
input_ini - x shape after first reshape: torch.Size([1568, 8, 768])
input_ini - x shape after cat: torch.Size([1568, 9, 768])
input_ini - x shape before final reshape: torch.Size([1568, 8, 768])
input_ini - x shape after final reshape: torch.Size([8, 196, 8, 768])
input_ini - x shape at end: torch.Size([8, 1568, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
cls_token.shape: torch.Size([8, 8, 1, 768])
patch_token.shape: torch.Size([8, 8, 196, 768])
x.shape: torch.Size([64, 197, 768])
x2.shape: torch.Size([64, 197, 768])
temporal.shape: torch.Size([64, 768])
cls_token.shape: torch.Size([64, 768])
### cls_token.shape: torch.Size([8, 768])
features.shape: torch.Size([8, 768])
pred.shape: torch.Size([8, 2])
label.shape: torch.Size([8])
pred.shape: torch.Size([8, 2])
x.shape: torch.Size([8, 8, 3, 224, 224])
x.ndim: 5
x.shape: torch.Size([64, 3, 224, 224])
batch_size: 64
embeddings.shape: torch.Size([64, 197, 768])
input_ini - x shape before view: torch.Size([8, 8, 196, 768])
input_ini - x shape after first reshape: torch.Size([1568, 8, 768])
input_ini - x shape after cat: torch.Size([1568, 9, 768])
input_ini - x shape before final reshape: torch.Size([1568, 8, 768])
input_ini - x shape after final reshape: torch.Size([8, 196, 8, 768])
input_ini - x shape at end: torch.Size([8, 1568, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
cls_token.shape: torch.Size([8, 8, 1, 768])
patch_token.shape: torch.Size([8, 8, 196, 768])
x.shape: torch.Size([64, 197, 768])
x2.shape: torch.Size([64, 197, 768])
temporal.shape: torch.Size([64, 768])
cls_token.shape: torch.Size([64, 768])
### cls_token.shape: torch.Size([8, 768])
features.shape: torch.Size([8, 768])
pred.shape: torch.Size([8, 2])
label.shape: torch.Size([8])
pred.shape: torch.Size([8, 2])
x.shape: torch.Size([8, 8, 3, 224, 224])
x.ndim: 5
x.shape: torch.Size([64, 3, 224, 224])
batch_size: 64
embeddings.shape: torch.Size([64, 197, 768])
input_ini - x shape before view: torch.Size([8, 8, 196, 768])
input_ini - x shape after first reshape: torch.Size([1568, 8, 768])
input_ini - x shape after cat: torch.Size([1568, 9, 768])
input_ini - x shape before final reshape: torch.Size([1568, 8, 768])
input_ini - x shape after final reshape: torch.Size([8, 196, 8, 768])
input_ini - x shape at end: torch.Size([8, 1568, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
cls_token.shape: torch.Size([8, 8, 1, 768])
patch_token.shape: torch.Size([8, 8, 196, 768])
x.shape: torch.Size([64, 197, 768])
x2.shape: torch.Size([64, 197, 768])
temporal.shape: torch.Size([64, 768])
cls_token.shape: torch.Size([64, 768])
### cls_token.shape: torch.Size([8, 768])
features.shape: torch.Size([8, 768])
pred.shape: torch.Size([8, 2])
label.shape: torch.Size([8])
pred.shape: torch.Size([8, 2])
x.shape: torch.Size([8, 8, 3, 224, 224])
x.ndim: 5
x.shape: torch.Size([64, 3, 224, 224])
batch_size: 64
embeddings.shape: torch.Size([64, 197, 768])
input_ini - x shape before view: torch.Size([8, 8, 196, 768])
input_ini - x shape after first reshape: torch.Size([1568, 8, 768])
input_ini - x shape after cat: torch.Size([1568, 9, 768])
input_ini - x shape before final reshape: torch.Size([1568, 8, 768])
input_ini - x shape after final reshape: torch.Size([8, 196, 8, 768])
input_ini - x shape at end: torch.Size([8, 1568, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
cls_token.shape: torch.Size([8, 8, 1, 768])
patch_token.shape: torch.Size([8, 8, 196, 768])
x.shape: torch.Size([64, 197, 768])
x2.shape: torch.Size([64, 197, 768])
temporal.shape: torch.Size([64, 768])
cls_token.shape: torch.Size([64, 768])
### cls_token.shape: torch.Size([8, 768])
features.shape: torch.Size([8, 768])
pred.shape: torch.Size([8, 2])
label.shape: torch.Size([8])
pred.shape: torch.Size([8, 2])
x.shape: torch.Size([8, 8, 3, 224, 224])
x.ndim: 5
x.shape: torch.Size([64, 3, 224, 224])
batch_size: 64
embeddings.shape: torch.Size([64, 197, 768])
input_ini - x shape before view: torch.Size([8, 8, 196, 768])
input_ini - x shape after first reshape: torch.Size([1568, 8, 768])
input_ini - x shape after cat: torch.Size([1568, 9, 768])
input_ini - x shape before final reshape: torch.Size([1568, 8, 768])

 54%|█████▍    | 7/13 [00:01<00:00,  6.38it/s][A
 62%|██████▏   | 8/13 [00:01<00:00,  6.69it/s][A
 69%|██████▉   | 9/13 [00:01<00:00,  6.92it/s][A
 77%|███████▋  | 10/13 [00:01<00:00,  7.08it/s][A
 85%|████████▍ | 11/13 [00:02<00:00,  7.20it/s][A
 92%|█████████▏| 12/13 [00:02<00:00,  7.28it/s][Ainput_ini - x shape after final reshape: torch.Size([8, 196, 8, 768])
input_ini - x shape at end: torch.Size([8, 1568, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
cls_token.shape: torch.Size([8, 8, 1, 768])
patch_token.shape: torch.Size([8, 8, 196, 768])
x.shape: torch.Size([64, 197, 768])
x2.shape: torch.Size([64, 197, 768])
temporal.shape: torch.Size([64, 768])
cls_token.shape: torch.Size([64, 768])
### cls_token.shape: torch.Size([8, 768])
features.shape: torch.Size([8, 768])
pred.shape: torch.Size([8, 2])
label.shape: torch.Size([8])
pred.shape: torch.Size([8, 2])
x.shape: torch.Size([8, 8, 3, 224, 224])
x.ndim: 5
x.shape: torch.Size([64, 3, 224, 224])
batch_size: 64
embeddings.shape: torch.Size([64, 197, 768])
input_ini - x shape before view: torch.Size([8, 8, 196, 768])
input_ini - x shape after first reshape: torch.Size([1568, 8, 768])
input_ini - x shape after cat: torch.Size([1568, 9, 768])
input_ini - x shape before final reshape: torch.Size([1568, 8, 768])
input_ini - x shape after final reshape: torch.Size([8, 196, 8, 768])
input_ini - x shape at end: torch.Size([8, 1568, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
cls_token.shape: torch.Size([8, 8, 1, 768])
patch_token.shape: torch.Size([8, 8, 196, 768])
x.shape: torch.Size([64, 197, 768])
x2.shape: torch.Size([64, 197, 768])
temporal.shape: torch.Size([64, 768])
cls_token.shape: torch.Size([64, 768])
### cls_token.shape: torch.Size([8, 768])
features.shape: torch.Size([8, 768])
pred.shape: torch.Size([8, 2])
label.shape: torch.Size([8])
pred.shape: torch.Size([8, 2])
x.shape: torch.Size([8, 8, 3, 224, 224])
x.ndim: 5
x.shape: torch.Size([64, 3, 224, 224])
batch_size: 64
embeddings.shape: torch.Size([64, 197, 768])
input_ini - x shape before view: torch.Size([8, 8, 196, 768])
input_ini - x shape after first reshape: torch.Size([1568, 8, 768])
input_ini - x shape after cat: torch.Size([1568, 9, 768])
input_ini - x shape before final reshape: torch.Size([1568, 8, 768])
input_ini - x shape after final reshape: torch.Size([8, 196, 8, 768])
input_ini - x shape at end: torch.Size([8, 1568, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
cls_token.shape: torch.Size([8, 8, 1, 768])
patch_token.shape: torch.Size([8, 8, 196, 768])
x.shape: torch.Size([64, 197, 768])
x2.shape: torch.Size([64, 197, 768])
temporal.shape: torch.Size([64, 768])
cls_token.shape: torch.Size([64, 768])
### cls_token.shape: torch.Size([8, 768])
features.shape: torch.Size([8, 768])
pred.shape: torch.Size([8, 2])
label.shape: torch.Size([8])
pred.shape: torch.Size([8, 2])
x.shape: torch.Size([8, 8, 3, 224, 224])
x.ndim: 5
x.shape: torch.Size([64, 3, 224, 224])
batch_size: 64
embeddings.shape: torch.Size([64, 197, 768])
input_ini - x shape before view: torch.Size([8, 8, 196, 768])
input_ini - x shape after first reshape: torch.Size([1568, 8, 768])
input_ini - x shape after cat: torch.Size([1568, 9, 768])
input_ini - x shape before final reshape: torch.Size([1568, 8, 768])
input_ini - x shape after final reshape: torch.Size([8, 196, 8, 768])
input_ini - x shape at end: torch.Size([8, 1568, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
cls_token.shape: torch.Size([8, 8, 1, 768])
patch_token.shape: torch.Size([8, 8, 196, 768])
x.shape: torch.Size([64, 197, 768])
x2.shape: torch.Size([64, 197, 768])
temporal.shape: torch.Size([64, 768])
cls_token.shape: torch.Size([64, 768])
### cls_token.shape: torch.Size([8, 768])
features.shape: torch.Size([8, 768])
pred.shape: torch.Size([8, 2])
label.shape: torch.Size([8])
pred.shape: torch.Size([8, 2])
x.shape: torch.Size([8, 8, 3, 224, 224])
x.ndim: 5
x.shape: torch.Size([64, 3, 224, 224])
batch_size: 64
embeddings.shape: torch.Size([64, 197, 768])
input_ini - x shape before view: torch.Size([8, 8, 196, 768])
input_ini - x shape after first reshape: torch.Size([1568, 8, 768])
input_ini - x shape after cat: torch.Size([1568, 9, 768])
input_ini - x shape before final reshape: torch.Size([1568, 8, 768])
input_ini - x shape after final reshape: torch.Size([8, 196, 8, 768])
input_ini - x shape at end: torch.Size([8, 1568, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
cls_token.shape: torch.Size([8, 8, 1, 768])
patch_token.shape: torch.Size([8, 8, 196, 768])
x.shape: torch.Size([64, 197, 768])
x2.shape: torch.Size([64, 197, 768])
temporal.shape: torch.Size([64, 768])
cls_token.shape: torch.Size([64, 768])
### cls_token.shape: torch.Size([8, 768])
features.shape: torch.Size([8, 768])
pred.shape: torch.Size([8, 2])
label.shape: torch.Size([8])
pred.shape: torch.Size([8, 2])
x.shape: torch.Size([8, 8, 3, 224, 224])
x.ndim: 5
x.shape: torch.Size([64, 3, 224, 224])
batch_size: 64
embeddings.shape: torch.Size([64, 197, 768])
input_ini - x shape before view: torch.Size([8, 8, 196, 768])
input_ini - x shape after first reshape: torch.Size([1568, 8, 768])
input_ini - x shape after cat: torch.Size([1568, 9, 768])
input_ini - x shape before final reshape: torch.Size([1568, 8, 768])
input_ini - x shape after final reshape: torch.Size([8, 196, 8, 768])
input_ini - x shape at end: torch.Size([8, 1568, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
cls_token.shape: torch.Size([8, 8, 1, 768])
patch_token.shape: torch.Size([8, 8, 196, 768])
x.shape: torch.Size([64, 197, 768])
x2.shape: torch.Size([64, 197, 768])
temporal.shape: torch.Size([64, 768])
cls_token.shape: torch.Size([64, 768])
### cls_token.shape: torch.Size([8, 768])
features.shape: torch.Size([8, 768])
pred.shape: torch.Size([8, 2])
label.shape: torch.Size([8])
pred.shape: torch.Size([8, 2])
x.shape: torch.Size([4, 8, 3, 224, 224])
x.ndim: 5
x.shape: torch.Size([32, 3, 224, 224])
batch_size: 32
embeddings.shape: torch.Size([32, 197, 768])
input_ini - x shape before view: torch.Size([4, 8, 196, 768])
input_ini - x shape after first reshape: torch.Size([784, 8, 768])
input_ini - x shape after cat: torch.Size([784, 9, 768])
input_ini - x shape before final reshape: torch.Size([784, 8, 768])
input_ini - x shape after final reshape: torch.Size([4, 196, 8, 768])
input_ini - x shape at end: torch.Size([4, 1568, 768])
x2.shape): torch.Size([4, 1569, 768])
(x1.shape): torch.Size([4, 1569, 768])
(x2.shape): torch.Size([4, 1569, 768])
x2.shape): torch.Size([4, 1569, 768])
(x1.shape): torch.Size([4, 1569, 768])
(x2.shape): torch.Size([4, 1569, 768])
x2.shape): torch.Size([4, 1569, 768])
(x1.shape): torch.Size([4, 1569, 768])
100%|██████████| 13/13 [00:02<00:00,  5.71it/s]
2025-05-30 10:57:01,089 - INFO - dataset: DFDC    step: 25    testing-loss, overall: 0.68017578125    
2025-05-30 10:57:01,090 - INFO - dataset: DFDC    step: 25    testing-metric, acc: 0.65    testing-metric, auc: 0.5030769230769231    testing-metric, eer: 0.4857142857142857    testing-metric, ap: 0.7026960686590478    testing-metric, video_auc: 0.5030769230769231    testing-metric, acc_real:0.7714285714285715; acc_fake:0.5846153846153846
2025-05-30 10:57:01,090 - INFO - dataset: avg    step: 25    testing-metric, acc: 0.65    testing-metric, auc: 0.5030769230769231    testing-metric, eer: 0.4857142857142857    testing-metric, ap: 0.7026960686590478    testing-metric, video_auc: 0.5030769230769231    
2025-05-30 10:57:01,090 - INFO - ===> Test Done!
 50%|█████     | 2/4 [00:05<00:05,  2.72s/it] 75%|███████▌  | 3/4 [00:05<00:01,  1.71s/it]2025-05-30 10:57:01,685 - INFO - ===> Test start!
2025-05-30 10:57:01,688 - INFO - data_dict saved to ./logs/training/clip_stan_2025-05-30-10-56-05/test/DFDC/data_dict_test.pickle
(x2.shape): torch.Size([4, 1569, 768])
cls_token.shape: torch.Size([4, 8, 1, 768])
patch_token.shape: torch.Size([4, 8, 196, 768])
x.shape: torch.Size([32, 197, 768])
x2.shape: torch.Size([32, 197, 768])
temporal.shape: torch.Size([32, 768])
cls_token.shape: torch.Size([32, 768])
### cls_token.shape: torch.Size([4, 768])
features.shape: torch.Size([4, 768])
pred.shape: torch.Size([4, 2])
label.shape: torch.Size([4])
pred.shape: torch.Size([4, 2])
len(y_pred): 100
len(y_true): 100
x.shape: torch.Size([32, 8, 3, 224, 224])
x.ndim: 5
x.shape: torch.Size([256, 3, 224, 224])
batch_size: 256
embeddings.shape: torch.Size([256, 197, 768])
input_ini - x shape before view: torch.Size([32, 8, 196, 768])
input_ini - x shape after first reshape: torch.Size([6272, 8, 768])
input_ini - x shape after cat: torch.Size([6272, 9, 768])
input_ini - x shape before final reshape: torch.Size([6272, 8, 768])
input_ini - x shape after final reshape: torch.Size([32, 196, 8, 768])
input_ini - x shape at end: torch.Size([32, 1568, 768])
x2.shape): torch.Size([32, 1569, 768])
(x1.shape): torch.Size([32, 1569, 768])
(x2.shape): torch.Size([32, 1569, 768])
x2.shape): torch.Size([32, 1569, 768])
(x1.shape): torch.Size([32, 1569, 768])
(x2.shape): torch.Size([32, 1569, 768])
x2.shape): torch.Size([32, 1569, 768])
(x1.shape): torch.Size([32, 1569, 768])
(x2.shape): torch.Size([32, 1569, 768])
cls_token.shape: torch.Size([32, 8, 1, 768])
patch_token.shape: torch.Size([32, 8, 196, 768])
x.shape: torch.Size([256, 197, 768])
x2.shape: torch.Size([256, 197, 768])
temporal.shape: torch.Size([256, 768])
cls_token.shape: torch.Size([256, 768])
### cls_token.shape: torch.Size([32, 768])
features.shape: torch.Size([32, 768])
pred.shape: torch.Size([32, 2])
label.shape: torch.Size([32])
pred.shape: torch.Size([32, 2])
x.shape: torch.Size([4, 8, 3, 224, 224])
x.ndim: 5
x.shape: torch.Size([32, 3, 224, 224])
batch_size: 32
embeddings.shape: torch.Size([32, 197, 768])
input_ini - x shape before view: torch.Size([4, 8, 196, 768])
input_ini - x shape after first reshape: torch.Size([784, 8, 768])
input_ini - x shape after cat: torch.Size([784, 9, 768])
input_ini - x shape before final reshape: torch.Size([784, 8, 768])
input_ini - x shape after final reshape: torch.Size([4, 196, 8, 768])
input_ini - x shape at end: torch.Size([4, 1568, 768])
x2.shape): torch.Size([4, 1569, 768])
(x1.shape): torch.Size([4, 1569, 768])
(x2.shape): torch.Size([4, 1569, 768])
x2.shape): torch.Size([4, 1569, 768])
(x1.shape): torch.Size([4, 1569, 768])
(x2.shape): torch.Size([4, 1569, 768])
x2.shape): torch.Size([4, 1569, 768])
(x1.shape): torch.Size([4, 1569, 768])
(x2.shape): torch.Size([4, 1569, 768])
cls_token.shape: torch.Size([4, 8, 1, 768])
patch_token.shape: torch.Size([4, 8, 196, 768])
x.shape: torch.Size([32, 197, 768])
x2.shape: torch.Size([32, 197, 768])
temporal.shape: torch.Size([32, 768])
cls_token.shape: torch.Size([32, 768])
### cls_token.shape: torch.Size([4, 768])
features.shape: torch.Size([4, 768])
pred.shape: torch.Size([4, 2])
label.shape: torch.Size([4])
pred.shape: torch.Size([4, 2])

  0%|          | 0/13 [00:00<?, ?it/s][A
  8%|▊         | 1/13 [00:00<00:06,  1.81it/s][A
 15%|█▌        | 2/13 [00:00<00:03,  3.26it/s][A
 23%|██▎       | 3/13 [00:00<00:02,  4.40it/s][A
 31%|███       | 4/13 [00:00<00:01,  5.25it/s][A
 38%|███▊      | 5/13 [00:01<00:01,  5.88it/s][A
 46%|████▌     | 6/13 [00:01<00:01,  6.33it/s][Ax.shape: torch.Size([8, 8, 3, 224, 224])
x.ndim: 5
x.shape: torch.Size([64, 3, 224, 224])
batch_size: 64
embeddings.shape: torch.Size([64, 197, 768])
input_ini - x shape before view: torch.Size([8, 8, 196, 768])
input_ini - x shape after first reshape: torch.Size([1568, 8, 768])
input_ini - x shape after cat: torch.Size([1568, 9, 768])
input_ini - x shape before final reshape: torch.Size([1568, 8, 768])
input_ini - x shape after final reshape: torch.Size([8, 196, 8, 768])
input_ini - x shape at end: torch.Size([8, 1568, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
cls_token.shape: torch.Size([8, 8, 1, 768])
patch_token.shape: torch.Size([8, 8, 196, 768])
x.shape: torch.Size([64, 197, 768])
x2.shape: torch.Size([64, 197, 768])
temporal.shape: torch.Size([64, 768])
cls_token.shape: torch.Size([64, 768])
### cls_token.shape: torch.Size([8, 768])
features.shape: torch.Size([8, 768])
pred.shape: torch.Size([8, 2])
label.shape: torch.Size([8])
pred.shape: torch.Size([8, 2])
x.shape: torch.Size([8, 8, 3, 224, 224])
x.ndim: 5
x.shape: torch.Size([64, 3, 224, 224])
batch_size: 64
embeddings.shape: torch.Size([64, 197, 768])
input_ini - x shape before view: torch.Size([8, 8, 196, 768])
input_ini - x shape after first reshape: torch.Size([1568, 8, 768])
input_ini - x shape after cat: torch.Size([1568, 9, 768])
input_ini - x shape before final reshape: torch.Size([1568, 8, 768])
input_ini - x shape after final reshape: torch.Size([8, 196, 8, 768])
input_ini - x shape at end: torch.Size([8, 1568, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
cls_token.shape: torch.Size([8, 8, 1, 768])
patch_token.shape: torch.Size([8, 8, 196, 768])
x.shape: torch.Size([64, 197, 768])
x2.shape: torch.Size([64, 197, 768])
temporal.shape: torch.Size([64, 768])
cls_token.shape: torch.Size([64, 768])
### cls_token.shape: torch.Size([8, 768])
features.shape: torch.Size([8, 768])
pred.shape: torch.Size([8, 2])
label.shape: torch.Size([8])
pred.shape: torch.Size([8, 2])
x.shape: torch.Size([8, 8, 3, 224, 224])
x.ndim: 5
x.shape: torch.Size([64, 3, 224, 224])
batch_size: 64
embeddings.shape: torch.Size([64, 197, 768])
input_ini - x shape before view: torch.Size([8, 8, 196, 768])
input_ini - x shape after first reshape: torch.Size([1568, 8, 768])
input_ini - x shape after cat: torch.Size([1568, 9, 768])
input_ini - x shape before final reshape: torch.Size([1568, 8, 768])
input_ini - x shape after final reshape: torch.Size([8, 196, 8, 768])
input_ini - x shape at end: torch.Size([8, 1568, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
cls_token.shape: torch.Size([8, 8, 1, 768])
patch_token.shape: torch.Size([8, 8, 196, 768])
x.shape: torch.Size([64, 197, 768])
x2.shape: torch.Size([64, 197, 768])
temporal.shape: torch.Size([64, 768])
cls_token.shape: torch.Size([64, 768])
### cls_token.shape: torch.Size([8, 768])
features.shape: torch.Size([8, 768])
pred.shape: torch.Size([8, 2])
label.shape: torch.Size([8])
pred.shape: torch.Size([8, 2])
x.shape: torch.Size([8, 8, 3, 224, 224])
x.ndim: 5
x.shape: torch.Size([64, 3, 224, 224])
batch_size: 64
embeddings.shape: torch.Size([64, 197, 768])
input_ini - x shape before view: torch.Size([8, 8, 196, 768])
input_ini - x shape after first reshape: torch.Size([1568, 8, 768])
input_ini - x shape after cat: torch.Size([1568, 9, 768])
input_ini - x shape before final reshape: torch.Size([1568, 8, 768])
input_ini - x shape after final reshape: torch.Size([8, 196, 8, 768])
input_ini - x shape at end: torch.Size([8, 1568, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
cls_token.shape: torch.Size([8, 8, 1, 768])
patch_token.shape: torch.Size([8, 8, 196, 768])
x.shape: torch.Size([64, 197, 768])
x2.shape: torch.Size([64, 197, 768])
temporal.shape: torch.Size([64, 768])
cls_token.shape: torch.Size([64, 768])
### cls_token.shape: torch.Size([8, 768])
features.shape: torch.Size([8, 768])
pred.shape: torch.Size([8, 2])
label.shape: torch.Size([8])
pred.shape: torch.Size([8, 2])
x.shape: torch.Size([8, 8, 3, 224, 224])
x.ndim: 5
x.shape: torch.Size([64, 3, 224, 224])
batch_size: 64
embeddings.shape: torch.Size([64, 197, 768])
input_ini - x shape before view: torch.Size([8, 8, 196, 768])
input_ini - x shape after first reshape: torch.Size([1568, 8, 768])
input_ini - x shape after cat: torch.Size([1568, 9, 768])
input_ini - x shape before final reshape: torch.Size([1568, 8, 768])
input_ini - x shape after final reshape: torch.Size([8, 196, 8, 768])
input_ini - x shape at end: torch.Size([8, 1568, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
cls_token.shape: torch.Size([8, 8, 1, 768])
patch_token.shape: torch.Size([8, 8, 196, 768])
x.shape: torch.Size([64, 197, 768])
x2.shape: torch.Size([64, 197, 768])
temporal.shape: torch.Size([64, 768])
cls_token.shape: torch.Size([64, 768])
### cls_token.shape: torch.Size([8, 768])
features.shape: torch.Size([8, 768])
pred.shape: torch.Size([8, 2])
label.shape: torch.Size([8])
pred.shape: torch.Size([8, 2])
x.shape: torch.Size([8, 8, 3, 224, 224])
x.ndim: 5
x.shape: torch.Size([64, 3, 224, 224])
batch_size: 64
embeddings.shape: torch.Size([64, 197, 768])
input_ini - x shape before view: torch.Size([8, 8, 196, 768])
input_ini - x shape after first reshape: torch.Size([1568, 8, 768])
input_ini - x shape after cat: torch.Size([1568, 9, 768])
input_ini - x shape before final reshape: torch.Size([1568, 8, 768])
input_ini - x shape after final reshape: torch.Size([8, 196, 8, 768])
input_ini - x shape at end: torch.Size([8, 1568, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
cls_token.shape: torch.Size([8, 8, 1, 768])
patch_token.shape: torch.Size([8, 8, 196, 768])
x.shape: torch.Size([64, 197, 768])
x2.shape: torch.Size([64, 197, 768])
temporal.shape: torch.Size([64, 768])
cls_token.shape: torch.Size([64, 768])
### cls_token.shape: torch.Size([8, 768])
features.shape: torch.Size([8, 768])
pred.shape: torch.Size([8, 2])
label.shape: torch.Size([8])
pred.shape: torch.Size([8, 2])
x.shape: torch.Size([8, 8, 3, 224, 224])
x.ndim: 5
x.shape: torch.Size([64, 3, 224, 224])
batch_size: 64
embeddings.shape: torch.Size([64, 197, 768])
input_ini - x shape before view: torch.Size([8, 8, 196, 768])
input_ini - x shape after first reshape: torch.Size([1568, 8, 768])
input_ini - x shape after cat: torch.Size([1568, 9, 768])
input_ini - x shape before final reshape: torch.Size([1568, 8, 768])

 54%|█████▍    | 7/13 [00:01<00:00,  6.66it/s][A
 62%|██████▏   | 8/13 [00:01<00:00,  6.90it/s][A
 69%|██████▉   | 9/13 [00:01<00:00,  7.06it/s][A
 77%|███████▋  | 10/13 [00:01<00:00,  7.18it/s][A
 85%|████████▍ | 11/13 [00:01<00:00,  7.27it/s][A
 92%|█████████▏| 12/13 [00:02<00:00,  7.32it/s][Ainput_ini - x shape after final reshape: torch.Size([8, 196, 8, 768])
input_ini - x shape at end: torch.Size([8, 1568, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
cls_token.shape: torch.Size([8, 8, 1, 768])
patch_token.shape: torch.Size([8, 8, 196, 768])
x.shape: torch.Size([64, 197, 768])
x2.shape: torch.Size([64, 197, 768])
temporal.shape: torch.Size([64, 768])
cls_token.shape: torch.Size([64, 768])
### cls_token.shape: torch.Size([8, 768])
features.shape: torch.Size([8, 768])
pred.shape: torch.Size([8, 2])
label.shape: torch.Size([8])
pred.shape: torch.Size([8, 2])
x.shape: torch.Size([8, 8, 3, 224, 224])
x.ndim: 5
x.shape: torch.Size([64, 3, 224, 224])
batch_size: 64
embeddings.shape: torch.Size([64, 197, 768])
input_ini - x shape before view: torch.Size([8, 8, 196, 768])
input_ini - x shape after first reshape: torch.Size([1568, 8, 768])
input_ini - x shape after cat: torch.Size([1568, 9, 768])
input_ini - x shape before final reshape: torch.Size([1568, 8, 768])
input_ini - x shape after final reshape: torch.Size([8, 196, 8, 768])
input_ini - x shape at end: torch.Size([8, 1568, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
cls_token.shape: torch.Size([8, 8, 1, 768])
patch_token.shape: torch.Size([8, 8, 196, 768])
x.shape: torch.Size([64, 197, 768])
x2.shape: torch.Size([64, 197, 768])
temporal.shape: torch.Size([64, 768])
cls_token.shape: torch.Size([64, 768])
### cls_token.shape: torch.Size([8, 768])
features.shape: torch.Size([8, 768])
pred.shape: torch.Size([8, 2])
label.shape: torch.Size([8])
pred.shape: torch.Size([8, 2])
x.shape: torch.Size([8, 8, 3, 224, 224])
x.ndim: 5
x.shape: torch.Size([64, 3, 224, 224])
batch_size: 64
embeddings.shape: torch.Size([64, 197, 768])
input_ini - x shape before view: torch.Size([8, 8, 196, 768])
input_ini - x shape after first reshape: torch.Size([1568, 8, 768])
input_ini - x shape after cat: torch.Size([1568, 9, 768])
input_ini - x shape before final reshape: torch.Size([1568, 8, 768])
input_ini - x shape after final reshape: torch.Size([8, 196, 8, 768])
input_ini - x shape at end: torch.Size([8, 1568, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
cls_token.shape: torch.Size([8, 8, 1, 768])
patch_token.shape: torch.Size([8, 8, 196, 768])
x.shape: torch.Size([64, 197, 768])
x2.shape: torch.Size([64, 197, 768])
temporal.shape: torch.Size([64, 768])
cls_token.shape: torch.Size([64, 768])
### cls_token.shape: torch.Size([8, 768])
features.shape: torch.Size([8, 768])
pred.shape: torch.Size([8, 2])
label.shape: torch.Size([8])
pred.shape: torch.Size([8, 2])
x.shape: torch.Size([8, 8, 3, 224, 224])
x.ndim: 5
x.shape: torch.Size([64, 3, 224, 224])
batch_size: 64
embeddings.shape: torch.Size([64, 197, 768])
input_ini - x shape before view: torch.Size([8, 8, 196, 768])
input_ini - x shape after first reshape: torch.Size([1568, 8, 768])
input_ini - x shape after cat: torch.Size([1568, 9, 768])
input_ini - x shape before final reshape: torch.Size([1568, 8, 768])
input_ini - x shape after final reshape: torch.Size([8, 196, 8, 768])
input_ini - x shape at end: torch.Size([8, 1568, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
cls_token.shape: torch.Size([8, 8, 1, 768])
patch_token.shape: torch.Size([8, 8, 196, 768])
x.shape: torch.Size([64, 197, 768])
x2.shape: torch.Size([64, 197, 768])
temporal.shape: torch.Size([64, 768])
cls_token.shape: torch.Size([64, 768])
### cls_token.shape: torch.Size([8, 768])
features.shape: torch.Size([8, 768])
pred.shape: torch.Size([8, 2])
label.shape: torch.Size([8])
pred.shape: torch.Size([8, 2])
x.shape: torch.Size([8, 8, 3, 224, 224])
x.ndim: 5
x.shape: torch.Size([64, 3, 224, 224])
batch_size: 64
embeddings.shape: torch.Size([64, 197, 768])
input_ini - x shape before view: torch.Size([8, 8, 196, 768])
input_ini - x shape after first reshape: torch.Size([1568, 8, 768])
input_ini - x shape after cat: torch.Size([1568, 9, 768])
input_ini - x shape before final reshape: torch.Size([1568, 8, 768])
input_ini - x shape after final reshape: torch.Size([8, 196, 8, 768])
input_ini - x shape at end: torch.Size([8, 1568, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
cls_token.shape: torch.Size([8, 8, 1, 768])
patch_token.shape: torch.Size([8, 8, 196, 768])
x.shape: torch.Size([64, 197, 768])
x2.shape: torch.Size([64, 197, 768])
temporal.shape: torch.Size([64, 768])
cls_token.shape: torch.Size([64, 768])
### cls_token.shape: torch.Size([8, 768])
features.shape: torch.Size([8, 768])
pred.shape: torch.Size([8, 2])
label.shape: torch.Size([8])
pred.shape: torch.Size([8, 2])
x.shape: torch.Size([8, 8, 3, 224, 224])
x.ndim: 5
x.shape: torch.Size([64, 3, 224, 224])
batch_size: 64
embeddings.shape: torch.Size([64, 197, 768])
input_ini - x shape before view: torch.Size([8, 8, 196, 768])
input_ini - x shape after first reshape: torch.Size([1568, 8, 768])
input_ini - x shape after cat: torch.Size([1568, 9, 768])
input_ini - x shape before final reshape: torch.Size([1568, 8, 768])
input_ini - x shape after final reshape: torch.Size([8, 196, 8, 768])
input_ini - x shape at end: torch.Size([8, 1568, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
cls_token.shape: torch.Size([8, 8, 1, 768])
patch_token.shape: torch.Size([8, 8, 196, 768])
x.shape: torch.Size([64, 197, 768])
x2.shape: torch.Size([64, 197, 768])
temporal.shape: torch.Size([64, 768])
cls_token.shape: torch.Size([64, 768])
### cls_token.shape: torch.Size([8, 768])
features.shape: torch.Size([8, 768])
pred.shape: torch.Size([8, 2])
label.shape: torch.Size([8])
pred.shape: torch.Size([8, 2])
x.shape: torch.Size([4, 8, 3, 224, 224])
x.ndim: 5
x.shape: torch.Size([32, 3, 224, 224])
batch_size: 32
embeddings.shape: torch.Size([32, 197, 768])
input_ini - x shape before view: torch.Size([4, 8, 196, 768])
input_ini - x shape after first reshape: torch.Size([784, 8, 768])
input_ini - x shape after cat: torch.Size([784, 9, 768])
input_ini - x shape before final reshape: torch.Size([784, 8, 768])
input_ini - x shape after final reshape: torch.Size([4, 196, 8, 768])
input_ini - x shape at end: torch.Size([4, 1568, 768])
x2.shape): torch.Size([4, 1569, 768])
(x1.shape): torch.Size([4, 1569, 768])
(x2.shape): torch.Size([4, 1569, 768])
x2.shape): torch.Size([4, 1569, 768])
(x1.shape): torch.Size([4, 1569, 768])
(x2.shape): torch.Size([4, 1569, 768])
x2.shape): torch.Size([4, 1569, 768])
(x1.shape): torch.Size([4, 1569, 768])
100%|██████████| 13/13 [00:02<00:00,  6.20it/s]
2025-05-30 10:57:03,797 - INFO - dataset: DFDC    step: 27    testing-loss, overall: 0.67919921875    
2025-05-30 10:57:03,797 - INFO - dataset: DFDC    step: 27    testing-metric, acc: 0.65    testing-metric, auc: 0.5035164835164836    testing-metric, eer: 0.5142857142857142    testing-metric, ap: 0.7033081065572984    testing-metric, video_auc: 0.5035164835164836    testing-metric, acc_real:0.7714285714285715; acc_fake:0.5846153846153846
2025-05-30 10:57:03,798 - INFO - dataset: avg    step: 27    testing-metric, acc: 0.65    testing-metric, auc: 0.5035164835164836    testing-metric, eer: 0.5142857142857142    testing-metric, ap: 0.7033081065572984    testing-metric, video_auc: 0.5035164835164836    
2025-05-30 10:57:03,798 - INFO - ===> Test Done!
100%|██████████| 4/4 [00:08<00:00,  1.90s/it]100%|██████████| 4/4 [00:08<00:00,  2.02s/it]
2025-05-30 10:57:03,805 - INFO - ===> Epoch[6] end with testing auc: 
================================ Each dataset best metric ================================ 
| DFDC:  auc=0.5090109890109891 | 
============================================================================================= 
================================== Average best metric ====================================== 
| avg auc: 0.5090109890109891 | 
| DFDC: 0.5090109890109891 | 
=============================================================================================!
2025-05-30 10:57:03,805 - INFO - ===> Epoch[7] start!
2025-05-30 10:57:03,806 - INFO - data_dict saved to ./logs/training/clip_stan_2025-05-30-10-56-05/train/FaceForensics++/data_dict_train.pickle
(x2.shape): torch.Size([4, 1569, 768])
cls_token.shape: torch.Size([4, 8, 1, 768])
patch_token.shape: torch.Size([4, 8, 196, 768])
x.shape: torch.Size([32, 197, 768])
x2.shape: torch.Size([32, 197, 768])
temporal.shape: torch.Size([32, 768])
cls_token.shape: torch.Size([32, 768])
### cls_token.shape: torch.Size([4, 768])
features.shape: torch.Size([4, 768])
pred.shape: torch.Size([4, 2])
label.shape: torch.Size([4])
pred.shape: torch.Size([4, 2])
len(y_pred): 100
len(y_true): 100
  0%|          | 0/4 [00:00<?, ?it/s]2025-05-30 10:57:06,386 - INFO - Iter: 28    training-loss, overall: 0.670623779296875    
2025-05-30 10:57:06,387 - INFO - Iter: 28    training-metric, acc: 0.75    training-metric, auc: 0.6901041666666666    training-metric, eer: 0.375    training-metric, ap: 0.8773194465462364    
 25%|██▌       | 1/4 [00:02<00:07,  2.57s/it]2025-05-30 10:57:06,903 - INFO - ===> Test start!
2025-05-30 10:57:06,906 - INFO - data_dict saved to ./logs/training/clip_stan_2025-05-30-10-56-05/test/DFDC/data_dict_test.pickle
x.shape: torch.Size([32, 8, 3, 224, 224])
x.ndim: 5
x.shape: torch.Size([256, 3, 224, 224])
batch_size: 256
embeddings.shape: torch.Size([256, 197, 768])
input_ini - x shape before view: torch.Size([32, 8, 196, 768])
input_ini - x shape after first reshape: torch.Size([6272, 8, 768])
input_ini - x shape after cat: torch.Size([6272, 9, 768])
input_ini - x shape before final reshape: torch.Size([6272, 8, 768])
input_ini - x shape after final reshape: torch.Size([32, 196, 8, 768])
input_ini - x shape at end: torch.Size([32, 1568, 768])
x2.shape): torch.Size([32, 1569, 768])
(x1.shape): torch.Size([32, 1569, 768])
(x2.shape): torch.Size([32, 1569, 768])
x2.shape): torch.Size([32, 1569, 768])
(x1.shape): torch.Size([32, 1569, 768])
(x2.shape): torch.Size([32, 1569, 768])
x2.shape): torch.Size([32, 1569, 768])
(x1.shape): torch.Size([32, 1569, 768])
(x2.shape): torch.Size([32, 1569, 768])
cls_token.shape: torch.Size([32, 8, 1, 768])
patch_token.shape: torch.Size([32, 8, 196, 768])
x.shape: torch.Size([256, 197, 768])
x2.shape: torch.Size([256, 197, 768])
temporal.shape: torch.Size([256, 768])
cls_token.shape: torch.Size([256, 768])
### cls_token.shape: torch.Size([32, 768])
features.shape: torch.Size([32, 768])
pred.shape: torch.Size([32, 2])
label.shape: torch.Size([32])
pred.shape: torch.Size([32, 2])
x.shape: torch.Size([32, 8, 3, 224, 224])
x.ndim: 5
x.shape: torch.Size([256, 3, 224, 224])
batch_size: 256
embeddings.shape: torch.Size([256, 197, 768])
input_ini - x shape before view: torch.Size([32, 8, 196, 768])
input_ini - x shape after first reshape: torch.Size([6272, 8, 768])
input_ini - x shape after cat: torch.Size([6272, 9, 768])
input_ini - x shape before final reshape: torch.Size([6272, 8, 768])
input_ini - x shape after final reshape: torch.Size([32, 196, 8, 768])
input_ini - x shape at end: torch.Size([32, 1568, 768])
x2.shape): torch.Size([32, 1569, 768])
(x1.shape): torch.Size([32, 1569, 768])
(x2.shape): torch.Size([32, 1569, 768])
x2.shape): torch.Size([32, 1569, 768])
(x1.shape): torch.Size([32, 1569, 768])
(x2.shape): torch.Size([32, 1569, 768])
x2.shape): torch.Size([32, 1569, 768])
(x1.shape): torch.Size([32, 1569, 768])
(x2.shape): torch.Size([32, 1569, 768])
cls_token.shape: torch.Size([32, 8, 1, 768])
patch_token.shape: torch.Size([32, 8, 196, 768])
x.shape: torch.Size([256, 197, 768])
x2.shape: torch.Size([256, 197, 768])
temporal.shape: torch.Size([256, 768])
cls_token.shape: torch.Size([256, 768])
### cls_token.shape: torch.Size([32, 768])
features.shape: torch.Size([32, 768])
pred.shape: torch.Size([32, 2])
label.shape: torch.Size([32])
pred.shape: torch.Size([32, 2])

  0%|          | 0/13 [00:00<?, ?it/s][A
  8%|▊         | 1/13 [00:00<00:07,  1.65it/s][A
 15%|█▌        | 2/13 [00:00<00:03,  3.04it/s][A
 23%|██▎       | 3/13 [00:00<00:02,  4.17it/s][A
 31%|███       | 4/13 [00:01<00:01,  5.05it/s][A
 38%|███▊      | 5/13 [00:01<00:01,  5.72it/s][A
 46%|████▌     | 6/13 [00:01<00:01,  6.21it/s][Ax.shape: torch.Size([8, 8, 3, 224, 224])
x.ndim: 5
x.shape: torch.Size([64, 3, 224, 224])
batch_size: 64
embeddings.shape: torch.Size([64, 197, 768])
input_ini - x shape before view: torch.Size([8, 8, 196, 768])
input_ini - x shape after first reshape: torch.Size([1568, 8, 768])
input_ini - x shape after cat: torch.Size([1568, 9, 768])
input_ini - x shape before final reshape: torch.Size([1568, 8, 768])
input_ini - x shape after final reshape: torch.Size([8, 196, 8, 768])
input_ini - x shape at end: torch.Size([8, 1568, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
cls_token.shape: torch.Size([8, 8, 1, 768])
patch_token.shape: torch.Size([8, 8, 196, 768])
x.shape: torch.Size([64, 197, 768])
x2.shape: torch.Size([64, 197, 768])
temporal.shape: torch.Size([64, 768])
cls_token.shape: torch.Size([64, 768])
### cls_token.shape: torch.Size([8, 768])
features.shape: torch.Size([8, 768])
pred.shape: torch.Size([8, 2])
label.shape: torch.Size([8])
pred.shape: torch.Size([8, 2])
x.shape: torch.Size([8, 8, 3, 224, 224])
x.ndim: 5
x.shape: torch.Size([64, 3, 224, 224])
batch_size: 64
embeddings.shape: torch.Size([64, 197, 768])
input_ini - x shape before view: torch.Size([8, 8, 196, 768])
input_ini - x shape after first reshape: torch.Size([1568, 8, 768])
input_ini - x shape after cat: torch.Size([1568, 9, 768])
input_ini - x shape before final reshape: torch.Size([1568, 8, 768])
input_ini - x shape after final reshape: torch.Size([8, 196, 8, 768])
input_ini - x shape at end: torch.Size([8, 1568, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
cls_token.shape: torch.Size([8, 8, 1, 768])
patch_token.shape: torch.Size([8, 8, 196, 768])
x.shape: torch.Size([64, 197, 768])
x2.shape: torch.Size([64, 197, 768])
temporal.shape: torch.Size([64, 768])
cls_token.shape: torch.Size([64, 768])
### cls_token.shape: torch.Size([8, 768])
features.shape: torch.Size([8, 768])
pred.shape: torch.Size([8, 2])
label.shape: torch.Size([8])
pred.shape: torch.Size([8, 2])
x.shape: torch.Size([8, 8, 3, 224, 224])
x.ndim: 5
x.shape: torch.Size([64, 3, 224, 224])
batch_size: 64
embeddings.shape: torch.Size([64, 197, 768])
input_ini - x shape before view: torch.Size([8, 8, 196, 768])
input_ini - x shape after first reshape: torch.Size([1568, 8, 768])
input_ini - x shape after cat: torch.Size([1568, 9, 768])
input_ini - x shape before final reshape: torch.Size([1568, 8, 768])
input_ini - x shape after final reshape: torch.Size([8, 196, 8, 768])
input_ini - x shape at end: torch.Size([8, 1568, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
cls_token.shape: torch.Size([8, 8, 1, 768])
patch_token.shape: torch.Size([8, 8, 196, 768])
x.shape: torch.Size([64, 197, 768])
x2.shape: torch.Size([64, 197, 768])
temporal.shape: torch.Size([64, 768])
cls_token.shape: torch.Size([64, 768])
### cls_token.shape: torch.Size([8, 768])
features.shape: torch.Size([8, 768])
pred.shape: torch.Size([8, 2])
label.shape: torch.Size([8])
pred.shape: torch.Size([8, 2])
x.shape: torch.Size([8, 8, 3, 224, 224])
x.ndim: 5
x.shape: torch.Size([64, 3, 224, 224])
batch_size: 64
embeddings.shape: torch.Size([64, 197, 768])
input_ini - x shape before view: torch.Size([8, 8, 196, 768])
input_ini - x shape after first reshape: torch.Size([1568, 8, 768])
input_ini - x shape after cat: torch.Size([1568, 9, 768])
input_ini - x shape before final reshape: torch.Size([1568, 8, 768])
input_ini - x shape after final reshape: torch.Size([8, 196, 8, 768])
input_ini - x shape at end: torch.Size([8, 1568, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
cls_token.shape: torch.Size([8, 8, 1, 768])
patch_token.shape: torch.Size([8, 8, 196, 768])
x.shape: torch.Size([64, 197, 768])
x2.shape: torch.Size([64, 197, 768])
temporal.shape: torch.Size([64, 768])
cls_token.shape: torch.Size([64, 768])
### cls_token.shape: torch.Size([8, 768])
features.shape: torch.Size([8, 768])
pred.shape: torch.Size([8, 2])
label.shape: torch.Size([8])
pred.shape: torch.Size([8, 2])
x.shape: torch.Size([8, 8, 3, 224, 224])
x.ndim: 5
x.shape: torch.Size([64, 3, 224, 224])
batch_size: 64
embeddings.shape: torch.Size([64, 197, 768])
input_ini - x shape before view: torch.Size([8, 8, 196, 768])
input_ini - x shape after first reshape: torch.Size([1568, 8, 768])
input_ini - x shape after cat: torch.Size([1568, 9, 768])
input_ini - x shape before final reshape: torch.Size([1568, 8, 768])
input_ini - x shape after final reshape: torch.Size([8, 196, 8, 768])
input_ini - x shape at end: torch.Size([8, 1568, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
cls_token.shape: torch.Size([8, 8, 1, 768])
patch_token.shape: torch.Size([8, 8, 196, 768])
x.shape: torch.Size([64, 197, 768])
x2.shape: torch.Size([64, 197, 768])
temporal.shape: torch.Size([64, 768])
cls_token.shape: torch.Size([64, 768])
### cls_token.shape: torch.Size([8, 768])
features.shape: torch.Size([8, 768])
pred.shape: torch.Size([8, 2])
label.shape: torch.Size([8])
pred.shape: torch.Size([8, 2])
x.shape: torch.Size([8, 8, 3, 224, 224])
x.ndim: 5
x.shape: torch.Size([64, 3, 224, 224])
batch_size: 64
embeddings.shape: torch.Size([64, 197, 768])
input_ini - x shape before view: torch.Size([8, 8, 196, 768])
input_ini - x shape after first reshape: torch.Size([1568, 8, 768])
input_ini - x shape after cat: torch.Size([1568, 9, 768])
input_ini - x shape before final reshape: torch.Size([1568, 8, 768])
input_ini - x shape after final reshape: torch.Size([8, 196, 8, 768])
input_ini - x shape at end: torch.Size([8, 1568, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
cls_token.shape: torch.Size([8, 8, 1, 768])
patch_token.shape: torch.Size([8, 8, 196, 768])
x.shape: torch.Size([64, 197, 768])
x2.shape: torch.Size([64, 197, 768])
temporal.shape: torch.Size([64, 768])
cls_token.shape: torch.Size([64, 768])
### cls_token.shape: torch.Size([8, 768])
features.shape: torch.Size([8, 768])
pred.shape: torch.Size([8, 2])
label.shape: torch.Size([8])
pred.shape: torch.Size([8, 2])
x.shape: torch.Size([8, 8, 3, 224, 224])
x.ndim: 5
x.shape: torch.Size([64, 3, 224, 224])
batch_size: 64
embeddings.shape: torch.Size([64, 197, 768])
input_ini - x shape before view: torch.Size([8, 8, 196, 768])
input_ini - x shape after first reshape: torch.Size([1568, 8, 768])
input_ini - x shape after cat: torch.Size([1568, 9, 768])
input_ini - x shape before final reshape: torch.Size([1568, 8, 768])

 54%|█████▍    | 7/13 [00:01<00:00,  6.57it/s][A
 62%|██████▏   | 8/13 [00:01<00:00,  6.84it/s][A
 69%|██████▉   | 9/13 [00:01<00:00,  7.02it/s][A
 77%|███████▋  | 10/13 [00:01<00:00,  7.16it/s][A
 85%|████████▍ | 11/13 [00:01<00:00,  7.25it/s][A
 92%|█████████▏| 12/13 [00:02<00:00,  7.31it/s][Ainput_ini - x shape after final reshape: torch.Size([8, 196, 8, 768])
input_ini - x shape at end: torch.Size([8, 1568, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
cls_token.shape: torch.Size([8, 8, 1, 768])
patch_token.shape: torch.Size([8, 8, 196, 768])
x.shape: torch.Size([64, 197, 768])
x2.shape: torch.Size([64, 197, 768])
temporal.shape: torch.Size([64, 768])
cls_token.shape: torch.Size([64, 768])
### cls_token.shape: torch.Size([8, 768])
features.shape: torch.Size([8, 768])
pred.shape: torch.Size([8, 2])
label.shape: torch.Size([8])
pred.shape: torch.Size([8, 2])
x.shape: torch.Size([8, 8, 3, 224, 224])
x.ndim: 5
x.shape: torch.Size([64, 3, 224, 224])
batch_size: 64
embeddings.shape: torch.Size([64, 197, 768])
input_ini - x shape before view: torch.Size([8, 8, 196, 768])
input_ini - x shape after first reshape: torch.Size([1568, 8, 768])
input_ini - x shape after cat: torch.Size([1568, 9, 768])
input_ini - x shape before final reshape: torch.Size([1568, 8, 768])
input_ini - x shape after final reshape: torch.Size([8, 196, 8, 768])
input_ini - x shape at end: torch.Size([8, 1568, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
cls_token.shape: torch.Size([8, 8, 1, 768])
patch_token.shape: torch.Size([8, 8, 196, 768])
x.shape: torch.Size([64, 197, 768])
x2.shape: torch.Size([64, 197, 768])
temporal.shape: torch.Size([64, 768])
cls_token.shape: torch.Size([64, 768])
### cls_token.shape: torch.Size([8, 768])
features.shape: torch.Size([8, 768])
pred.shape: torch.Size([8, 2])
label.shape: torch.Size([8])
pred.shape: torch.Size([8, 2])
x.shape: torch.Size([8, 8, 3, 224, 224])
x.ndim: 5
x.shape: torch.Size([64, 3, 224, 224])
batch_size: 64
embeddings.shape: torch.Size([64, 197, 768])
input_ini - x shape before view: torch.Size([8, 8, 196, 768])
input_ini - x shape after first reshape: torch.Size([1568, 8, 768])
input_ini - x shape after cat: torch.Size([1568, 9, 768])
input_ini - x shape before final reshape: torch.Size([1568, 8, 768])
input_ini - x shape after final reshape: torch.Size([8, 196, 8, 768])
input_ini - x shape at end: torch.Size([8, 1568, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
cls_token.shape: torch.Size([8, 8, 1, 768])
patch_token.shape: torch.Size([8, 8, 196, 768])
x.shape: torch.Size([64, 197, 768])
x2.shape: torch.Size([64, 197, 768])
temporal.shape: torch.Size([64, 768])
cls_token.shape: torch.Size([64, 768])
### cls_token.shape: torch.Size([8, 768])
features.shape: torch.Size([8, 768])
pred.shape: torch.Size([8, 2])
label.shape: torch.Size([8])
pred.shape: torch.Size([8, 2])
x.shape: torch.Size([8, 8, 3, 224, 224])
x.ndim: 5
x.shape: torch.Size([64, 3, 224, 224])
batch_size: 64
embeddings.shape: torch.Size([64, 197, 768])
input_ini - x shape before view: torch.Size([8, 8, 196, 768])
input_ini - x shape after first reshape: torch.Size([1568, 8, 768])
input_ini - x shape after cat: torch.Size([1568, 9, 768])
input_ini - x shape before final reshape: torch.Size([1568, 8, 768])
input_ini - x shape after final reshape: torch.Size([8, 196, 8, 768])
input_ini - x shape at end: torch.Size([8, 1568, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
cls_token.shape: torch.Size([8, 8, 1, 768])
patch_token.shape: torch.Size([8, 8, 196, 768])
x.shape: torch.Size([64, 197, 768])
x2.shape: torch.Size([64, 197, 768])
temporal.shape: torch.Size([64, 768])
cls_token.shape: torch.Size([64, 768])
### cls_token.shape: torch.Size([8, 768])
features.shape: torch.Size([8, 768])
pred.shape: torch.Size([8, 2])
label.shape: torch.Size([8])
pred.shape: torch.Size([8, 2])
x.shape: torch.Size([8, 8, 3, 224, 224])
x.ndim: 5
x.shape: torch.Size([64, 3, 224, 224])
batch_size: 64
embeddings.shape: torch.Size([64, 197, 768])
input_ini - x shape before view: torch.Size([8, 8, 196, 768])
input_ini - x shape after first reshape: torch.Size([1568, 8, 768])
input_ini - x shape after cat: torch.Size([1568, 9, 768])
input_ini - x shape before final reshape: torch.Size([1568, 8, 768])
input_ini - x shape after final reshape: torch.Size([8, 196, 8, 768])
input_ini - x shape at end: torch.Size([8, 1568, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
cls_token.shape: torch.Size([8, 8, 1, 768])
patch_token.shape: torch.Size([8, 8, 196, 768])
x.shape: torch.Size([64, 197, 768])
x2.shape: torch.Size([64, 197, 768])
temporal.shape: torch.Size([64, 768])
cls_token.shape: torch.Size([64, 768])
### cls_token.shape: torch.Size([8, 768])
features.shape: torch.Size([8, 768])
pred.shape: torch.Size([8, 2])
label.shape: torch.Size([8])
pred.shape: torch.Size([8, 2])
x.shape: torch.Size([8, 8, 3, 224, 224])
x.ndim: 5
x.shape: torch.Size([64, 3, 224, 224])
batch_size: 64
embeddings.shape: torch.Size([64, 197, 768])
input_ini - x shape before view: torch.Size([8, 8, 196, 768])
input_ini - x shape after first reshape: torch.Size([1568, 8, 768])
input_ini - x shape after cat: torch.Size([1568, 9, 768])
input_ini - x shape before final reshape: torch.Size([1568, 8, 768])
input_ini - x shape after final reshape: torch.Size([8, 196, 8, 768])
input_ini - x shape at end: torch.Size([8, 1568, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
cls_token.shape: torch.Size([8, 8, 1, 768])
patch_token.shape: torch.Size([8, 8, 196, 768])
x.shape: torch.Size([64, 197, 768])
x2.shape: torch.Size([64, 197, 768])
temporal.shape: torch.Size([64, 768])
cls_token.shape: torch.Size([64, 768])
### cls_token.shape: torch.Size([8, 768])
features.shape: torch.Size([8, 768])
pred.shape: torch.Size([8, 2])
label.shape: torch.Size([8])
pred.shape: torch.Size([8, 2])
x.shape: torch.Size([4, 8, 3, 224, 224])
x.ndim: 5
x.shape: torch.Size([32, 3, 224, 224])
batch_size: 32
embeddings.shape: torch.Size([32, 197, 768])
input_ini - x shape before view: torch.Size([4, 8, 196, 768])
input_ini - x shape after first reshape: torch.Size([784, 8, 768])
input_ini - x shape after cat: torch.Size([784, 9, 768])
input_ini - x shape before final reshape: torch.Size([784, 8, 768])
input_ini - x shape after final reshape: torch.Size([4, 196, 8, 768])
input_ini - x shape at end: torch.Size([4, 1568, 768])
x2.shape): torch.Size([4, 1569, 768])
(x1.shape): torch.Size([4, 1569, 768])
(x2.shape): torch.Size([4, 1569, 768])
x2.shape): torch.Size([4, 1569, 768])
(x1.shape): torch.Size([4, 1569, 768])
(x2.shape): torch.Size([4, 1569, 768])
x2.shape): torch.Size([4, 1569, 768])
(x1.shape): torch.Size([4, 1569, 768])
100%|██████████| 13/13 [00:02<00:00,  6.04it/s]
2025-05-30 10:57:09,076 - INFO - dataset: DFDC    step: 29    testing-loss, overall: 0.677734375    
2025-05-30 10:57:09,077 - INFO - dataset: DFDC    step: 29    testing-metric, acc: 0.65    testing-metric, auc: 0.5030769230769231    testing-metric, eer: 0.5142857142857142    testing-metric, ap: 0.7037169325037185    testing-metric, video_auc: 0.5030769230769231    testing-metric, acc_real:0.7714285714285715; acc_fake:0.5846153846153846
2025-05-30 10:57:09,077 - INFO - dataset: avg    step: 29    testing-metric, acc: 0.65    testing-metric, auc: 0.5030769230769231    testing-metric, eer: 0.5142857142857142    testing-metric, ap: 0.7037169325037185    testing-metric, video_auc: 0.5030769230769231    
2025-05-30 10:57:09,077 - INFO - ===> Test Done!
 50%|█████     | 2/4 [00:05<00:05,  2.64s/it] 75%|███████▌  | 3/4 [00:05<00:01,  1.67s/it]2025-05-30 10:57:09,673 - INFO - ===> Test start!
2025-05-30 10:57:09,675 - INFO - data_dict saved to ./logs/training/clip_stan_2025-05-30-10-56-05/test/DFDC/data_dict_test.pickle
(x2.shape): torch.Size([4, 1569, 768])
cls_token.shape: torch.Size([4, 8, 1, 768])
patch_token.shape: torch.Size([4, 8, 196, 768])
x.shape: torch.Size([32, 197, 768])
x2.shape: torch.Size([32, 197, 768])
temporal.shape: torch.Size([32, 768])
cls_token.shape: torch.Size([32, 768])
### cls_token.shape: torch.Size([4, 768])
features.shape: torch.Size([4, 768])
pred.shape: torch.Size([4, 2])
label.shape: torch.Size([4])
pred.shape: torch.Size([4, 2])
len(y_pred): 100
len(y_true): 100
x.shape: torch.Size([32, 8, 3, 224, 224])
x.ndim: 5
x.shape: torch.Size([256, 3, 224, 224])
batch_size: 256
embeddings.shape: torch.Size([256, 197, 768])
input_ini - x shape before view: torch.Size([32, 8, 196, 768])
input_ini - x shape after first reshape: torch.Size([6272, 8, 768])
input_ini - x shape after cat: torch.Size([6272, 9, 768])
input_ini - x shape before final reshape: torch.Size([6272, 8, 768])
input_ini - x shape after final reshape: torch.Size([32, 196, 8, 768])
input_ini - x shape at end: torch.Size([32, 1568, 768])
x2.shape): torch.Size([32, 1569, 768])
(x1.shape): torch.Size([32, 1569, 768])
(x2.shape): torch.Size([32, 1569, 768])
x2.shape): torch.Size([32, 1569, 768])
(x1.shape): torch.Size([32, 1569, 768])
(x2.shape): torch.Size([32, 1569, 768])
x2.shape): torch.Size([32, 1569, 768])
(x1.shape): torch.Size([32, 1569, 768])
(x2.shape): torch.Size([32, 1569, 768])
cls_token.shape: torch.Size([32, 8, 1, 768])
patch_token.shape: torch.Size([32, 8, 196, 768])
x.shape: torch.Size([256, 197, 768])
x2.shape: torch.Size([256, 197, 768])
temporal.shape: torch.Size([256, 768])
cls_token.shape: torch.Size([256, 768])
### cls_token.shape: torch.Size([32, 768])
features.shape: torch.Size([32, 768])
pred.shape: torch.Size([32, 2])
label.shape: torch.Size([32])
pred.shape: torch.Size([32, 2])
x.shape: torch.Size([4, 8, 3, 224, 224])
x.ndim: 5
x.shape: torch.Size([32, 3, 224, 224])
batch_size: 32
embeddings.shape: torch.Size([32, 197, 768])
input_ini - x shape before view: torch.Size([4, 8, 196, 768])
input_ini - x shape after first reshape: torch.Size([784, 8, 768])
input_ini - x shape after cat: torch.Size([784, 9, 768])
input_ini - x shape before final reshape: torch.Size([784, 8, 768])
input_ini - x shape after final reshape: torch.Size([4, 196, 8, 768])
input_ini - x shape at end: torch.Size([4, 1568, 768])
x2.shape): torch.Size([4, 1569, 768])
(x1.shape): torch.Size([4, 1569, 768])
(x2.shape): torch.Size([4, 1569, 768])
x2.shape): torch.Size([4, 1569, 768])
(x1.shape): torch.Size([4, 1569, 768])
(x2.shape): torch.Size([4, 1569, 768])
x2.shape): torch.Size([4, 1569, 768])
(x1.shape): torch.Size([4, 1569, 768])
(x2.shape): torch.Size([4, 1569, 768])
cls_token.shape: torch.Size([4, 8, 1, 768])
patch_token.shape: torch.Size([4, 8, 196, 768])
x.shape: torch.Size([32, 197, 768])
x2.shape: torch.Size([32, 197, 768])
temporal.shape: torch.Size([32, 768])
cls_token.shape: torch.Size([32, 768])
### cls_token.shape: torch.Size([4, 768])
features.shape: torch.Size([4, 768])
pred.shape: torch.Size([4, 2])
label.shape: torch.Size([4])
pred.shape: torch.Size([4, 2])

  0%|          | 0/13 [00:00<?, ?it/s][A
  8%|▊         | 1/13 [00:00<00:07,  1.58it/s][A
 15%|█▌        | 2/13 [00:00<00:03,  2.95it/s][A
 23%|██▎       | 3/13 [00:00<00:02,  4.08it/s][A
 31%|███       | 4/13 [00:01<00:01,  4.97it/s][A
 38%|███▊      | 5/13 [00:01<00:01,  5.65it/s][A
 46%|████▌     | 6/13 [00:01<00:01,  6.16it/s][Ax.shape: torch.Size([8, 8, 3, 224, 224])
x.ndim: 5
x.shape: torch.Size([64, 3, 224, 224])
batch_size: 64
embeddings.shape: torch.Size([64, 197, 768])
input_ini - x shape before view: torch.Size([8, 8, 196, 768])
input_ini - x shape after first reshape: torch.Size([1568, 8, 768])
input_ini - x shape after cat: torch.Size([1568, 9, 768])
input_ini - x shape before final reshape: torch.Size([1568, 8, 768])
input_ini - x shape after final reshape: torch.Size([8, 196, 8, 768])
input_ini - x shape at end: torch.Size([8, 1568, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
cls_token.shape: torch.Size([8, 8, 1, 768])
patch_token.shape: torch.Size([8, 8, 196, 768])
x.shape: torch.Size([64, 197, 768])
x2.shape: torch.Size([64, 197, 768])
temporal.shape: torch.Size([64, 768])
cls_token.shape: torch.Size([64, 768])
### cls_token.shape: torch.Size([8, 768])
features.shape: torch.Size([8, 768])
pred.shape: torch.Size([8, 2])
label.shape: torch.Size([8])
pred.shape: torch.Size([8, 2])
x.shape: torch.Size([8, 8, 3, 224, 224])
x.ndim: 5
x.shape: torch.Size([64, 3, 224, 224])
batch_size: 64
embeddings.shape: torch.Size([64, 197, 768])
input_ini - x shape before view: torch.Size([8, 8, 196, 768])
input_ini - x shape after first reshape: torch.Size([1568, 8, 768])
input_ini - x shape after cat: torch.Size([1568, 9, 768])
input_ini - x shape before final reshape: torch.Size([1568, 8, 768])
input_ini - x shape after final reshape: torch.Size([8, 196, 8, 768])
input_ini - x shape at end: torch.Size([8, 1568, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
cls_token.shape: torch.Size([8, 8, 1, 768])
patch_token.shape: torch.Size([8, 8, 196, 768])
x.shape: torch.Size([64, 197, 768])
x2.shape: torch.Size([64, 197, 768])
temporal.shape: torch.Size([64, 768])
cls_token.shape: torch.Size([64, 768])
### cls_token.shape: torch.Size([8, 768])
features.shape: torch.Size([8, 768])
pred.shape: torch.Size([8, 2])
label.shape: torch.Size([8])
pred.shape: torch.Size([8, 2])
x.shape: torch.Size([8, 8, 3, 224, 224])
x.ndim: 5
x.shape: torch.Size([64, 3, 224, 224])
batch_size: 64
embeddings.shape: torch.Size([64, 197, 768])
input_ini - x shape before view: torch.Size([8, 8, 196, 768])
input_ini - x shape after first reshape: torch.Size([1568, 8, 768])
input_ini - x shape after cat: torch.Size([1568, 9, 768])
input_ini - x shape before final reshape: torch.Size([1568, 8, 768])
input_ini - x shape after final reshape: torch.Size([8, 196, 8, 768])
input_ini - x shape at end: torch.Size([8, 1568, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
cls_token.shape: torch.Size([8, 8, 1, 768])
patch_token.shape: torch.Size([8, 8, 196, 768])
x.shape: torch.Size([64, 197, 768])
x2.shape: torch.Size([64, 197, 768])
temporal.shape: torch.Size([64, 768])
cls_token.shape: torch.Size([64, 768])
### cls_token.shape: torch.Size([8, 768])
features.shape: torch.Size([8, 768])
pred.shape: torch.Size([8, 2])
label.shape: torch.Size([8])
pred.shape: torch.Size([8, 2])
x.shape: torch.Size([8, 8, 3, 224, 224])
x.ndim: 5
x.shape: torch.Size([64, 3, 224, 224])
batch_size: 64
embeddings.shape: torch.Size([64, 197, 768])
input_ini - x shape before view: torch.Size([8, 8, 196, 768])
input_ini - x shape after first reshape: torch.Size([1568, 8, 768])
input_ini - x shape after cat: torch.Size([1568, 9, 768])
input_ini - x shape before final reshape: torch.Size([1568, 8, 768])
input_ini - x shape after final reshape: torch.Size([8, 196, 8, 768])
input_ini - x shape at end: torch.Size([8, 1568, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
cls_token.shape: torch.Size([8, 8, 1, 768])
patch_token.shape: torch.Size([8, 8, 196, 768])
x.shape: torch.Size([64, 197, 768])
x2.shape: torch.Size([64, 197, 768])
temporal.shape: torch.Size([64, 768])
cls_token.shape: torch.Size([64, 768])
### cls_token.shape: torch.Size([8, 768])
features.shape: torch.Size([8, 768])
pred.shape: torch.Size([8, 2])
label.shape: torch.Size([8])
pred.shape: torch.Size([8, 2])
x.shape: torch.Size([8, 8, 3, 224, 224])
x.ndim: 5
x.shape: torch.Size([64, 3, 224, 224])
batch_size: 64
embeddings.shape: torch.Size([64, 197, 768])
input_ini - x shape before view: torch.Size([8, 8, 196, 768])
input_ini - x shape after first reshape: torch.Size([1568, 8, 768])
input_ini - x shape after cat: torch.Size([1568, 9, 768])
input_ini - x shape before final reshape: torch.Size([1568, 8, 768])
input_ini - x shape after final reshape: torch.Size([8, 196, 8, 768])
input_ini - x shape at end: torch.Size([8, 1568, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
cls_token.shape: torch.Size([8, 8, 1, 768])
patch_token.shape: torch.Size([8, 8, 196, 768])
x.shape: torch.Size([64, 197, 768])
x2.shape: torch.Size([64, 197, 768])
temporal.shape: torch.Size([64, 768])
cls_token.shape: torch.Size([64, 768])
### cls_token.shape: torch.Size([8, 768])
features.shape: torch.Size([8, 768])
pred.shape: torch.Size([8, 2])
label.shape: torch.Size([8])
pred.shape: torch.Size([8, 2])
x.shape: torch.Size([8, 8, 3, 224, 224])
x.ndim: 5
x.shape: torch.Size([64, 3, 224, 224])
batch_size: 64
embeddings.shape: torch.Size([64, 197, 768])
input_ini - x shape before view: torch.Size([8, 8, 196, 768])
input_ini - x shape after first reshape: torch.Size([1568, 8, 768])
input_ini - x shape after cat: torch.Size([1568, 9, 768])
input_ini - x shape before final reshape: torch.Size([1568, 8, 768])
input_ini - x shape after final reshape: torch.Size([8, 196, 8, 768])
input_ini - x shape at end: torch.Size([8, 1568, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
cls_token.shape: torch.Size([8, 8, 1, 768])
patch_token.shape: torch.Size([8, 8, 196, 768])
x.shape: torch.Size([64, 197, 768])
x2.shape: torch.Size([64, 197, 768])
temporal.shape: torch.Size([64, 768])
cls_token.shape: torch.Size([64, 768])
### cls_token.shape: torch.Size([8, 768])
features.shape: torch.Size([8, 768])
pred.shape: torch.Size([8, 2])
label.shape: torch.Size([8])
pred.shape: torch.Size([8, 2])
x.shape: torch.Size([8, 8, 3, 224, 224])
x.ndim: 5
x.shape: torch.Size([64, 3, 224, 224])
batch_size: 64
embeddings.shape: torch.Size([64, 197, 768])
input_ini - x shape before view: torch.Size([8, 8, 196, 768])
input_ini - x shape after first reshape: torch.Size([1568, 8, 768])
input_ini - x shape after cat: torch.Size([1568, 9, 768])
input_ini - x shape before final reshape: torch.Size([1568, 8, 768])

 54%|█████▍    | 7/13 [00:01<00:00,  6.53it/s][A
 62%|██████▏   | 8/13 [00:01<00:00,  6.80it/s][A
 69%|██████▉   | 9/13 [00:01<00:00,  7.00it/s][A
 77%|███████▋  | 10/13 [00:01<00:00,  7.13it/s][A
 85%|████████▍ | 11/13 [00:01<00:00,  7.22it/s][A
 92%|█████████▏| 12/13 [00:02<00:00,  7.29it/s][Ainput_ini - x shape after final reshape: torch.Size([8, 196, 8, 768])
input_ini - x shape at end: torch.Size([8, 1568, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
cls_token.shape: torch.Size([8, 8, 1, 768])
patch_token.shape: torch.Size([8, 8, 196, 768])
x.shape: torch.Size([64, 197, 768])
x2.shape: torch.Size([64, 197, 768])
temporal.shape: torch.Size([64, 768])
cls_token.shape: torch.Size([64, 768])
### cls_token.shape: torch.Size([8, 768])
features.shape: torch.Size([8, 768])
pred.shape: torch.Size([8, 2])
label.shape: torch.Size([8])
pred.shape: torch.Size([8, 2])
x.shape: torch.Size([8, 8, 3, 224, 224])
x.ndim: 5
x.shape: torch.Size([64, 3, 224, 224])
batch_size: 64
embeddings.shape: torch.Size([64, 197, 768])
input_ini - x shape before view: torch.Size([8, 8, 196, 768])
input_ini - x shape after first reshape: torch.Size([1568, 8, 768])
input_ini - x shape after cat: torch.Size([1568, 9, 768])
input_ini - x shape before final reshape: torch.Size([1568, 8, 768])
input_ini - x shape after final reshape: torch.Size([8, 196, 8, 768])
input_ini - x shape at end: torch.Size([8, 1568, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
cls_token.shape: torch.Size([8, 8, 1, 768])
patch_token.shape: torch.Size([8, 8, 196, 768])
x.shape: torch.Size([64, 197, 768])
x2.shape: torch.Size([64, 197, 768])
temporal.shape: torch.Size([64, 768])
cls_token.shape: torch.Size([64, 768])
### cls_token.shape: torch.Size([8, 768])
features.shape: torch.Size([8, 768])
pred.shape: torch.Size([8, 2])
label.shape: torch.Size([8])
pred.shape: torch.Size([8, 2])
x.shape: torch.Size([8, 8, 3, 224, 224])
x.ndim: 5
x.shape: torch.Size([64, 3, 224, 224])
batch_size: 64
embeddings.shape: torch.Size([64, 197, 768])
input_ini - x shape before view: torch.Size([8, 8, 196, 768])
input_ini - x shape after first reshape: torch.Size([1568, 8, 768])
input_ini - x shape after cat: torch.Size([1568, 9, 768])
input_ini - x shape before final reshape: torch.Size([1568, 8, 768])
input_ini - x shape after final reshape: torch.Size([8, 196, 8, 768])
input_ini - x shape at end: torch.Size([8, 1568, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
cls_token.shape: torch.Size([8, 8, 1, 768])
patch_token.shape: torch.Size([8, 8, 196, 768])
x.shape: torch.Size([64, 197, 768])
x2.shape: torch.Size([64, 197, 768])
temporal.shape: torch.Size([64, 768])
cls_token.shape: torch.Size([64, 768])
### cls_token.shape: torch.Size([8, 768])
features.shape: torch.Size([8, 768])
pred.shape: torch.Size([8, 2])
label.shape: torch.Size([8])
pred.shape: torch.Size([8, 2])
x.shape: torch.Size([8, 8, 3, 224, 224])
x.ndim: 5
x.shape: torch.Size([64, 3, 224, 224])
batch_size: 64
embeddings.shape: torch.Size([64, 197, 768])
input_ini - x shape before view: torch.Size([8, 8, 196, 768])
input_ini - x shape after first reshape: torch.Size([1568, 8, 768])
input_ini - x shape after cat: torch.Size([1568, 9, 768])
input_ini - x shape before final reshape: torch.Size([1568, 8, 768])
input_ini - x shape after final reshape: torch.Size([8, 196, 8, 768])
input_ini - x shape at end: torch.Size([8, 1568, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
cls_token.shape: torch.Size([8, 8, 1, 768])
patch_token.shape: torch.Size([8, 8, 196, 768])
x.shape: torch.Size([64, 197, 768])
x2.shape: torch.Size([64, 197, 768])
temporal.shape: torch.Size([64, 768])
cls_token.shape: torch.Size([64, 768])
### cls_token.shape: torch.Size([8, 768])
features.shape: torch.Size([8, 768])
pred.shape: torch.Size([8, 2])
label.shape: torch.Size([8])
pred.shape: torch.Size([8, 2])
x.shape: torch.Size([8, 8, 3, 224, 224])
x.ndim: 5
x.shape: torch.Size([64, 3, 224, 224])
batch_size: 64
embeddings.shape: torch.Size([64, 197, 768])
input_ini - x shape before view: torch.Size([8, 8, 196, 768])
input_ini - x shape after first reshape: torch.Size([1568, 8, 768])
input_ini - x shape after cat: torch.Size([1568, 9, 768])
input_ini - x shape before final reshape: torch.Size([1568, 8, 768])
input_ini - x shape after final reshape: torch.Size([8, 196, 8, 768])
input_ini - x shape at end: torch.Size([8, 1568, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
cls_token.shape: torch.Size([8, 8, 1, 768])
patch_token.shape: torch.Size([8, 8, 196, 768])
x.shape: torch.Size([64, 197, 768])
x2.shape: torch.Size([64, 197, 768])
temporal.shape: torch.Size([64, 768])
cls_token.shape: torch.Size([64, 768])
### cls_token.shape: torch.Size([8, 768])
features.shape: torch.Size([8, 768])
pred.shape: torch.Size([8, 2])
label.shape: torch.Size([8])
pred.shape: torch.Size([8, 2])
x.shape: torch.Size([8, 8, 3, 224, 224])
x.ndim: 5
x.shape: torch.Size([64, 3, 224, 224])
batch_size: 64
embeddings.shape: torch.Size([64, 197, 768])
input_ini - x shape before view: torch.Size([8, 8, 196, 768])
input_ini - x shape after first reshape: torch.Size([1568, 8, 768])
input_ini - x shape after cat: torch.Size([1568, 9, 768])
input_ini - x shape before final reshape: torch.Size([1568, 8, 768])
input_ini - x shape after final reshape: torch.Size([8, 196, 8, 768])
input_ini - x shape at end: torch.Size([8, 1568, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
cls_token.shape: torch.Size([8, 8, 1, 768])
patch_token.shape: torch.Size([8, 8, 196, 768])
x.shape: torch.Size([64, 197, 768])
x2.shape: torch.Size([64, 197, 768])
temporal.shape: torch.Size([64, 768])
cls_token.shape: torch.Size([64, 768])
### cls_token.shape: torch.Size([8, 768])
features.shape: torch.Size([8, 768])
pred.shape: torch.Size([8, 2])
label.shape: torch.Size([8])
pred.shape: torch.Size([8, 2])
x.shape: torch.Size([4, 8, 3, 224, 224])
x.ndim: 5
x.shape: torch.Size([32, 3, 224, 224])
batch_size: 32
embeddings.shape: torch.Size([32, 197, 768])
input_ini - x shape before view: torch.Size([4, 8, 196, 768])
input_ini - x shape after first reshape: torch.Size([784, 8, 768])
input_ini - x shape after cat: torch.Size([784, 9, 768])
input_ini - x shape before final reshape: torch.Size([784, 8, 768])
input_ini - x shape after final reshape: torch.Size([4, 196, 8, 768])
input_ini - x shape at end: torch.Size([4, 1568, 768])
x2.shape): torch.Size([4, 1569, 768])
(x1.shape): torch.Size([4, 1569, 768])
(x2.shape): torch.Size([4, 1569, 768])
x2.shape): torch.Size([4, 1569, 768])
(x1.shape): torch.Size([4, 1569, 768])
(x2.shape): torch.Size([4, 1569, 768])
x2.shape): torch.Size([4, 1569, 768])
(x1.shape): torch.Size([4, 1569, 768])
100%|██████████| 13/13 [00:02<00:00,  5.97it/s]
2025-05-30 10:57:11,864 - INFO - dataset: DFDC    step: 31    testing-loss, overall: 0.67724609375    
2025-05-30 10:57:11,866 - INFO - dataset: DFDC    step: 31    testing-metric, acc: 0.65    testing-metric, auc: 0.5032967032967033    testing-metric, eer: 0.5142857142857142    testing-metric, ap: 0.7047293407506665    testing-metric, video_auc: 0.5032967032967033    testing-metric, acc_real:0.7714285714285715; acc_fake:0.5846153846153846
2025-05-30 10:57:11,867 - INFO - dataset: avg    step: 31    testing-metric, acc: 0.65    testing-metric, auc: 0.5032967032967033    testing-metric, eer: 0.5142857142857142    testing-metric, ap: 0.7047293407506665    testing-metric, video_auc: 0.5032967032967033    
2025-05-30 10:57:11,869 - INFO - ===> Test Done!
100%|██████████| 4/4 [00:08<00:00,  1.91s/it]100%|██████████| 4/4 [00:08<00:00,  2.01s/it]
2025-05-30 10:57:11,873 - INFO - ===> Epoch[7] end with testing auc: 
================================ Each dataset best metric ================================ 
| DFDC:  auc=0.5090109890109891 | 
============================================================================================= 
================================== Average best metric ====================================== 
| avg auc: 0.5090109890109891 | 
| DFDC: 0.5090109890109891 | 
=============================================================================================!
2025-05-30 10:57:11,873 - INFO - ===> Epoch[8] start!
2025-05-30 10:57:11,875 - INFO - data_dict saved to ./logs/training/clip_stan_2025-05-30-10-56-05/train/FaceForensics++/data_dict_train.pickle
(x2.shape): torch.Size([4, 1569, 768])
cls_token.shape: torch.Size([4, 8, 1, 768])
patch_token.shape: torch.Size([4, 8, 196, 768])
x.shape: torch.Size([32, 197, 768])
x2.shape: torch.Size([32, 197, 768])
temporal.shape: torch.Size([32, 768])
cls_token.shape: torch.Size([32, 768])
### cls_token.shape: torch.Size([4, 768])
features.shape: torch.Size([4, 768])
pred.shape: torch.Size([4, 2])
label.shape: torch.Size([4])
pred.shape: torch.Size([4, 2])
len(y_pred): 100
len(y_true): 100
  0%|          | 0/4 [00:00<?, ?it/s]2025-05-30 10:57:14,314 - INFO - Iter: 32    training-loss, overall: 0.6810760498046875    
2025-05-30 10:57:14,315 - INFO - Iter: 32    training-metric, acc: 0.625    training-metric, auc: 0.6208333333333333    training-metric, eer: 0.5    training-metric, ap: 0.7112091856637811    
 25%|██▌       | 1/4 [00:02<00:07,  2.43s/it]2025-05-30 10:57:14,833 - INFO - ===> Test start!
2025-05-30 10:57:14,836 - INFO - data_dict saved to ./logs/training/clip_stan_2025-05-30-10-56-05/test/DFDC/data_dict_test.pickle
x.shape: torch.Size([32, 8, 3, 224, 224])
x.ndim: 5
x.shape: torch.Size([256, 3, 224, 224])
batch_size: 256
embeddings.shape: torch.Size([256, 197, 768])
input_ini - x shape before view: torch.Size([32, 8, 196, 768])
input_ini - x shape after first reshape: torch.Size([6272, 8, 768])
input_ini - x shape after cat: torch.Size([6272, 9, 768])
input_ini - x shape before final reshape: torch.Size([6272, 8, 768])
input_ini - x shape after final reshape: torch.Size([32, 196, 8, 768])
input_ini - x shape at end: torch.Size([32, 1568, 768])
x2.shape): torch.Size([32, 1569, 768])
(x1.shape): torch.Size([32, 1569, 768])
(x2.shape): torch.Size([32, 1569, 768])
x2.shape): torch.Size([32, 1569, 768])
(x1.shape): torch.Size([32, 1569, 768])
(x2.shape): torch.Size([32, 1569, 768])
x2.shape): torch.Size([32, 1569, 768])
(x1.shape): torch.Size([32, 1569, 768])
(x2.shape): torch.Size([32, 1569, 768])
cls_token.shape: torch.Size([32, 8, 1, 768])
patch_token.shape: torch.Size([32, 8, 196, 768])
x.shape: torch.Size([256, 197, 768])
x2.shape: torch.Size([256, 197, 768])
temporal.shape: torch.Size([256, 768])
cls_token.shape: torch.Size([256, 768])
### cls_token.shape: torch.Size([32, 768])
features.shape: torch.Size([32, 768])
pred.shape: torch.Size([32, 2])
label.shape: torch.Size([32])
pred.shape: torch.Size([32, 2])
x.shape: torch.Size([32, 8, 3, 224, 224])
x.ndim: 5
x.shape: torch.Size([256, 3, 224, 224])
batch_size: 256
embeddings.shape: torch.Size([256, 197, 768])
input_ini - x shape before view: torch.Size([32, 8, 196, 768])
input_ini - x shape after first reshape: torch.Size([6272, 8, 768])
input_ini - x shape after cat: torch.Size([6272, 9, 768])
input_ini - x shape before final reshape: torch.Size([6272, 8, 768])
input_ini - x shape after final reshape: torch.Size([32, 196, 8, 768])
input_ini - x shape at end: torch.Size([32, 1568, 768])
x2.shape): torch.Size([32, 1569, 768])
(x1.shape): torch.Size([32, 1569, 768])
(x2.shape): torch.Size([32, 1569, 768])
x2.shape): torch.Size([32, 1569, 768])
(x1.shape): torch.Size([32, 1569, 768])
(x2.shape): torch.Size([32, 1569, 768])
x2.shape): torch.Size([32, 1569, 768])
(x1.shape): torch.Size([32, 1569, 768])
(x2.shape): torch.Size([32, 1569, 768])
cls_token.shape: torch.Size([32, 8, 1, 768])
patch_token.shape: torch.Size([32, 8, 196, 768])
x.shape: torch.Size([256, 197, 768])
x2.shape: torch.Size([256, 197, 768])
temporal.shape: torch.Size([256, 768])
cls_token.shape: torch.Size([256, 768])
### cls_token.shape: torch.Size([32, 768])
features.shape: torch.Size([32, 768])
pred.shape: torch.Size([32, 2])
label.shape: torch.Size([32])
pred.shape: torch.Size([32, 2])

  0%|          | 0/13 [00:00<?, ?it/s][A
  8%|▊         | 1/13 [00:00<00:08,  1.41it/s][A
 15%|█▌        | 2/13 [00:00<00:04,  2.70it/s][A
 23%|██▎       | 3/13 [00:00<00:02,  3.81it/s][A
 31%|███       | 4/13 [00:01<00:01,  4.73it/s][A
 38%|███▊      | 5/13 [00:01<00:01,  5.45it/s][A
 46%|████▌     | 6/13 [00:01<00:01,  6.00it/s][Ax.shape: torch.Size([8, 8, 3, 224, 224])
x.ndim: 5
x.shape: torch.Size([64, 3, 224, 224])
batch_size: 64
embeddings.shape: torch.Size([64, 197, 768])
input_ini - x shape before view: torch.Size([8, 8, 196, 768])
input_ini - x shape after first reshape: torch.Size([1568, 8, 768])
input_ini - x shape after cat: torch.Size([1568, 9, 768])
input_ini - x shape before final reshape: torch.Size([1568, 8, 768])
input_ini - x shape after final reshape: torch.Size([8, 196, 8, 768])
input_ini - x shape at end: torch.Size([8, 1568, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
cls_token.shape: torch.Size([8, 8, 1, 768])
patch_token.shape: torch.Size([8, 8, 196, 768])
x.shape: torch.Size([64, 197, 768])
x2.shape: torch.Size([64, 197, 768])
temporal.shape: torch.Size([64, 768])
cls_token.shape: torch.Size([64, 768])
### cls_token.shape: torch.Size([8, 768])
features.shape: torch.Size([8, 768])
pred.shape: torch.Size([8, 2])
label.shape: torch.Size([8])
pred.shape: torch.Size([8, 2])
x.shape: torch.Size([8, 8, 3, 224, 224])
x.ndim: 5
x.shape: torch.Size([64, 3, 224, 224])
batch_size: 64
embeddings.shape: torch.Size([64, 197, 768])
input_ini - x shape before view: torch.Size([8, 8, 196, 768])
input_ini - x shape after first reshape: torch.Size([1568, 8, 768])
input_ini - x shape after cat: torch.Size([1568, 9, 768])
input_ini - x shape before final reshape: torch.Size([1568, 8, 768])
input_ini - x shape after final reshape: torch.Size([8, 196, 8, 768])
input_ini - x shape at end: torch.Size([8, 1568, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
cls_token.shape: torch.Size([8, 8, 1, 768])
patch_token.shape: torch.Size([8, 8, 196, 768])
x.shape: torch.Size([64, 197, 768])
x2.shape: torch.Size([64, 197, 768])
temporal.shape: torch.Size([64, 768])
cls_token.shape: torch.Size([64, 768])
### cls_token.shape: torch.Size([8, 768])
features.shape: torch.Size([8, 768])
pred.shape: torch.Size([8, 2])
label.shape: torch.Size([8])
pred.shape: torch.Size([8, 2])
x.shape: torch.Size([8, 8, 3, 224, 224])
x.ndim: 5
x.shape: torch.Size([64, 3, 224, 224])
batch_size: 64
embeddings.shape: torch.Size([64, 197, 768])
input_ini - x shape before view: torch.Size([8, 8, 196, 768])
input_ini - x shape after first reshape: torch.Size([1568, 8, 768])
input_ini - x shape after cat: torch.Size([1568, 9, 768])
input_ini - x shape before final reshape: torch.Size([1568, 8, 768])
input_ini - x shape after final reshape: torch.Size([8, 196, 8, 768])
input_ini - x shape at end: torch.Size([8, 1568, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
cls_token.shape: torch.Size([8, 8, 1, 768])
patch_token.shape: torch.Size([8, 8, 196, 768])
x.shape: torch.Size([64, 197, 768])
x2.shape: torch.Size([64, 197, 768])
temporal.shape: torch.Size([64, 768])
cls_token.shape: torch.Size([64, 768])
### cls_token.shape: torch.Size([8, 768])
features.shape: torch.Size([8, 768])
pred.shape: torch.Size([8, 2])
label.shape: torch.Size([8])
pred.shape: torch.Size([8, 2])
x.shape: torch.Size([8, 8, 3, 224, 224])
x.ndim: 5
x.shape: torch.Size([64, 3, 224, 224])
batch_size: 64
embeddings.shape: torch.Size([64, 197, 768])
input_ini - x shape before view: torch.Size([8, 8, 196, 768])
input_ini - x shape after first reshape: torch.Size([1568, 8, 768])
input_ini - x shape after cat: torch.Size([1568, 9, 768])
input_ini - x shape before final reshape: torch.Size([1568, 8, 768])
input_ini - x shape after final reshape: torch.Size([8, 196, 8, 768])
input_ini - x shape at end: torch.Size([8, 1568, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
cls_token.shape: torch.Size([8, 8, 1, 768])
patch_token.shape: torch.Size([8, 8, 196, 768])
x.shape: torch.Size([64, 197, 768])
x2.shape: torch.Size([64, 197, 768])
temporal.shape: torch.Size([64, 768])
cls_token.shape: torch.Size([64, 768])
### cls_token.shape: torch.Size([8, 768])
features.shape: torch.Size([8, 768])
pred.shape: torch.Size([8, 2])
label.shape: torch.Size([8])
pred.shape: torch.Size([8, 2])
x.shape: torch.Size([8, 8, 3, 224, 224])
x.ndim: 5
x.shape: torch.Size([64, 3, 224, 224])
batch_size: 64
embeddings.shape: torch.Size([64, 197, 768])
input_ini - x shape before view: torch.Size([8, 8, 196, 768])
input_ini - x shape after first reshape: torch.Size([1568, 8, 768])
input_ini - x shape after cat: torch.Size([1568, 9, 768])
input_ini - x shape before final reshape: torch.Size([1568, 8, 768])
input_ini - x shape after final reshape: torch.Size([8, 196, 8, 768])
input_ini - x shape at end: torch.Size([8, 1568, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
cls_token.shape: torch.Size([8, 8, 1, 768])
patch_token.shape: torch.Size([8, 8, 196, 768])
x.shape: torch.Size([64, 197, 768])
x2.shape: torch.Size([64, 197, 768])
temporal.shape: torch.Size([64, 768])
cls_token.shape: torch.Size([64, 768])
### cls_token.shape: torch.Size([8, 768])
features.shape: torch.Size([8, 768])
pred.shape: torch.Size([8, 2])
label.shape: torch.Size([8])
pred.shape: torch.Size([8, 2])
x.shape: torch.Size([8, 8, 3, 224, 224])
x.ndim: 5
x.shape: torch.Size([64, 3, 224, 224])
batch_size: 64
embeddings.shape: torch.Size([64, 197, 768])
input_ini - x shape before view: torch.Size([8, 8, 196, 768])
input_ini - x shape after first reshape: torch.Size([1568, 8, 768])
input_ini - x shape after cat: torch.Size([1568, 9, 768])
input_ini - x shape before final reshape: torch.Size([1568, 8, 768])
input_ini - x shape after final reshape: torch.Size([8, 196, 8, 768])
input_ini - x shape at end: torch.Size([8, 1568, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
cls_token.shape: torch.Size([8, 8, 1, 768])
patch_token.shape: torch.Size([8, 8, 196, 768])
x.shape: torch.Size([64, 197, 768])
x2.shape: torch.Size([64, 197, 768])
temporal.shape: torch.Size([64, 768])
cls_token.shape: torch.Size([64, 768])
### cls_token.shape: torch.Size([8, 768])
features.shape: torch.Size([8, 768])
pred.shape: torch.Size([8, 2])
label.shape: torch.Size([8])
pred.shape: torch.Size([8, 2])
x.shape: torch.Size([8, 8, 3, 224, 224])
x.ndim: 5
x.shape: torch.Size([64, 3, 224, 224])
batch_size: 64
embeddings.shape: torch.Size([64, 197, 768])
input_ini - x shape before view: torch.Size([8, 8, 196, 768])
input_ini - x shape after first reshape: torch.Size([1568, 8, 768])
input_ini - x shape after cat: torch.Size([1568, 9, 768])
input_ini - x shape before final reshape: torch.Size([1568, 8, 768])

 54%|█████▍    | 7/13 [00:01<00:00,  6.41it/s][A
 62%|██████▏   | 8/13 [00:01<00:00,  6.71it/s][A
 69%|██████▉   | 9/13 [00:01<00:00,  6.93it/s][A
 77%|███████▋  | 10/13 [00:01<00:00,  7.08it/s][A
 85%|████████▍ | 11/13 [00:02<00:00,  7.19it/s][A
 92%|█████████▏| 12/13 [00:02<00:00,  7.27it/s][Ainput_ini - x shape after final reshape: torch.Size([8, 196, 8, 768])
input_ini - x shape at end: torch.Size([8, 1568, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
cls_token.shape: torch.Size([8, 8, 1, 768])
patch_token.shape: torch.Size([8, 8, 196, 768])
x.shape: torch.Size([64, 197, 768])
x2.shape: torch.Size([64, 197, 768])
temporal.shape: torch.Size([64, 768])
cls_token.shape: torch.Size([64, 768])
### cls_token.shape: torch.Size([8, 768])
features.shape: torch.Size([8, 768])
pred.shape: torch.Size([8, 2])
label.shape: torch.Size([8])
pred.shape: torch.Size([8, 2])
x.shape: torch.Size([8, 8, 3, 224, 224])
x.ndim: 5
x.shape: torch.Size([64, 3, 224, 224])
batch_size: 64
embeddings.shape: torch.Size([64, 197, 768])
input_ini - x shape before view: torch.Size([8, 8, 196, 768])
input_ini - x shape after first reshape: torch.Size([1568, 8, 768])
input_ini - x shape after cat: torch.Size([1568, 9, 768])
input_ini - x shape before final reshape: torch.Size([1568, 8, 768])
input_ini - x shape after final reshape: torch.Size([8, 196, 8, 768])
input_ini - x shape at end: torch.Size([8, 1568, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
cls_token.shape: torch.Size([8, 8, 1, 768])
patch_token.shape: torch.Size([8, 8, 196, 768])
x.shape: torch.Size([64, 197, 768])
x2.shape: torch.Size([64, 197, 768])
temporal.shape: torch.Size([64, 768])
cls_token.shape: torch.Size([64, 768])
### cls_token.shape: torch.Size([8, 768])
features.shape: torch.Size([8, 768])
pred.shape: torch.Size([8, 2])
label.shape: torch.Size([8])
pred.shape: torch.Size([8, 2])
x.shape: torch.Size([8, 8, 3, 224, 224])
x.ndim: 5
x.shape: torch.Size([64, 3, 224, 224])
batch_size: 64
embeddings.shape: torch.Size([64, 197, 768])
input_ini - x shape before view: torch.Size([8, 8, 196, 768])
input_ini - x shape after first reshape: torch.Size([1568, 8, 768])
input_ini - x shape after cat: torch.Size([1568, 9, 768])
input_ini - x shape before final reshape: torch.Size([1568, 8, 768])
input_ini - x shape after final reshape: torch.Size([8, 196, 8, 768])
input_ini - x shape at end: torch.Size([8, 1568, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
cls_token.shape: torch.Size([8, 8, 1, 768])
patch_token.shape: torch.Size([8, 8, 196, 768])
x.shape: torch.Size([64, 197, 768])
x2.shape: torch.Size([64, 197, 768])
temporal.shape: torch.Size([64, 768])
cls_token.shape: torch.Size([64, 768])
### cls_token.shape: torch.Size([8, 768])
features.shape: torch.Size([8, 768])
pred.shape: torch.Size([8, 2])
label.shape: torch.Size([8])
pred.shape: torch.Size([8, 2])
x.shape: torch.Size([8, 8, 3, 224, 224])
x.ndim: 5
x.shape: torch.Size([64, 3, 224, 224])
batch_size: 64
embeddings.shape: torch.Size([64, 197, 768])
input_ini - x shape before view: torch.Size([8, 8, 196, 768])
input_ini - x shape after first reshape: torch.Size([1568, 8, 768])
input_ini - x shape after cat: torch.Size([1568, 9, 768])
input_ini - x shape before final reshape: torch.Size([1568, 8, 768])
input_ini - x shape after final reshape: torch.Size([8, 196, 8, 768])
input_ini - x shape at end: torch.Size([8, 1568, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
cls_token.shape: torch.Size([8, 8, 1, 768])
patch_token.shape: torch.Size([8, 8, 196, 768])
x.shape: torch.Size([64, 197, 768])
x2.shape: torch.Size([64, 197, 768])
temporal.shape: torch.Size([64, 768])
cls_token.shape: torch.Size([64, 768])
### cls_token.shape: torch.Size([8, 768])
features.shape: torch.Size([8, 768])
pred.shape: torch.Size([8, 2])
label.shape: torch.Size([8])
pred.shape: torch.Size([8, 2])
x.shape: torch.Size([8, 8, 3, 224, 224])
x.ndim: 5
x.shape: torch.Size([64, 3, 224, 224])
batch_size: 64
embeddings.shape: torch.Size([64, 197, 768])
input_ini - x shape before view: torch.Size([8, 8, 196, 768])
input_ini - x shape after first reshape: torch.Size([1568, 8, 768])
input_ini - x shape after cat: torch.Size([1568, 9, 768])
input_ini - x shape before final reshape: torch.Size([1568, 8, 768])
input_ini - x shape after final reshape: torch.Size([8, 196, 8, 768])
input_ini - x shape at end: torch.Size([8, 1568, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
cls_token.shape: torch.Size([8, 8, 1, 768])
patch_token.shape: torch.Size([8, 8, 196, 768])
x.shape: torch.Size([64, 197, 768])
x2.shape: torch.Size([64, 197, 768])
temporal.shape: torch.Size([64, 768])
cls_token.shape: torch.Size([64, 768])
### cls_token.shape: torch.Size([8, 768])
features.shape: torch.Size([8, 768])
pred.shape: torch.Size([8, 2])
label.shape: torch.Size([8])
pred.shape: torch.Size([8, 2])
x.shape: torch.Size([8, 8, 3, 224, 224])
x.ndim: 5
x.shape: torch.Size([64, 3, 224, 224])
batch_size: 64
embeddings.shape: torch.Size([64, 197, 768])
input_ini - x shape before view: torch.Size([8, 8, 196, 768])
input_ini - x shape after first reshape: torch.Size([1568, 8, 768])
input_ini - x shape after cat: torch.Size([1568, 9, 768])
input_ini - x shape before final reshape: torch.Size([1568, 8, 768])
input_ini - x shape after final reshape: torch.Size([8, 196, 8, 768])
input_ini - x shape at end: torch.Size([8, 1568, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
cls_token.shape: torch.Size([8, 8, 1, 768])
patch_token.shape: torch.Size([8, 8, 196, 768])
x.shape: torch.Size([64, 197, 768])
x2.shape: torch.Size([64, 197, 768])
temporal.shape: torch.Size([64, 768])
cls_token.shape: torch.Size([64, 768])
### cls_token.shape: torch.Size([8, 768])
features.shape: torch.Size([8, 768])
pred.shape: torch.Size([8, 2])
label.shape: torch.Size([8])
pred.shape: torch.Size([8, 2])
x.shape: torch.Size([4, 8, 3, 224, 224])
x.ndim: 5
x.shape: torch.Size([32, 3, 224, 224])
batch_size: 32
embeddings.shape: torch.Size([32, 197, 768])
input_ini - x shape before view: torch.Size([4, 8, 196, 768])
input_ini - x shape after first reshape: torch.Size([784, 8, 768])
input_ini - x shape after cat: torch.Size([784, 9, 768])
input_ini - x shape before final reshape: torch.Size([784, 8, 768])
input_ini - x shape after final reshape: torch.Size([4, 196, 8, 768])
input_ini - x shape at end: torch.Size([4, 1568, 768])
x2.shape): torch.Size([4, 1569, 768])
(x1.shape): torch.Size([4, 1569, 768])
(x2.shape): torch.Size([4, 1569, 768])
x2.shape): torch.Size([4, 1569, 768])
(x1.shape): torch.Size([4, 1569, 768])
(x2.shape): torch.Size([4, 1569, 768])
x2.shape): torch.Size([4, 1569, 768])
(x1.shape): torch.Size([4, 1569, 768])
100%|██████████| 13/13 [00:02<00:00,  5.77it/s]
2025-05-30 10:57:17,099 - INFO - dataset: DFDC    step: 33    testing-loss, overall: 0.67724609375    
2025-05-30 10:57:17,100 - INFO - dataset: DFDC    step: 33    testing-metric, acc: 0.65    testing-metric, auc: 0.5043956043956045    testing-metric, eer: 0.5142857142857142    testing-metric, ap: 0.7075842845466331    testing-metric, video_auc: 0.5043956043956045    testing-metric, acc_real:0.7714285714285715; acc_fake:0.5846153846153846
2025-05-30 10:57:17,101 - INFO - dataset: avg    step: 33    testing-metric, acc: 0.65    testing-metric, auc: 0.5043956043956045    testing-metric, eer: 0.5142857142857142    testing-metric, ap: 0.7075842845466331    testing-metric, video_auc: 0.5043956043956045    
2025-05-30 10:57:17,101 - INFO - ===> Test Done!
 50%|█████     | 2/4 [00:05<00:05,  2.64s/it] 75%|███████▌  | 3/4 [00:05<00:01,  1.67s/it]2025-05-30 10:57:17,696 - INFO - ===> Test start!
2025-05-30 10:57:17,699 - INFO - data_dict saved to ./logs/training/clip_stan_2025-05-30-10-56-05/test/DFDC/data_dict_test.pickle
(x2.shape): torch.Size([4, 1569, 768])
cls_token.shape: torch.Size([4, 8, 1, 768])
patch_token.shape: torch.Size([4, 8, 196, 768])
x.shape: torch.Size([32, 197, 768])
x2.shape: torch.Size([32, 197, 768])
temporal.shape: torch.Size([32, 768])
cls_token.shape: torch.Size([32, 768])
### cls_token.shape: torch.Size([4, 768])
features.shape: torch.Size([4, 768])
pred.shape: torch.Size([4, 2])
label.shape: torch.Size([4])
pred.shape: torch.Size([4, 2])
len(y_pred): 100
len(y_true): 100
x.shape: torch.Size([32, 8, 3, 224, 224])
x.ndim: 5
x.shape: torch.Size([256, 3, 224, 224])
batch_size: 256
embeddings.shape: torch.Size([256, 197, 768])
input_ini - x shape before view: torch.Size([32, 8, 196, 768])
input_ini - x shape after first reshape: torch.Size([6272, 8, 768])
input_ini - x shape after cat: torch.Size([6272, 9, 768])
input_ini - x shape before final reshape: torch.Size([6272, 8, 768])
input_ini - x shape after final reshape: torch.Size([32, 196, 8, 768])
input_ini - x shape at end: torch.Size([32, 1568, 768])
x2.shape): torch.Size([32, 1569, 768])
(x1.shape): torch.Size([32, 1569, 768])
(x2.shape): torch.Size([32, 1569, 768])
x2.shape): torch.Size([32, 1569, 768])
(x1.shape): torch.Size([32, 1569, 768])
(x2.shape): torch.Size([32, 1569, 768])
x2.shape): torch.Size([32, 1569, 768])
(x1.shape): torch.Size([32, 1569, 768])
(x2.shape): torch.Size([32, 1569, 768])
cls_token.shape: torch.Size([32, 8, 1, 768])
patch_token.shape: torch.Size([32, 8, 196, 768])
x.shape: torch.Size([256, 197, 768])
x2.shape: torch.Size([256, 197, 768])
temporal.shape: torch.Size([256, 768])
cls_token.shape: torch.Size([256, 768])
### cls_token.shape: torch.Size([32, 768])
features.shape: torch.Size([32, 768])
pred.shape: torch.Size([32, 2])
label.shape: torch.Size([32])
pred.shape: torch.Size([32, 2])
x.shape: torch.Size([4, 8, 3, 224, 224])
x.ndim: 5
x.shape: torch.Size([32, 3, 224, 224])
batch_size: 32
embeddings.shape: torch.Size([32, 197, 768])
input_ini - x shape before view: torch.Size([4, 8, 196, 768])
input_ini - x shape after first reshape: torch.Size([784, 8, 768])
input_ini - x shape after cat: torch.Size([784, 9, 768])
input_ini - x shape before final reshape: torch.Size([784, 8, 768])
input_ini - x shape after final reshape: torch.Size([4, 196, 8, 768])
input_ini - x shape at end: torch.Size([4, 1568, 768])
x2.shape): torch.Size([4, 1569, 768])
(x1.shape): torch.Size([4, 1569, 768])
(x2.shape): torch.Size([4, 1569, 768])
x2.shape): torch.Size([4, 1569, 768])
(x1.shape): torch.Size([4, 1569, 768])
(x2.shape): torch.Size([4, 1569, 768])
x2.shape): torch.Size([4, 1569, 768])
(x1.shape): torch.Size([4, 1569, 768])
(x2.shape): torch.Size([4, 1569, 768])
cls_token.shape: torch.Size([4, 8, 1, 768])
patch_token.shape: torch.Size([4, 8, 196, 768])
x.shape: torch.Size([32, 197, 768])
x2.shape: torch.Size([32, 197, 768])
temporal.shape: torch.Size([32, 768])
cls_token.shape: torch.Size([32, 768])
### cls_token.shape: torch.Size([4, 768])
features.shape: torch.Size([4, 768])
pred.shape: torch.Size([4, 2])
label.shape: torch.Size([4])
pred.shape: torch.Size([4, 2])

  0%|          | 0/13 [00:00<?, ?it/s][A
  8%|▊         | 1/13 [00:00<00:08,  1.46it/s][A
 15%|█▌        | 2/13 [00:00<00:03,  2.77it/s][A
 23%|██▎       | 3/13 [00:00<00:02,  3.89it/s][A
 31%|███       | 4/13 [00:01<00:01,  4.80it/s][A
 38%|███▊      | 5/13 [00:01<00:01,  5.51it/s][A
 46%|████▌     | 6/13 [00:01<00:01,  6.04it/s][Ax.shape: torch.Size([8, 8, 3, 224, 224])
x.ndim: 5
x.shape: torch.Size([64, 3, 224, 224])
batch_size: 64
embeddings.shape: torch.Size([64, 197, 768])
input_ini - x shape before view: torch.Size([8, 8, 196, 768])
input_ini - x shape after first reshape: torch.Size([1568, 8, 768])
input_ini - x shape after cat: torch.Size([1568, 9, 768])
input_ini - x shape before final reshape: torch.Size([1568, 8, 768])
input_ini - x shape after final reshape: torch.Size([8, 196, 8, 768])
input_ini - x shape at end: torch.Size([8, 1568, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
cls_token.shape: torch.Size([8, 8, 1, 768])
patch_token.shape: torch.Size([8, 8, 196, 768])
x.shape: torch.Size([64, 197, 768])
x2.shape: torch.Size([64, 197, 768])
temporal.shape: torch.Size([64, 768])
cls_token.shape: torch.Size([64, 768])
### cls_token.shape: torch.Size([8, 768])
features.shape: torch.Size([8, 768])
pred.shape: torch.Size([8, 2])
label.shape: torch.Size([8])
pred.shape: torch.Size([8, 2])
x.shape: torch.Size([8, 8, 3, 224, 224])
x.ndim: 5
x.shape: torch.Size([64, 3, 224, 224])
batch_size: 64
embeddings.shape: torch.Size([64, 197, 768])
input_ini - x shape before view: torch.Size([8, 8, 196, 768])
input_ini - x shape after first reshape: torch.Size([1568, 8, 768])
input_ini - x shape after cat: torch.Size([1568, 9, 768])
input_ini - x shape before final reshape: torch.Size([1568, 8, 768])
input_ini - x shape after final reshape: torch.Size([8, 196, 8, 768])
input_ini - x shape at end: torch.Size([8, 1568, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
cls_token.shape: torch.Size([8, 8, 1, 768])
patch_token.shape: torch.Size([8, 8, 196, 768])
x.shape: torch.Size([64, 197, 768])
x2.shape: torch.Size([64, 197, 768])
temporal.shape: torch.Size([64, 768])
cls_token.shape: torch.Size([64, 768])
### cls_token.shape: torch.Size([8, 768])
features.shape: torch.Size([8, 768])
pred.shape: torch.Size([8, 2])
label.shape: torch.Size([8])
pred.shape: torch.Size([8, 2])
x.shape: torch.Size([8, 8, 3, 224, 224])
x.ndim: 5
x.shape: torch.Size([64, 3, 224, 224])
batch_size: 64
embeddings.shape: torch.Size([64, 197, 768])
input_ini - x shape before view: torch.Size([8, 8, 196, 768])
input_ini - x shape after first reshape: torch.Size([1568, 8, 768])
input_ini - x shape after cat: torch.Size([1568, 9, 768])
input_ini - x shape before final reshape: torch.Size([1568, 8, 768])
input_ini - x shape after final reshape: torch.Size([8, 196, 8, 768])
input_ini - x shape at end: torch.Size([8, 1568, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
cls_token.shape: torch.Size([8, 8, 1, 768])
patch_token.shape: torch.Size([8, 8, 196, 768])
x.shape: torch.Size([64, 197, 768])
x2.shape: torch.Size([64, 197, 768])
temporal.shape: torch.Size([64, 768])
cls_token.shape: torch.Size([64, 768])
### cls_token.shape: torch.Size([8, 768])
features.shape: torch.Size([8, 768])
pred.shape: torch.Size([8, 2])
label.shape: torch.Size([8])
pred.shape: torch.Size([8, 2])
x.shape: torch.Size([8, 8, 3, 224, 224])
x.ndim: 5
x.shape: torch.Size([64, 3, 224, 224])
batch_size: 64
embeddings.shape: torch.Size([64, 197, 768])
input_ini - x shape before view: torch.Size([8, 8, 196, 768])
input_ini - x shape after first reshape: torch.Size([1568, 8, 768])
input_ini - x shape after cat: torch.Size([1568, 9, 768])
input_ini - x shape before final reshape: torch.Size([1568, 8, 768])
input_ini - x shape after final reshape: torch.Size([8, 196, 8, 768])
input_ini - x shape at end: torch.Size([8, 1568, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
cls_token.shape: torch.Size([8, 8, 1, 768])
patch_token.shape: torch.Size([8, 8, 196, 768])
x.shape: torch.Size([64, 197, 768])
x2.shape: torch.Size([64, 197, 768])
temporal.shape: torch.Size([64, 768])
cls_token.shape: torch.Size([64, 768])
### cls_token.shape: torch.Size([8, 768])
features.shape: torch.Size([8, 768])
pred.shape: torch.Size([8, 2])
label.shape: torch.Size([8])
pred.shape: torch.Size([8, 2])
x.shape: torch.Size([8, 8, 3, 224, 224])
x.ndim: 5
x.shape: torch.Size([64, 3, 224, 224])
batch_size: 64
embeddings.shape: torch.Size([64, 197, 768])
input_ini - x shape before view: torch.Size([8, 8, 196, 768])
input_ini - x shape after first reshape: torch.Size([1568, 8, 768])
input_ini - x shape after cat: torch.Size([1568, 9, 768])
input_ini - x shape before final reshape: torch.Size([1568, 8, 768])
input_ini - x shape after final reshape: torch.Size([8, 196, 8, 768])
input_ini - x shape at end: torch.Size([8, 1568, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
cls_token.shape: torch.Size([8, 8, 1, 768])
patch_token.shape: torch.Size([8, 8, 196, 768])
x.shape: torch.Size([64, 197, 768])
x2.shape: torch.Size([64, 197, 768])
temporal.shape: torch.Size([64, 768])
cls_token.shape: torch.Size([64, 768])
### cls_token.shape: torch.Size([8, 768])
features.shape: torch.Size([8, 768])
pred.shape: torch.Size([8, 2])
label.shape: torch.Size([8])
pred.shape: torch.Size([8, 2])
x.shape: torch.Size([8, 8, 3, 224, 224])
x.ndim: 5
x.shape: torch.Size([64, 3, 224, 224])
batch_size: 64
embeddings.shape: torch.Size([64, 197, 768])
input_ini - x shape before view: torch.Size([8, 8, 196, 768])
input_ini - x shape after first reshape: torch.Size([1568, 8, 768])
input_ini - x shape after cat: torch.Size([1568, 9, 768])
input_ini - x shape before final reshape: torch.Size([1568, 8, 768])
input_ini - x shape after final reshape: torch.Size([8, 196, 8, 768])
input_ini - x shape at end: torch.Size([8, 1568, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
cls_token.shape: torch.Size([8, 8, 1, 768])
patch_token.shape: torch.Size([8, 8, 196, 768])
x.shape: torch.Size([64, 197, 768])
x2.shape: torch.Size([64, 197, 768])
temporal.shape: torch.Size([64, 768])
cls_token.shape: torch.Size([64, 768])
### cls_token.shape: torch.Size([8, 768])
features.shape: torch.Size([8, 768])
pred.shape: torch.Size([8, 2])
label.shape: torch.Size([8])
pred.shape: torch.Size([8, 2])
x.shape: torch.Size([8, 8, 3, 224, 224])
x.ndim: 5
x.shape: torch.Size([64, 3, 224, 224])
batch_size: 64
embeddings.shape: torch.Size([64, 197, 768])
input_ini - x shape before view: torch.Size([8, 8, 196, 768])
input_ini - x shape after first reshape: torch.Size([1568, 8, 768])
input_ini - x shape after cat: torch.Size([1568, 9, 768])
input_ini - x shape before final reshape: torch.Size([1568, 8, 768])

 54%|█████▍    | 7/13 [00:01<00:00,  6.44it/s][A
 62%|██████▏   | 8/13 [00:01<00:00,  6.74it/s][A
 69%|██████▉   | 9/13 [00:01<00:00,  6.94it/s][A
 77%|███████▋  | 10/13 [00:01<00:00,  7.09it/s][A
 85%|████████▍ | 11/13 [00:02<00:00,  7.20it/s][A
 92%|█████████▏| 12/13 [00:02<00:00,  7.28it/s][Ainput_ini - x shape after final reshape: torch.Size([8, 196, 8, 768])
input_ini - x shape at end: torch.Size([8, 1568, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
cls_token.shape: torch.Size([8, 8, 1, 768])
patch_token.shape: torch.Size([8, 8, 196, 768])
x.shape: torch.Size([64, 197, 768])
x2.shape: torch.Size([64, 197, 768])
temporal.shape: torch.Size([64, 768])
cls_token.shape: torch.Size([64, 768])
### cls_token.shape: torch.Size([8, 768])
features.shape: torch.Size([8, 768])
pred.shape: torch.Size([8, 2])
label.shape: torch.Size([8])
pred.shape: torch.Size([8, 2])
x.shape: torch.Size([8, 8, 3, 224, 224])
x.ndim: 5
x.shape: torch.Size([64, 3, 224, 224])
batch_size: 64
embeddings.shape: torch.Size([64, 197, 768])
input_ini - x shape before view: torch.Size([8, 8, 196, 768])
input_ini - x shape after first reshape: torch.Size([1568, 8, 768])
input_ini - x shape after cat: torch.Size([1568, 9, 768])
input_ini - x shape before final reshape: torch.Size([1568, 8, 768])
input_ini - x shape after final reshape: torch.Size([8, 196, 8, 768])
input_ini - x shape at end: torch.Size([8, 1568, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
cls_token.shape: torch.Size([8, 8, 1, 768])
patch_token.shape: torch.Size([8, 8, 196, 768])
x.shape: torch.Size([64, 197, 768])
x2.shape: torch.Size([64, 197, 768])
temporal.shape: torch.Size([64, 768])
cls_token.shape: torch.Size([64, 768])
### cls_token.shape: torch.Size([8, 768])
features.shape: torch.Size([8, 768])
pred.shape: torch.Size([8, 2])
label.shape: torch.Size([8])
pred.shape: torch.Size([8, 2])
x.shape: torch.Size([8, 8, 3, 224, 224])
x.ndim: 5
x.shape: torch.Size([64, 3, 224, 224])
batch_size: 64
embeddings.shape: torch.Size([64, 197, 768])
input_ini - x shape before view: torch.Size([8, 8, 196, 768])
input_ini - x shape after first reshape: torch.Size([1568, 8, 768])
input_ini - x shape after cat: torch.Size([1568, 9, 768])
input_ini - x shape before final reshape: torch.Size([1568, 8, 768])
input_ini - x shape after final reshape: torch.Size([8, 196, 8, 768])
input_ini - x shape at end: torch.Size([8, 1568, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
cls_token.shape: torch.Size([8, 8, 1, 768])
patch_token.shape: torch.Size([8, 8, 196, 768])
x.shape: torch.Size([64, 197, 768])
x2.shape: torch.Size([64, 197, 768])
temporal.shape: torch.Size([64, 768])
cls_token.shape: torch.Size([64, 768])
### cls_token.shape: torch.Size([8, 768])
features.shape: torch.Size([8, 768])
pred.shape: torch.Size([8, 2])
label.shape: torch.Size([8])
pred.shape: torch.Size([8, 2])
x.shape: torch.Size([8, 8, 3, 224, 224])
x.ndim: 5
x.shape: torch.Size([64, 3, 224, 224])
batch_size: 64
embeddings.shape: torch.Size([64, 197, 768])
input_ini - x shape before view: torch.Size([8, 8, 196, 768])
input_ini - x shape after first reshape: torch.Size([1568, 8, 768])
input_ini - x shape after cat: torch.Size([1568, 9, 768])
input_ini - x shape before final reshape: torch.Size([1568, 8, 768])
input_ini - x shape after final reshape: torch.Size([8, 196, 8, 768])
input_ini - x shape at end: torch.Size([8, 1568, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
cls_token.shape: torch.Size([8, 8, 1, 768])
patch_token.shape: torch.Size([8, 8, 196, 768])
x.shape: torch.Size([64, 197, 768])
x2.shape: torch.Size([64, 197, 768])
temporal.shape: torch.Size([64, 768])
cls_token.shape: torch.Size([64, 768])
### cls_token.shape: torch.Size([8, 768])
features.shape: torch.Size([8, 768])
pred.shape: torch.Size([8, 2])
label.shape: torch.Size([8])
pred.shape: torch.Size([8, 2])
x.shape: torch.Size([8, 8, 3, 224, 224])
x.ndim: 5
x.shape: torch.Size([64, 3, 224, 224])
batch_size: 64
embeddings.shape: torch.Size([64, 197, 768])
input_ini - x shape before view: torch.Size([8, 8, 196, 768])
input_ini - x shape after first reshape: torch.Size([1568, 8, 768])
input_ini - x shape after cat: torch.Size([1568, 9, 768])
input_ini - x shape before final reshape: torch.Size([1568, 8, 768])
input_ini - x shape after final reshape: torch.Size([8, 196, 8, 768])
input_ini - x shape at end: torch.Size([8, 1568, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
cls_token.shape: torch.Size([8, 8, 1, 768])
patch_token.shape: torch.Size([8, 8, 196, 768])
x.shape: torch.Size([64, 197, 768])
x2.shape: torch.Size([64, 197, 768])
temporal.shape: torch.Size([64, 768])
cls_token.shape: torch.Size([64, 768])
### cls_token.shape: torch.Size([8, 768])
features.shape: torch.Size([8, 768])
pred.shape: torch.Size([8, 2])
label.shape: torch.Size([8])
pred.shape: torch.Size([8, 2])
x.shape: torch.Size([8, 8, 3, 224, 224])
x.ndim: 5
x.shape: torch.Size([64, 3, 224, 224])
batch_size: 64
embeddings.shape: torch.Size([64, 197, 768])
input_ini - x shape before view: torch.Size([8, 8, 196, 768])
input_ini - x shape after first reshape: torch.Size([1568, 8, 768])
input_ini - x shape after cat: torch.Size([1568, 9, 768])
input_ini - x shape before final reshape: torch.Size([1568, 8, 768])
input_ini - x shape after final reshape: torch.Size([8, 196, 8, 768])
input_ini - x shape at end: torch.Size([8, 1568, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
cls_token.shape: torch.Size([8, 8, 1, 768])
patch_token.shape: torch.Size([8, 8, 196, 768])
x.shape: torch.Size([64, 197, 768])
x2.shape: torch.Size([64, 197, 768])
temporal.shape: torch.Size([64, 768])
cls_token.shape: torch.Size([64, 768])
### cls_token.shape: torch.Size([8, 768])
features.shape: torch.Size([8, 768])
pred.shape: torch.Size([8, 2])
label.shape: torch.Size([8])
pred.shape: torch.Size([8, 2])
x.shape: torch.Size([4, 8, 3, 224, 224])
x.ndim: 5
x.shape: torch.Size([32, 3, 224, 224])
batch_size: 32
embeddings.shape: torch.Size([32, 197, 768])
input_ini - x shape before view: torch.Size([4, 8, 196, 768])
input_ini - x shape after first reshape: torch.Size([784, 8, 768])
input_ini - x shape after cat: torch.Size([784, 9, 768])
input_ini - x shape before final reshape: torch.Size([784, 8, 768])
input_ini - x shape after final reshape: torch.Size([4, 196, 8, 768])
input_ini - x shape at end: torch.Size([4, 1568, 768])
x2.shape): torch.Size([4, 1569, 768])
(x1.shape): torch.Size([4, 1569, 768])
(x2.shape): torch.Size([4, 1569, 768])
x2.shape): torch.Size([4, 1569, 768])
(x1.shape): torch.Size([4, 1569, 768])
(x2.shape): torch.Size([4, 1569, 768])
x2.shape): torch.Size([4, 1569, 768])
(x1.shape): torch.Size([4, 1569, 768])
100%|██████████| 13/13 [00:02<00:00,  5.83it/s]
2025-05-30 10:57:19,939 - INFO - dataset: DFDC    step: 35    testing-loss, overall: 0.6767578125    
2025-05-30 10:57:19,940 - INFO - dataset: DFDC    step: 35    testing-metric, acc: 0.65    testing-metric, auc: 0.5030769230769231    testing-metric, eer: 0.5142857142857142    testing-metric, ap: 0.7075934364079098    testing-metric, video_auc: 0.5030769230769231    testing-metric, acc_real:0.7714285714285715; acc_fake:0.5846153846153846
2025-05-30 10:57:19,940 - INFO - dataset: avg    step: 35    testing-metric, acc: 0.65    testing-metric, auc: 0.5030769230769231    testing-metric, eer: 0.5142857142857142    testing-metric, ap: 0.7075934364079098    testing-metric, video_auc: 0.5030769230769231    
2025-05-30 10:57:19,940 - INFO - ===> Test Done!
100%|██████████| 4/4 [00:08<00:00,  1.93s/it]100%|██████████| 4/4 [00:08<00:00,  2.01s/it]
2025-05-30 10:57:19,946 - INFO - ===> Epoch[8] end with testing auc: 
================================ Each dataset best metric ================================ 
| DFDC:  auc=0.5090109890109891 | 
============================================================================================= 
================================== Average best metric ====================================== 
| avg auc: 0.5090109890109891 | 
| DFDC: 0.5090109890109891 | 
=============================================================================================!
2025-05-30 10:57:19,946 - INFO - ===> Epoch[9] start!
2025-05-30 10:57:19,947 - INFO - data_dict saved to ./logs/training/clip_stan_2025-05-30-10-56-05/train/FaceForensics++/data_dict_train.pickle
(x2.shape): torch.Size([4, 1569, 768])
cls_token.shape: torch.Size([4, 8, 1, 768])
patch_token.shape: torch.Size([4, 8, 196, 768])
x.shape: torch.Size([32, 197, 768])
x2.shape: torch.Size([32, 197, 768])
temporal.shape: torch.Size([32, 768])
cls_token.shape: torch.Size([32, 768])
### cls_token.shape: torch.Size([4, 768])
features.shape: torch.Size([4, 768])
pred.shape: torch.Size([4, 2])
label.shape: torch.Size([4])
pred.shape: torch.Size([4, 2])
len(y_pred): 100
len(y_true): 100
  0%|          | 0/4 [00:00<?, ?it/s]2025-05-30 10:57:22,133 - INFO - Iter: 36    training-loss, overall: 0.6772003173828125    
2025-05-30 10:57:22,133 - INFO - Iter: 36    training-metric, acc: 0.65625    training-metric, auc: 0.6103896103896104    training-metric, eer: 0.36363636363636365    training-metric, ap: 0.7532805175192394    
 25%|██▌       | 1/4 [00:02<00:06,  2.18s/it]2025-05-30 10:57:22,651 - INFO - ===> Test start!
2025-05-30 10:57:22,653 - INFO - data_dict saved to ./logs/training/clip_stan_2025-05-30-10-56-05/test/DFDC/data_dict_test.pickle
x.shape: torch.Size([32, 8, 3, 224, 224])
x.ndim: 5
x.shape: torch.Size([256, 3, 224, 224])
batch_size: 256
embeddings.shape: torch.Size([256, 197, 768])
input_ini - x shape before view: torch.Size([32, 8, 196, 768])
input_ini - x shape after first reshape: torch.Size([6272, 8, 768])
input_ini - x shape after cat: torch.Size([6272, 9, 768])
input_ini - x shape before final reshape: torch.Size([6272, 8, 768])
input_ini - x shape after final reshape: torch.Size([32, 196, 8, 768])
input_ini - x shape at end: torch.Size([32, 1568, 768])
x2.shape): torch.Size([32, 1569, 768])
(x1.shape): torch.Size([32, 1569, 768])
(x2.shape): torch.Size([32, 1569, 768])
x2.shape): torch.Size([32, 1569, 768])
(x1.shape): torch.Size([32, 1569, 768])
(x2.shape): torch.Size([32, 1569, 768])
x2.shape): torch.Size([32, 1569, 768])
(x1.shape): torch.Size([32, 1569, 768])
(x2.shape): torch.Size([32, 1569, 768])
cls_token.shape: torch.Size([32, 8, 1, 768])
patch_token.shape: torch.Size([32, 8, 196, 768])
x.shape: torch.Size([256, 197, 768])
x2.shape: torch.Size([256, 197, 768])
temporal.shape: torch.Size([256, 768])
cls_token.shape: torch.Size([256, 768])
### cls_token.shape: torch.Size([32, 768])
features.shape: torch.Size([32, 768])
pred.shape: torch.Size([32, 2])
label.shape: torch.Size([32])
pred.shape: torch.Size([32, 2])
x.shape: torch.Size([32, 8, 3, 224, 224])
x.ndim: 5
x.shape: torch.Size([256, 3, 224, 224])
batch_size: 256
embeddings.shape: torch.Size([256, 197, 768])
input_ini - x shape before view: torch.Size([32, 8, 196, 768])
input_ini - x shape after first reshape: torch.Size([6272, 8, 768])
input_ini - x shape after cat: torch.Size([6272, 9, 768])
input_ini - x shape before final reshape: torch.Size([6272, 8, 768])
input_ini - x shape after final reshape: torch.Size([32, 196, 8, 768])
input_ini - x shape at end: torch.Size([32, 1568, 768])
x2.shape): torch.Size([32, 1569, 768])
(x1.shape): torch.Size([32, 1569, 768])
(x2.shape): torch.Size([32, 1569, 768])
x2.shape): torch.Size([32, 1569, 768])
(x1.shape): torch.Size([32, 1569, 768])
(x2.shape): torch.Size([32, 1569, 768])
x2.shape): torch.Size([32, 1569, 768])
(x1.shape): torch.Size([32, 1569, 768])
(x2.shape): torch.Size([32, 1569, 768])
cls_token.shape: torch.Size([32, 8, 1, 768])
patch_token.shape: torch.Size([32, 8, 196, 768])
x.shape: torch.Size([256, 197, 768])
x2.shape: torch.Size([256, 197, 768])
temporal.shape: torch.Size([256, 768])
cls_token.shape: torch.Size([256, 768])
### cls_token.shape: torch.Size([32, 768])
features.shape: torch.Size([32, 768])
pred.shape: torch.Size([32, 2])
label.shape: torch.Size([32])
pred.shape: torch.Size([32, 2])

  0%|          | 0/13 [00:00<?, ?it/s][A
  8%|▊         | 1/13 [00:00<00:08,  1.41it/s][A
 15%|█▌        | 2/13 [00:00<00:04,  2.70it/s][A
 23%|██▎       | 3/13 [00:00<00:02,  3.81it/s][A
 31%|███       | 4/13 [00:01<00:01,  4.72it/s][A
 38%|███▊      | 5/13 [00:01<00:01,  5.44it/s][A
 46%|████▌     | 6/13 [00:01<00:01,  5.99it/s][Ax.shape: torch.Size([8, 8, 3, 224, 224])
x.ndim: 5
x.shape: torch.Size([64, 3, 224, 224])
batch_size: 64
embeddings.shape: torch.Size([64, 197, 768])
input_ini - x shape before view: torch.Size([8, 8, 196, 768])
input_ini - x shape after first reshape: torch.Size([1568, 8, 768])
input_ini - x shape after cat: torch.Size([1568, 9, 768])
input_ini - x shape before final reshape: torch.Size([1568, 8, 768])
input_ini - x shape after final reshape: torch.Size([8, 196, 8, 768])
input_ini - x shape at end: torch.Size([8, 1568, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
cls_token.shape: torch.Size([8, 8, 1, 768])
patch_token.shape: torch.Size([8, 8, 196, 768])
x.shape: torch.Size([64, 197, 768])
x2.shape: torch.Size([64, 197, 768])
temporal.shape: torch.Size([64, 768])
cls_token.shape: torch.Size([64, 768])
### cls_token.shape: torch.Size([8, 768])
features.shape: torch.Size([8, 768])
pred.shape: torch.Size([8, 2])
label.shape: torch.Size([8])
pred.shape: torch.Size([8, 2])
x.shape: torch.Size([8, 8, 3, 224, 224])
x.ndim: 5
x.shape: torch.Size([64, 3, 224, 224])
batch_size: 64
embeddings.shape: torch.Size([64, 197, 768])
input_ini - x shape before view: torch.Size([8, 8, 196, 768])
input_ini - x shape after first reshape: torch.Size([1568, 8, 768])
input_ini - x shape after cat: torch.Size([1568, 9, 768])
input_ini - x shape before final reshape: torch.Size([1568, 8, 768])
input_ini - x shape after final reshape: torch.Size([8, 196, 8, 768])
input_ini - x shape at end: torch.Size([8, 1568, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
cls_token.shape: torch.Size([8, 8, 1, 768])
patch_token.shape: torch.Size([8, 8, 196, 768])
x.shape: torch.Size([64, 197, 768])
x2.shape: torch.Size([64, 197, 768])
temporal.shape: torch.Size([64, 768])
cls_token.shape: torch.Size([64, 768])
### cls_token.shape: torch.Size([8, 768])
features.shape: torch.Size([8, 768])
pred.shape: torch.Size([8, 2])
label.shape: torch.Size([8])
pred.shape: torch.Size([8, 2])
x.shape: torch.Size([8, 8, 3, 224, 224])
x.ndim: 5
x.shape: torch.Size([64, 3, 224, 224])
batch_size: 64
embeddings.shape: torch.Size([64, 197, 768])
input_ini - x shape before view: torch.Size([8, 8, 196, 768])
input_ini - x shape after first reshape: torch.Size([1568, 8, 768])
input_ini - x shape after cat: torch.Size([1568, 9, 768])
input_ini - x shape before final reshape: torch.Size([1568, 8, 768])
input_ini - x shape after final reshape: torch.Size([8, 196, 8, 768])
input_ini - x shape at end: torch.Size([8, 1568, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
cls_token.shape: torch.Size([8, 8, 1, 768])
patch_token.shape: torch.Size([8, 8, 196, 768])
x.shape: torch.Size([64, 197, 768])
x2.shape: torch.Size([64, 197, 768])
temporal.shape: torch.Size([64, 768])
cls_token.shape: torch.Size([64, 768])
### cls_token.shape: torch.Size([8, 768])
features.shape: torch.Size([8, 768])
pred.shape: torch.Size([8, 2])
label.shape: torch.Size([8])
pred.shape: torch.Size([8, 2])
x.shape: torch.Size([8, 8, 3, 224, 224])
x.ndim: 5
x.shape: torch.Size([64, 3, 224, 224])
batch_size: 64
embeddings.shape: torch.Size([64, 197, 768])
input_ini - x shape before view: torch.Size([8, 8, 196, 768])
input_ini - x shape after first reshape: torch.Size([1568, 8, 768])
input_ini - x shape after cat: torch.Size([1568, 9, 768])
input_ini - x shape before final reshape: torch.Size([1568, 8, 768])
input_ini - x shape after final reshape: torch.Size([8, 196, 8, 768])
input_ini - x shape at end: torch.Size([8, 1568, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
cls_token.shape: torch.Size([8, 8, 1, 768])
patch_token.shape: torch.Size([8, 8, 196, 768])
x.shape: torch.Size([64, 197, 768])
x2.shape: torch.Size([64, 197, 768])
temporal.shape: torch.Size([64, 768])
cls_token.shape: torch.Size([64, 768])
### cls_token.shape: torch.Size([8, 768])
features.shape: torch.Size([8, 768])
pred.shape: torch.Size([8, 2])
label.shape: torch.Size([8])
pred.shape: torch.Size([8, 2])
x.shape: torch.Size([8, 8, 3, 224, 224])
x.ndim: 5
x.shape: torch.Size([64, 3, 224, 224])
batch_size: 64
embeddings.shape: torch.Size([64, 197, 768])
input_ini - x shape before view: torch.Size([8, 8, 196, 768])
input_ini - x shape after first reshape: torch.Size([1568, 8, 768])
input_ini - x shape after cat: torch.Size([1568, 9, 768])
input_ini - x shape before final reshape: torch.Size([1568, 8, 768])
input_ini - x shape after final reshape: torch.Size([8, 196, 8, 768])
input_ini - x shape at end: torch.Size([8, 1568, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
cls_token.shape: torch.Size([8, 8, 1, 768])
patch_token.shape: torch.Size([8, 8, 196, 768])
x.shape: torch.Size([64, 197, 768])
x2.shape: torch.Size([64, 197, 768])
temporal.shape: torch.Size([64, 768])
cls_token.shape: torch.Size([64, 768])
### cls_token.shape: torch.Size([8, 768])
features.shape: torch.Size([8, 768])
pred.shape: torch.Size([8, 2])
label.shape: torch.Size([8])
pred.shape: torch.Size([8, 2])
x.shape: torch.Size([8, 8, 3, 224, 224])
x.ndim: 5
x.shape: torch.Size([64, 3, 224, 224])
batch_size: 64
embeddings.shape: torch.Size([64, 197, 768])
input_ini - x shape before view: torch.Size([8, 8, 196, 768])
input_ini - x shape after first reshape: torch.Size([1568, 8, 768])
input_ini - x shape after cat: torch.Size([1568, 9, 768])
input_ini - x shape before final reshape: torch.Size([1568, 8, 768])
input_ini - x shape after final reshape: torch.Size([8, 196, 8, 768])
input_ini - x shape at end: torch.Size([8, 1568, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
cls_token.shape: torch.Size([8, 8, 1, 768])
patch_token.shape: torch.Size([8, 8, 196, 768])
x.shape: torch.Size([64, 197, 768])
x2.shape: torch.Size([64, 197, 768])
temporal.shape: torch.Size([64, 768])
cls_token.shape: torch.Size([64, 768])
### cls_token.shape: torch.Size([8, 768])
features.shape: torch.Size([8, 768])
pred.shape: torch.Size([8, 2])
label.shape: torch.Size([8])
pred.shape: torch.Size([8, 2])
x.shape: torch.Size([8, 8, 3, 224, 224])
x.ndim: 5
x.shape: torch.Size([64, 3, 224, 224])
batch_size: 64
embeddings.shape: torch.Size([64, 197, 768])
input_ini - x shape before view: torch.Size([8, 8, 196, 768])
input_ini - x shape after first reshape: torch.Size([1568, 8, 768])
input_ini - x shape after cat: torch.Size([1568, 9, 768])
input_ini - x shape before final reshape: torch.Size([1568, 8, 768])

 54%|█████▍    | 7/13 [00:01<00:00,  6.41it/s][A
 62%|██████▏   | 8/13 [00:01<00:00,  6.70it/s][A
 69%|██████▉   | 9/13 [00:01<00:00,  6.92it/s][A
 77%|███████▋  | 10/13 [00:01<00:00,  7.08it/s][A
 85%|████████▍ | 11/13 [00:02<00:00,  7.18it/s][A
 92%|█████████▏| 12/13 [00:02<00:00,  7.26it/s][Ainput_ini - x shape after final reshape: torch.Size([8, 196, 8, 768])
input_ini - x shape at end: torch.Size([8, 1568, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
cls_token.shape: torch.Size([8, 8, 1, 768])
patch_token.shape: torch.Size([8, 8, 196, 768])
x.shape: torch.Size([64, 197, 768])
x2.shape: torch.Size([64, 197, 768])
temporal.shape: torch.Size([64, 768])
cls_token.shape: torch.Size([64, 768])
### cls_token.shape: torch.Size([8, 768])
features.shape: torch.Size([8, 768])
pred.shape: torch.Size([8, 2])
label.shape: torch.Size([8])
pred.shape: torch.Size([8, 2])
x.shape: torch.Size([8, 8, 3, 224, 224])
x.ndim: 5
x.shape: torch.Size([64, 3, 224, 224])
batch_size: 64
embeddings.shape: torch.Size([64, 197, 768])
input_ini - x shape before view: torch.Size([8, 8, 196, 768])
input_ini - x shape after first reshape: torch.Size([1568, 8, 768])
input_ini - x shape after cat: torch.Size([1568, 9, 768])
input_ini - x shape before final reshape: torch.Size([1568, 8, 768])
input_ini - x shape after final reshape: torch.Size([8, 196, 8, 768])
input_ini - x shape at end: torch.Size([8, 1568, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
cls_token.shape: torch.Size([8, 8, 1, 768])
patch_token.shape: torch.Size([8, 8, 196, 768])
x.shape: torch.Size([64, 197, 768])
x2.shape: torch.Size([64, 197, 768])
temporal.shape: torch.Size([64, 768])
cls_token.shape: torch.Size([64, 768])
### cls_token.shape: torch.Size([8, 768])
features.shape: torch.Size([8, 768])
pred.shape: torch.Size([8, 2])
label.shape: torch.Size([8])
pred.shape: torch.Size([8, 2])
x.shape: torch.Size([8, 8, 3, 224, 224])
x.ndim: 5
x.shape: torch.Size([64, 3, 224, 224])
batch_size: 64
embeddings.shape: torch.Size([64, 197, 768])
input_ini - x shape before view: torch.Size([8, 8, 196, 768])
input_ini - x shape after first reshape: torch.Size([1568, 8, 768])
input_ini - x shape after cat: torch.Size([1568, 9, 768])
input_ini - x shape before final reshape: torch.Size([1568, 8, 768])
input_ini - x shape after final reshape: torch.Size([8, 196, 8, 768])
input_ini - x shape at end: torch.Size([8, 1568, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
cls_token.shape: torch.Size([8, 8, 1, 768])
patch_token.shape: torch.Size([8, 8, 196, 768])
x.shape: torch.Size([64, 197, 768])
x2.shape: torch.Size([64, 197, 768])
temporal.shape: torch.Size([64, 768])
cls_token.shape: torch.Size([64, 768])
### cls_token.shape: torch.Size([8, 768])
features.shape: torch.Size([8, 768])
pred.shape: torch.Size([8, 2])
label.shape: torch.Size([8])
pred.shape: torch.Size([8, 2])
x.shape: torch.Size([8, 8, 3, 224, 224])
x.ndim: 5
x.shape: torch.Size([64, 3, 224, 224])
batch_size: 64
embeddings.shape: torch.Size([64, 197, 768])
input_ini - x shape before view: torch.Size([8, 8, 196, 768])
input_ini - x shape after first reshape: torch.Size([1568, 8, 768])
input_ini - x shape after cat: torch.Size([1568, 9, 768])
input_ini - x shape before final reshape: torch.Size([1568, 8, 768])
input_ini - x shape after final reshape: torch.Size([8, 196, 8, 768])
input_ini - x shape at end: torch.Size([8, 1568, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
cls_token.shape: torch.Size([8, 8, 1, 768])
patch_token.shape: torch.Size([8, 8, 196, 768])
x.shape: torch.Size([64, 197, 768])
x2.shape: torch.Size([64, 197, 768])
temporal.shape: torch.Size([64, 768])
cls_token.shape: torch.Size([64, 768])
### cls_token.shape: torch.Size([8, 768])
features.shape: torch.Size([8, 768])
pred.shape: torch.Size([8, 2])
label.shape: torch.Size([8])
pred.shape: torch.Size([8, 2])
x.shape: torch.Size([8, 8, 3, 224, 224])
x.ndim: 5
x.shape: torch.Size([64, 3, 224, 224])
batch_size: 64
embeddings.shape: torch.Size([64, 197, 768])
input_ini - x shape before view: torch.Size([8, 8, 196, 768])
input_ini - x shape after first reshape: torch.Size([1568, 8, 768])
input_ini - x shape after cat: torch.Size([1568, 9, 768])
input_ini - x shape before final reshape: torch.Size([1568, 8, 768])
input_ini - x shape after final reshape: torch.Size([8, 196, 8, 768])
input_ini - x shape at end: torch.Size([8, 1568, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
cls_token.shape: torch.Size([8, 8, 1, 768])
patch_token.shape: torch.Size([8, 8, 196, 768])
x.shape: torch.Size([64, 197, 768])
x2.shape: torch.Size([64, 197, 768])
temporal.shape: torch.Size([64, 768])
cls_token.shape: torch.Size([64, 768])
### cls_token.shape: torch.Size([8, 768])
features.shape: torch.Size([8, 768])
pred.shape: torch.Size([8, 2])
label.shape: torch.Size([8])
pred.shape: torch.Size([8, 2])
x.shape: torch.Size([8, 8, 3, 224, 224])
x.ndim: 5
x.shape: torch.Size([64, 3, 224, 224])
batch_size: 64
embeddings.shape: torch.Size([64, 197, 768])
input_ini - x shape before view: torch.Size([8, 8, 196, 768])
input_ini - x shape after first reshape: torch.Size([1568, 8, 768])
input_ini - x shape after cat: torch.Size([1568, 9, 768])
input_ini - x shape before final reshape: torch.Size([1568, 8, 768])
input_ini - x shape after final reshape: torch.Size([8, 196, 8, 768])
input_ini - x shape at end: torch.Size([8, 1568, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
cls_token.shape: torch.Size([8, 8, 1, 768])
patch_token.shape: torch.Size([8, 8, 196, 768])
x.shape: torch.Size([64, 197, 768])
x2.shape: torch.Size([64, 197, 768])
temporal.shape: torch.Size([64, 768])
cls_token.shape: torch.Size([64, 768])
### cls_token.shape: torch.Size([8, 768])
features.shape: torch.Size([8, 768])
pred.shape: torch.Size([8, 2])
label.shape: torch.Size([8])
pred.shape: torch.Size([8, 2])
x.shape: torch.Size([4, 8, 3, 224, 224])
x.ndim: 5
x.shape: torch.Size([32, 3, 224, 224])
batch_size: 32
embeddings.shape: torch.Size([32, 197, 768])
input_ini - x shape before view: torch.Size([4, 8, 196, 768])
input_ini - x shape after first reshape: torch.Size([784, 8, 768])
input_ini - x shape after cat: torch.Size([784, 9, 768])
input_ini - x shape before final reshape: torch.Size([784, 8, 768])
input_ini - x shape after final reshape: torch.Size([4, 196, 8, 768])
input_ini - x shape at end: torch.Size([4, 1568, 768])
x2.shape): torch.Size([4, 1569, 768])
(x1.shape): torch.Size([4, 1569, 768])
(x2.shape): torch.Size([4, 1569, 768])
x2.shape): torch.Size([4, 1569, 768])
(x1.shape): torch.Size([4, 1569, 768])
(x2.shape): torch.Size([4, 1569, 768])
x2.shape): torch.Size([4, 1569, 768])
(x1.shape): torch.Size([4, 1569, 768])
100%|██████████| 13/13 [00:02<00:00,  5.77it/s]
2025-05-30 10:57:24,918 - INFO - dataset: DFDC    step: 37    testing-loss, overall: 0.67626953125    
2025-05-30 10:57:24,920 - INFO - dataset: DFDC    step: 37    testing-metric, acc: 0.65    testing-metric, auc: 0.5026373626373627    testing-metric, eer: 0.5142857142857142    testing-metric, ap: 0.7075183829937839    testing-metric, video_auc: 0.5026373626373627    testing-metric, acc_real:0.7714285714285715; acc_fake:0.5846153846153846
2025-05-30 10:57:24,920 - INFO - dataset: avg    step: 37    testing-metric, acc: 0.65    testing-metric, auc: 0.5026373626373627    testing-metric, eer: 0.5142857142857142    testing-metric, ap: 0.7075183829937839    testing-metric, video_auc: 0.5026373626373627    
2025-05-30 10:57:24,920 - INFO - ===> Test Done!
 50%|█████     | 2/4 [00:04<00:05,  2.54s/it] 75%|███████▌  | 3/4 [00:05<00:01,  1.62s/it]2025-05-30 10:57:25,516 - INFO - ===> Test start!
2025-05-30 10:57:25,518 - INFO - data_dict saved to ./logs/training/clip_stan_2025-05-30-10-56-05/test/DFDC/data_dict_test.pickle
(x2.shape): torch.Size([4, 1569, 768])
cls_token.shape: torch.Size([4, 8, 1, 768])
patch_token.shape: torch.Size([4, 8, 196, 768])
x.shape: torch.Size([32, 197, 768])
x2.shape: torch.Size([32, 197, 768])
temporal.shape: torch.Size([32, 768])
cls_token.shape: torch.Size([32, 768])
### cls_token.shape: torch.Size([4, 768])
features.shape: torch.Size([4, 768])
pred.shape: torch.Size([4, 2])
label.shape: torch.Size([4])
pred.shape: torch.Size([4, 2])
len(y_pred): 100
len(y_true): 100
x.shape: torch.Size([32, 8, 3, 224, 224])
x.ndim: 5
x.shape: torch.Size([256, 3, 224, 224])
batch_size: 256
embeddings.shape: torch.Size([256, 197, 768])
input_ini - x shape before view: torch.Size([32, 8, 196, 768])
input_ini - x shape after first reshape: torch.Size([6272, 8, 768])
input_ini - x shape after cat: torch.Size([6272, 9, 768])
input_ini - x shape before final reshape: torch.Size([6272, 8, 768])
input_ini - x shape after final reshape: torch.Size([32, 196, 8, 768])
input_ini - x shape at end: torch.Size([32, 1568, 768])
x2.shape): torch.Size([32, 1569, 768])
(x1.shape): torch.Size([32, 1569, 768])
(x2.shape): torch.Size([32, 1569, 768])
x2.shape): torch.Size([32, 1569, 768])
(x1.shape): torch.Size([32, 1569, 768])
(x2.shape): torch.Size([32, 1569, 768])
x2.shape): torch.Size([32, 1569, 768])
(x1.shape): torch.Size([32, 1569, 768])
(x2.shape): torch.Size([32, 1569, 768])
cls_token.shape: torch.Size([32, 8, 1, 768])
patch_token.shape: torch.Size([32, 8, 196, 768])
x.shape: torch.Size([256, 197, 768])
x2.shape: torch.Size([256, 197, 768])
temporal.shape: torch.Size([256, 768])
cls_token.shape: torch.Size([256, 768])
### cls_token.shape: torch.Size([32, 768])
features.shape: torch.Size([32, 768])
pred.shape: torch.Size([32, 2])
label.shape: torch.Size([32])
pred.shape: torch.Size([32, 2])
x.shape: torch.Size([4, 8, 3, 224, 224])
x.ndim: 5
x.shape: torch.Size([32, 3, 224, 224])
batch_size: 32
embeddings.shape: torch.Size([32, 197, 768])
input_ini - x shape before view: torch.Size([4, 8, 196, 768])
input_ini - x shape after first reshape: torch.Size([784, 8, 768])
input_ini - x shape after cat: torch.Size([784, 9, 768])
input_ini - x shape before final reshape: torch.Size([784, 8, 768])
input_ini - x shape after final reshape: torch.Size([4, 196, 8, 768])
input_ini - x shape at end: torch.Size([4, 1568, 768])
x2.shape): torch.Size([4, 1569, 768])
(x1.shape): torch.Size([4, 1569, 768])
(x2.shape): torch.Size([4, 1569, 768])
x2.shape): torch.Size([4, 1569, 768])
(x1.shape): torch.Size([4, 1569, 768])
(x2.shape): torch.Size([4, 1569, 768])
x2.shape): torch.Size([4, 1569, 768])
(x1.shape): torch.Size([4, 1569, 768])
(x2.shape): torch.Size([4, 1569, 768])
cls_token.shape: torch.Size([4, 8, 1, 768])
patch_token.shape: torch.Size([4, 8, 196, 768])
x.shape: torch.Size([32, 197, 768])
x2.shape: torch.Size([32, 197, 768])
temporal.shape: torch.Size([32, 768])
cls_token.shape: torch.Size([32, 768])
### cls_token.shape: torch.Size([4, 768])
features.shape: torch.Size([4, 768])
pred.shape: torch.Size([4, 2])
label.shape: torch.Size([4])
pred.shape: torch.Size([4, 2])

  0%|          | 0/13 [00:00<?, ?it/s][A
  8%|▊         | 1/13 [00:00<00:07,  1.69it/s][A
 15%|█▌        | 2/13 [00:00<00:03,  3.10it/s][A
 23%|██▎       | 3/13 [00:00<00:02,  4.23it/s][A
 31%|███       | 4/13 [00:00<00:01,  5.09it/s][A
 38%|███▊      | 5/13 [00:01<00:01,  5.75it/s][A
 46%|████▌     | 6/13 [00:01<00:01,  6.22it/s][Ax.shape: torch.Size([8, 8, 3, 224, 224])
x.ndim: 5
x.shape: torch.Size([64, 3, 224, 224])
batch_size: 64
embeddings.shape: torch.Size([64, 197, 768])
input_ini - x shape before view: torch.Size([8, 8, 196, 768])
input_ini - x shape after first reshape: torch.Size([1568, 8, 768])
input_ini - x shape after cat: torch.Size([1568, 9, 768])
input_ini - x shape before final reshape: torch.Size([1568, 8, 768])
input_ini - x shape after final reshape: torch.Size([8, 196, 8, 768])
input_ini - x shape at end: torch.Size([8, 1568, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
cls_token.shape: torch.Size([8, 8, 1, 768])
patch_token.shape: torch.Size([8, 8, 196, 768])
x.shape: torch.Size([64, 197, 768])
x2.shape: torch.Size([64, 197, 768])
temporal.shape: torch.Size([64, 768])
cls_token.shape: torch.Size([64, 768])
### cls_token.shape: torch.Size([8, 768])
features.shape: torch.Size([8, 768])
pred.shape: torch.Size([8, 2])
label.shape: torch.Size([8])
pred.shape: torch.Size([8, 2])
x.shape: torch.Size([8, 8, 3, 224, 224])
x.ndim: 5
x.shape: torch.Size([64, 3, 224, 224])
batch_size: 64
embeddings.shape: torch.Size([64, 197, 768])
input_ini - x shape before view: torch.Size([8, 8, 196, 768])
input_ini - x shape after first reshape: torch.Size([1568, 8, 768])
input_ini - x shape after cat: torch.Size([1568, 9, 768])
input_ini - x shape before final reshape: torch.Size([1568, 8, 768])
input_ini - x shape after final reshape: torch.Size([8, 196, 8, 768])
input_ini - x shape at end: torch.Size([8, 1568, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
cls_token.shape: torch.Size([8, 8, 1, 768])
patch_token.shape: torch.Size([8, 8, 196, 768])
x.shape: torch.Size([64, 197, 768])
x2.shape: torch.Size([64, 197, 768])
temporal.shape: torch.Size([64, 768])
cls_token.shape: torch.Size([64, 768])
### cls_token.shape: torch.Size([8, 768])
features.shape: torch.Size([8, 768])
pred.shape: torch.Size([8, 2])
label.shape: torch.Size([8])
pred.shape: torch.Size([8, 2])
x.shape: torch.Size([8, 8, 3, 224, 224])
x.ndim: 5
x.shape: torch.Size([64, 3, 224, 224])
batch_size: 64
embeddings.shape: torch.Size([64, 197, 768])
input_ini - x shape before view: torch.Size([8, 8, 196, 768])
input_ini - x shape after first reshape: torch.Size([1568, 8, 768])
input_ini - x shape after cat: torch.Size([1568, 9, 768])
input_ini - x shape before final reshape: torch.Size([1568, 8, 768])
input_ini - x shape after final reshape: torch.Size([8, 196, 8, 768])
input_ini - x shape at end: torch.Size([8, 1568, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
cls_token.shape: torch.Size([8, 8, 1, 768])
patch_token.shape: torch.Size([8, 8, 196, 768])
x.shape: torch.Size([64, 197, 768])
x2.shape: torch.Size([64, 197, 768])
temporal.shape: torch.Size([64, 768])
cls_token.shape: torch.Size([64, 768])
### cls_token.shape: torch.Size([8, 768])
features.shape: torch.Size([8, 768])
pred.shape: torch.Size([8, 2])
label.shape: torch.Size([8])
pred.shape: torch.Size([8, 2])
x.shape: torch.Size([8, 8, 3, 224, 224])
x.ndim: 5
x.shape: torch.Size([64, 3, 224, 224])
batch_size: 64
embeddings.shape: torch.Size([64, 197, 768])
input_ini - x shape before view: torch.Size([8, 8, 196, 768])
input_ini - x shape after first reshape: torch.Size([1568, 8, 768])
input_ini - x shape after cat: torch.Size([1568, 9, 768])
input_ini - x shape before final reshape: torch.Size([1568, 8, 768])
input_ini - x shape after final reshape: torch.Size([8, 196, 8, 768])
input_ini - x shape at end: torch.Size([8, 1568, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
cls_token.shape: torch.Size([8, 8, 1, 768])
patch_token.shape: torch.Size([8, 8, 196, 768])
x.shape: torch.Size([64, 197, 768])
x2.shape: torch.Size([64, 197, 768])
temporal.shape: torch.Size([64, 768])
cls_token.shape: torch.Size([64, 768])
### cls_token.shape: torch.Size([8, 768])
features.shape: torch.Size([8, 768])
pred.shape: torch.Size([8, 2])
label.shape: torch.Size([8])
pred.shape: torch.Size([8, 2])
x.shape: torch.Size([8, 8, 3, 224, 224])
x.ndim: 5
x.shape: torch.Size([64, 3, 224, 224])
batch_size: 64
embeddings.shape: torch.Size([64, 197, 768])
input_ini - x shape before view: torch.Size([8, 8, 196, 768])
input_ini - x shape after first reshape: torch.Size([1568, 8, 768])
input_ini - x shape after cat: torch.Size([1568, 9, 768])
input_ini - x shape before final reshape: torch.Size([1568, 8, 768])
input_ini - x shape after final reshape: torch.Size([8, 196, 8, 768])
input_ini - x shape at end: torch.Size([8, 1568, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
cls_token.shape: torch.Size([8, 8, 1, 768])
patch_token.shape: torch.Size([8, 8, 196, 768])
x.shape: torch.Size([64, 197, 768])
x2.shape: torch.Size([64, 197, 768])
temporal.shape: torch.Size([64, 768])
cls_token.shape: torch.Size([64, 768])
### cls_token.shape: torch.Size([8, 768])
features.shape: torch.Size([8, 768])
pred.shape: torch.Size([8, 2])
label.shape: torch.Size([8])
pred.shape: torch.Size([8, 2])
x.shape: torch.Size([8, 8, 3, 224, 224])
x.ndim: 5
x.shape: torch.Size([64, 3, 224, 224])
batch_size: 64
embeddings.shape: torch.Size([64, 197, 768])
input_ini - x shape before view: torch.Size([8, 8, 196, 768])
input_ini - x shape after first reshape: torch.Size([1568, 8, 768])
input_ini - x shape after cat: torch.Size([1568, 9, 768])
input_ini - x shape before final reshape: torch.Size([1568, 8, 768])
input_ini - x shape after final reshape: torch.Size([8, 196, 8, 768])
input_ini - x shape at end: torch.Size([8, 1568, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
cls_token.shape: torch.Size([8, 8, 1, 768])
patch_token.shape: torch.Size([8, 8, 196, 768])
x.shape: torch.Size([64, 197, 768])
x2.shape: torch.Size([64, 197, 768])
temporal.shape: torch.Size([64, 768])
cls_token.shape: torch.Size([64, 768])
### cls_token.shape: torch.Size([8, 768])
features.shape: torch.Size([8, 768])
pred.shape: torch.Size([8, 2])
label.shape: torch.Size([8])
pred.shape: torch.Size([8, 2])
x.shape: torch.Size([8, 8, 3, 224, 224])
x.ndim: 5
x.shape: torch.Size([64, 3, 224, 224])
batch_size: 64
embeddings.shape: torch.Size([64, 197, 768])
input_ini - x shape before view: torch.Size([8, 8, 196, 768])
input_ini - x shape after first reshape: torch.Size([1568, 8, 768])
input_ini - x shape after cat: torch.Size([1568, 9, 768])
input_ini - x shape before final reshape: torch.Size([1568, 8, 768])

 54%|█████▍    | 7/13 [00:01<00:00,  6.57it/s][A
 62%|██████▏   | 8/13 [00:01<00:00,  6.82it/s][A
 69%|██████▉   | 9/13 [00:01<00:00,  7.00it/s][A
 77%|███████▋  | 10/13 [00:01<00:00,  7.13it/s][A
 85%|████████▍ | 11/13 [00:01<00:00,  7.22it/s][A
 92%|█████████▏| 12/13 [00:02<00:00,  7.28it/s][Ainput_ini - x shape after final reshape: torch.Size([8, 196, 8, 768])
input_ini - x shape at end: torch.Size([8, 1568, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
cls_token.shape: torch.Size([8, 8, 1, 768])
patch_token.shape: torch.Size([8, 8, 196, 768])
x.shape: torch.Size([64, 197, 768])
x2.shape: torch.Size([64, 197, 768])
temporal.shape: torch.Size([64, 768])
cls_token.shape: torch.Size([64, 768])
### cls_token.shape: torch.Size([8, 768])
features.shape: torch.Size([8, 768])
pred.shape: torch.Size([8, 2])
label.shape: torch.Size([8])
pred.shape: torch.Size([8, 2])
x.shape: torch.Size([8, 8, 3, 224, 224])
x.ndim: 5
x.shape: torch.Size([64, 3, 224, 224])
batch_size: 64
embeddings.shape: torch.Size([64, 197, 768])
input_ini - x shape before view: torch.Size([8, 8, 196, 768])
input_ini - x shape after first reshape: torch.Size([1568, 8, 768])
input_ini - x shape after cat: torch.Size([1568, 9, 768])
input_ini - x shape before final reshape: torch.Size([1568, 8, 768])
input_ini - x shape after final reshape: torch.Size([8, 196, 8, 768])
input_ini - x shape at end: torch.Size([8, 1568, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
cls_token.shape: torch.Size([8, 8, 1, 768])
patch_token.shape: torch.Size([8, 8, 196, 768])
x.shape: torch.Size([64, 197, 768])
x2.shape: torch.Size([64, 197, 768])
temporal.shape: torch.Size([64, 768])
cls_token.shape: torch.Size([64, 768])
### cls_token.shape: torch.Size([8, 768])
features.shape: torch.Size([8, 768])
pred.shape: torch.Size([8, 2])
label.shape: torch.Size([8])
pred.shape: torch.Size([8, 2])
x.shape: torch.Size([8, 8, 3, 224, 224])
x.ndim: 5
x.shape: torch.Size([64, 3, 224, 224])
batch_size: 64
embeddings.shape: torch.Size([64, 197, 768])
input_ini - x shape before view: torch.Size([8, 8, 196, 768])
input_ini - x shape after first reshape: torch.Size([1568, 8, 768])
input_ini - x shape after cat: torch.Size([1568, 9, 768])
input_ini - x shape before final reshape: torch.Size([1568, 8, 768])
input_ini - x shape after final reshape: torch.Size([8, 196, 8, 768])
input_ini - x shape at end: torch.Size([8, 1568, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
cls_token.shape: torch.Size([8, 8, 1, 768])
patch_token.shape: torch.Size([8, 8, 196, 768])
x.shape: torch.Size([64, 197, 768])
x2.shape: torch.Size([64, 197, 768])
temporal.shape: torch.Size([64, 768])
cls_token.shape: torch.Size([64, 768])
### cls_token.shape: torch.Size([8, 768])
features.shape: torch.Size([8, 768])
pred.shape: torch.Size([8, 2])
label.shape: torch.Size([8])
pred.shape: torch.Size([8, 2])
x.shape: torch.Size([8, 8, 3, 224, 224])
x.ndim: 5
x.shape: torch.Size([64, 3, 224, 224])
batch_size: 64
embeddings.shape: torch.Size([64, 197, 768])
input_ini - x shape before view: torch.Size([8, 8, 196, 768])
input_ini - x shape after first reshape: torch.Size([1568, 8, 768])
input_ini - x shape after cat: torch.Size([1568, 9, 768])
input_ini - x shape before final reshape: torch.Size([1568, 8, 768])
input_ini - x shape after final reshape: torch.Size([8, 196, 8, 768])
input_ini - x shape at end: torch.Size([8, 1568, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
cls_token.shape: torch.Size([8, 8, 1, 768])
patch_token.shape: torch.Size([8, 8, 196, 768])
x.shape: torch.Size([64, 197, 768])
x2.shape: torch.Size([64, 197, 768])
temporal.shape: torch.Size([64, 768])
cls_token.shape: torch.Size([64, 768])
### cls_token.shape: torch.Size([8, 768])
features.shape: torch.Size([8, 768])
pred.shape: torch.Size([8, 2])
label.shape: torch.Size([8])
pred.shape: torch.Size([8, 2])
x.shape: torch.Size([8, 8, 3, 224, 224])
x.ndim: 5
x.shape: torch.Size([64, 3, 224, 224])
batch_size: 64
embeddings.shape: torch.Size([64, 197, 768])
input_ini - x shape before view: torch.Size([8, 8, 196, 768])
input_ini - x shape after first reshape: torch.Size([1568, 8, 768])
input_ini - x shape after cat: torch.Size([1568, 9, 768])
input_ini - x shape before final reshape: torch.Size([1568, 8, 768])
input_ini - x shape after final reshape: torch.Size([8, 196, 8, 768])
input_ini - x shape at end: torch.Size([8, 1568, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
cls_token.shape: torch.Size([8, 8, 1, 768])
patch_token.shape: torch.Size([8, 8, 196, 768])
x.shape: torch.Size([64, 197, 768])
x2.shape: torch.Size([64, 197, 768])
temporal.shape: torch.Size([64, 768])
cls_token.shape: torch.Size([64, 768])
### cls_token.shape: torch.Size([8, 768])
features.shape: torch.Size([8, 768])
pred.shape: torch.Size([8, 2])
label.shape: torch.Size([8])
pred.shape: torch.Size([8, 2])
x.shape: torch.Size([8, 8, 3, 224, 224])
x.ndim: 5
x.shape: torch.Size([64, 3, 224, 224])
batch_size: 64
embeddings.shape: torch.Size([64, 197, 768])
input_ini - x shape before view: torch.Size([8, 8, 196, 768])
input_ini - x shape after first reshape: torch.Size([1568, 8, 768])
input_ini - x shape after cat: torch.Size([1568, 9, 768])
input_ini - x shape before final reshape: torch.Size([1568, 8, 768])
input_ini - x shape after final reshape: torch.Size([8, 196, 8, 768])
input_ini - x shape at end: torch.Size([8, 1568, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
cls_token.shape: torch.Size([8, 8, 1, 768])
patch_token.shape: torch.Size([8, 8, 196, 768])
x.shape: torch.Size([64, 197, 768])
x2.shape: torch.Size([64, 197, 768])
temporal.shape: torch.Size([64, 768])
cls_token.shape: torch.Size([64, 768])
### cls_token.shape: torch.Size([8, 768])
features.shape: torch.Size([8, 768])
pred.shape: torch.Size([8, 2])
label.shape: torch.Size([8])
pred.shape: torch.Size([8, 2])
x.shape: torch.Size([4, 8, 3, 224, 224])
x.ndim: 5
x.shape: torch.Size([32, 3, 224, 224])
batch_size: 32
embeddings.shape: torch.Size([32, 197, 768])
input_ini - x shape before view: torch.Size([4, 8, 196, 768])
input_ini - x shape after first reshape: torch.Size([784, 8, 768])
input_ini - x shape after cat: torch.Size([784, 9, 768])
input_ini - x shape before final reshape: torch.Size([784, 8, 768])
input_ini - x shape after final reshape: torch.Size([4, 196, 8, 768])
input_ini - x shape at end: torch.Size([4, 1568, 768])
x2.shape): torch.Size([4, 1569, 768])
(x1.shape): torch.Size([4, 1569, 768])
(x2.shape): torch.Size([4, 1569, 768])
x2.shape): torch.Size([4, 1569, 768])
(x1.shape): torch.Size([4, 1569, 768])
(x2.shape): torch.Size([4, 1569, 768])
x2.shape): torch.Size([4, 1569, 768])
(x1.shape): torch.Size([4, 1569, 768])
100%|██████████| 13/13 [00:02<00:00,  6.07it/s]
2025-05-30 10:57:27,677 - INFO - dataset: DFDC    step: 39    testing-loss, overall: 0.67529296875    
2025-05-30 10:57:27,677 - INFO - dataset: DFDC    step: 39    testing-metric, acc: 0.65    testing-metric, auc: 0.5010989010989011    testing-metric, eer: 0.5142857142857142    testing-metric, ap: 0.7071584657885241    testing-metric, video_auc: 0.5010989010989011    testing-metric, acc_real:0.7714285714285715; acc_fake:0.5846153846153846
2025-05-30 10:57:27,678 - INFO - dataset: avg    step: 39    testing-metric, acc: 0.65    testing-metric, auc: 0.5010989010989011    testing-metric, eer: 0.5142857142857142    testing-metric, ap: 0.7071584657885241    testing-metric, video_auc: 0.5010989010989011    
2025-05-30 10:57:27,679 - INFO - ===> Test Done!
100%|██████████| 4/4 [00:07<00:00,  1.86s/it]100%|██████████| 4/4 [00:07<00:00,  1.93s/it]
2025-05-30 10:57:27,684 - INFO - ===> Epoch[9] end with testing auc: 
================================ Each dataset best metric ================================ 
| DFDC:  auc=0.5090109890109891 | 
============================================================================================= 
================================== Average best metric ====================================== 
| avg auc: 0.5090109890109891 | 
| DFDC: 0.5090109890109891 | 
=============================================================================================!
2025-05-30 10:57:27,684 - INFO - ===> Epoch[10] start!
2025-05-30 10:57:27,689 - INFO - data_dict saved to ./logs/training/clip_stan_2025-05-30-10-56-05/train/FaceForensics++/data_dict_train.pickle
(x2.shape): torch.Size([4, 1569, 768])
cls_token.shape: torch.Size([4, 8, 1, 768])
patch_token.shape: torch.Size([4, 8, 196, 768])
x.shape: torch.Size([32, 197, 768])
x2.shape: torch.Size([32, 197, 768])
temporal.shape: torch.Size([32, 768])
cls_token.shape: torch.Size([32, 768])
### cls_token.shape: torch.Size([4, 768])
features.shape: torch.Size([4, 768])
pred.shape: torch.Size([4, 2])
label.shape: torch.Size([4])
pred.shape: torch.Size([4, 2])
len(y_pred): 100
len(y_true): 100
  0%|          | 0/4 [00:00<?, ?it/s]2025-05-30 10:57:30,538 - INFO - Iter: 40    training-loss, overall: 0.6555023193359375    
2025-05-30 10:57:30,539 - INFO - Iter: 40    training-metric, acc: 0.8125    training-metric, auc: 0.8493589743589743    training-metric, eer: 0.3333333333333333    training-metric, ap: 0.9639835399899117    
 25%|██▌       | 1/4 [00:02<00:08,  2.84s/it]2025-05-30 10:57:31,061 - INFO - ===> Test start!
2025-05-30 10:57:31,063 - INFO - data_dict saved to ./logs/training/clip_stan_2025-05-30-10-56-05/test/DFDC/data_dict_test.pickle
x.shape: torch.Size([32, 8, 3, 224, 224])
x.ndim: 5
x.shape: torch.Size([256, 3, 224, 224])
batch_size: 256
embeddings.shape: torch.Size([256, 197, 768])
input_ini - x shape before view: torch.Size([32, 8, 196, 768])
input_ini - x shape after first reshape: torch.Size([6272, 8, 768])
input_ini - x shape after cat: torch.Size([6272, 9, 768])
input_ini - x shape before final reshape: torch.Size([6272, 8, 768])
input_ini - x shape after final reshape: torch.Size([32, 196, 8, 768])
input_ini - x shape at end: torch.Size([32, 1568, 768])
x2.shape): torch.Size([32, 1569, 768])
(x1.shape): torch.Size([32, 1569, 768])
(x2.shape): torch.Size([32, 1569, 768])
x2.shape): torch.Size([32, 1569, 768])
(x1.shape): torch.Size([32, 1569, 768])
(x2.shape): torch.Size([32, 1569, 768])
x2.shape): torch.Size([32, 1569, 768])
(x1.shape): torch.Size([32, 1569, 768])
(x2.shape): torch.Size([32, 1569, 768])
cls_token.shape: torch.Size([32, 8, 1, 768])
patch_token.shape: torch.Size([32, 8, 196, 768])
x.shape: torch.Size([256, 197, 768])
x2.shape: torch.Size([256, 197, 768])
temporal.shape: torch.Size([256, 768])
cls_token.shape: torch.Size([256, 768])
### cls_token.shape: torch.Size([32, 768])
features.shape: torch.Size([32, 768])
pred.shape: torch.Size([32, 2])
label.shape: torch.Size([32])
pred.shape: torch.Size([32, 2])
x.shape: torch.Size([32, 8, 3, 224, 224])
x.ndim: 5
x.shape: torch.Size([256, 3, 224, 224])
batch_size: 256
embeddings.shape: torch.Size([256, 197, 768])
input_ini - x shape before view: torch.Size([32, 8, 196, 768])
input_ini - x shape after first reshape: torch.Size([6272, 8, 768])
input_ini - x shape after cat: torch.Size([6272, 9, 768])
input_ini - x shape before final reshape: torch.Size([6272, 8, 768])
input_ini - x shape after final reshape: torch.Size([32, 196, 8, 768])
input_ini - x shape at end: torch.Size([32, 1568, 768])
x2.shape): torch.Size([32, 1569, 768])
(x1.shape): torch.Size([32, 1569, 768])
(x2.shape): torch.Size([32, 1569, 768])
x2.shape): torch.Size([32, 1569, 768])
(x1.shape): torch.Size([32, 1569, 768])
(x2.shape): torch.Size([32, 1569, 768])
x2.shape): torch.Size([32, 1569, 768])
(x1.shape): torch.Size([32, 1569, 768])
(x2.shape): torch.Size([32, 1569, 768])
cls_token.shape: torch.Size([32, 8, 1, 768])
patch_token.shape: torch.Size([32, 8, 196, 768])
x.shape: torch.Size([256, 197, 768])
x2.shape: torch.Size([256, 197, 768])
temporal.shape: torch.Size([256, 768])
cls_token.shape: torch.Size([256, 768])
### cls_token.shape: torch.Size([32, 768])
features.shape: torch.Size([32, 768])
pred.shape: torch.Size([32, 2])
label.shape: torch.Size([32])
pred.shape: torch.Size([32, 2])

  0%|          | 0/13 [00:00<?, ?it/s][A
  8%|▊         | 1/13 [00:00<00:07,  1.58it/s][A
 15%|█▌        | 2/13 [00:00<00:03,  2.95it/s][A
 23%|██▎       | 3/13 [00:00<00:02,  4.08it/s][A
 31%|███       | 4/13 [00:01<00:01,  4.97it/s][A
 38%|███▊      | 5/13 [00:01<00:01,  5.64it/s][A
 46%|████▌     | 6/13 [00:01<00:01,  6.15it/s][Ax.shape: torch.Size([8, 8, 3, 224, 224])
x.ndim: 5
x.shape: torch.Size([64, 3, 224, 224])
batch_size: 64
embeddings.shape: torch.Size([64, 197, 768])
input_ini - x shape before view: torch.Size([8, 8, 196, 768])
input_ini - x shape after first reshape: torch.Size([1568, 8, 768])
input_ini - x shape after cat: torch.Size([1568, 9, 768])
input_ini - x shape before final reshape: torch.Size([1568, 8, 768])
input_ini - x shape after final reshape: torch.Size([8, 196, 8, 768])
input_ini - x shape at end: torch.Size([8, 1568, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
cls_token.shape: torch.Size([8, 8, 1, 768])
patch_token.shape: torch.Size([8, 8, 196, 768])
x.shape: torch.Size([64, 197, 768])
x2.shape: torch.Size([64, 197, 768])
temporal.shape: torch.Size([64, 768])
cls_token.shape: torch.Size([64, 768])
### cls_token.shape: torch.Size([8, 768])
features.shape: torch.Size([8, 768])
pred.shape: torch.Size([8, 2])
label.shape: torch.Size([8])
pred.shape: torch.Size([8, 2])
x.shape: torch.Size([8, 8, 3, 224, 224])
x.ndim: 5
x.shape: torch.Size([64, 3, 224, 224])
batch_size: 64
embeddings.shape: torch.Size([64, 197, 768])
input_ini - x shape before view: torch.Size([8, 8, 196, 768])
input_ini - x shape after first reshape: torch.Size([1568, 8, 768])
input_ini - x shape after cat: torch.Size([1568, 9, 768])
input_ini - x shape before final reshape: torch.Size([1568, 8, 768])
input_ini - x shape after final reshape: torch.Size([8, 196, 8, 768])
input_ini - x shape at end: torch.Size([8, 1568, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
cls_token.shape: torch.Size([8, 8, 1, 768])
patch_token.shape: torch.Size([8, 8, 196, 768])
x.shape: torch.Size([64, 197, 768])
x2.shape: torch.Size([64, 197, 768])
temporal.shape: torch.Size([64, 768])
cls_token.shape: torch.Size([64, 768])
### cls_token.shape: torch.Size([8, 768])
features.shape: torch.Size([8, 768])
pred.shape: torch.Size([8, 2])
label.shape: torch.Size([8])
pred.shape: torch.Size([8, 2])
x.shape: torch.Size([8, 8, 3, 224, 224])
x.ndim: 5
x.shape: torch.Size([64, 3, 224, 224])
batch_size: 64
embeddings.shape: torch.Size([64, 197, 768])
input_ini - x shape before view: torch.Size([8, 8, 196, 768])
input_ini - x shape after first reshape: torch.Size([1568, 8, 768])
input_ini - x shape after cat: torch.Size([1568, 9, 768])
input_ini - x shape before final reshape: torch.Size([1568, 8, 768])
input_ini - x shape after final reshape: torch.Size([8, 196, 8, 768])
input_ini - x shape at end: torch.Size([8, 1568, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
cls_token.shape: torch.Size([8, 8, 1, 768])
patch_token.shape: torch.Size([8, 8, 196, 768])
x.shape: torch.Size([64, 197, 768])
x2.shape: torch.Size([64, 197, 768])
temporal.shape: torch.Size([64, 768])
cls_token.shape: torch.Size([64, 768])
### cls_token.shape: torch.Size([8, 768])
features.shape: torch.Size([8, 768])
pred.shape: torch.Size([8, 2])
label.shape: torch.Size([8])
pred.shape: torch.Size([8, 2])
x.shape: torch.Size([8, 8, 3, 224, 224])
x.ndim: 5
x.shape: torch.Size([64, 3, 224, 224])
batch_size: 64
embeddings.shape: torch.Size([64, 197, 768])
input_ini - x shape before view: torch.Size([8, 8, 196, 768])
input_ini - x shape after first reshape: torch.Size([1568, 8, 768])
input_ini - x shape after cat: torch.Size([1568, 9, 768])
input_ini - x shape before final reshape: torch.Size([1568, 8, 768])
input_ini - x shape after final reshape: torch.Size([8, 196, 8, 768])
input_ini - x shape at end: torch.Size([8, 1568, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
cls_token.shape: torch.Size([8, 8, 1, 768])
patch_token.shape: torch.Size([8, 8, 196, 768])
x.shape: torch.Size([64, 197, 768])
x2.shape: torch.Size([64, 197, 768])
temporal.shape: torch.Size([64, 768])
cls_token.shape: torch.Size([64, 768])
### cls_token.shape: torch.Size([8, 768])
features.shape: torch.Size([8, 768])
pred.shape: torch.Size([8, 2])
label.shape: torch.Size([8])
pred.shape: torch.Size([8, 2])
x.shape: torch.Size([8, 8, 3, 224, 224])
x.ndim: 5
x.shape: torch.Size([64, 3, 224, 224])
batch_size: 64
embeddings.shape: torch.Size([64, 197, 768])
input_ini - x shape before view: torch.Size([8, 8, 196, 768])
input_ini - x shape after first reshape: torch.Size([1568, 8, 768])
input_ini - x shape after cat: torch.Size([1568, 9, 768])
input_ini - x shape before final reshape: torch.Size([1568, 8, 768])
input_ini - x shape after final reshape: torch.Size([8, 196, 8, 768])
input_ini - x shape at end: torch.Size([8, 1568, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
cls_token.shape: torch.Size([8, 8, 1, 768])
patch_token.shape: torch.Size([8, 8, 196, 768])
x.shape: torch.Size([64, 197, 768])
x2.shape: torch.Size([64, 197, 768])
temporal.shape: torch.Size([64, 768])
cls_token.shape: torch.Size([64, 768])
### cls_token.shape: torch.Size([8, 768])
features.shape: torch.Size([8, 768])
pred.shape: torch.Size([8, 2])
label.shape: torch.Size([8])
pred.shape: torch.Size([8, 2])
x.shape: torch.Size([8, 8, 3, 224, 224])
x.ndim: 5
x.shape: torch.Size([64, 3, 224, 224])
batch_size: 64
embeddings.shape: torch.Size([64, 197, 768])
input_ini - x shape before view: torch.Size([8, 8, 196, 768])
input_ini - x shape after first reshape: torch.Size([1568, 8, 768])
input_ini - x shape after cat: torch.Size([1568, 9, 768])
input_ini - x shape before final reshape: torch.Size([1568, 8, 768])
input_ini - x shape after final reshape: torch.Size([8, 196, 8, 768])
input_ini - x shape at end: torch.Size([8, 1568, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
cls_token.shape: torch.Size([8, 8, 1, 768])
patch_token.shape: torch.Size([8, 8, 196, 768])
x.shape: torch.Size([64, 197, 768])
x2.shape: torch.Size([64, 197, 768])
temporal.shape: torch.Size([64, 768])
cls_token.shape: torch.Size([64, 768])
### cls_token.shape: torch.Size([8, 768])
features.shape: torch.Size([8, 768])
pred.shape: torch.Size([8, 2])
label.shape: torch.Size([8])
pred.shape: torch.Size([8, 2])
x.shape: torch.Size([8, 8, 3, 224, 224])
x.ndim: 5
x.shape: torch.Size([64, 3, 224, 224])
batch_size: 64
embeddings.shape: torch.Size([64, 197, 768])
input_ini - x shape before view: torch.Size([8, 8, 196, 768])
input_ini - x shape after first reshape: torch.Size([1568, 8, 768])
input_ini - x shape after cat: torch.Size([1568, 9, 768])
input_ini - x shape before final reshape: torch.Size([1568, 8, 768])

 54%|█████▍    | 7/13 [00:01<00:00,  6.52it/s][A
 62%|██████▏   | 8/13 [00:01<00:00,  6.79it/s][A
 69%|██████▉   | 9/13 [00:01<00:00,  6.98it/s][A
 77%|███████▋  | 10/13 [00:01<00:00,  7.12it/s][A
 85%|████████▍ | 11/13 [00:01<00:00,  7.22it/s][A
 92%|█████████▏| 12/13 [00:02<00:00,  7.29it/s][Ainput_ini - x shape after final reshape: torch.Size([8, 196, 8, 768])
input_ini - x shape at end: torch.Size([8, 1568, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
cls_token.shape: torch.Size([8, 8, 1, 768])
patch_token.shape: torch.Size([8, 8, 196, 768])
x.shape: torch.Size([64, 197, 768])
x2.shape: torch.Size([64, 197, 768])
temporal.shape: torch.Size([64, 768])
cls_token.shape: torch.Size([64, 768])
### cls_token.shape: torch.Size([8, 768])
features.shape: torch.Size([8, 768])
pred.shape: torch.Size([8, 2])
label.shape: torch.Size([8])
pred.shape: torch.Size([8, 2])
x.shape: torch.Size([8, 8, 3, 224, 224])
x.ndim: 5
x.shape: torch.Size([64, 3, 224, 224])
batch_size: 64
embeddings.shape: torch.Size([64, 197, 768])
input_ini - x shape before view: torch.Size([8, 8, 196, 768])
input_ini - x shape after first reshape: torch.Size([1568, 8, 768])
input_ini - x shape after cat: torch.Size([1568, 9, 768])
input_ini - x shape before final reshape: torch.Size([1568, 8, 768])
input_ini - x shape after final reshape: torch.Size([8, 196, 8, 768])
input_ini - x shape at end: torch.Size([8, 1568, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
cls_token.shape: torch.Size([8, 8, 1, 768])
patch_token.shape: torch.Size([8, 8, 196, 768])
x.shape: torch.Size([64, 197, 768])
x2.shape: torch.Size([64, 197, 768])
temporal.shape: torch.Size([64, 768])
cls_token.shape: torch.Size([64, 768])
### cls_token.shape: torch.Size([8, 768])
features.shape: torch.Size([8, 768])
pred.shape: torch.Size([8, 2])
label.shape: torch.Size([8])
pred.shape: torch.Size([8, 2])
x.shape: torch.Size([8, 8, 3, 224, 224])
x.ndim: 5
x.shape: torch.Size([64, 3, 224, 224])
batch_size: 64
embeddings.shape: torch.Size([64, 197, 768])
input_ini - x shape before view: torch.Size([8, 8, 196, 768])
input_ini - x shape after first reshape: torch.Size([1568, 8, 768])
input_ini - x shape after cat: torch.Size([1568, 9, 768])
input_ini - x shape before final reshape: torch.Size([1568, 8, 768])
input_ini - x shape after final reshape: torch.Size([8, 196, 8, 768])
input_ini - x shape at end: torch.Size([8, 1568, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
cls_token.shape: torch.Size([8, 8, 1, 768])
patch_token.shape: torch.Size([8, 8, 196, 768])
x.shape: torch.Size([64, 197, 768])
x2.shape: torch.Size([64, 197, 768])
temporal.shape: torch.Size([64, 768])
cls_token.shape: torch.Size([64, 768])
### cls_token.shape: torch.Size([8, 768])
features.shape: torch.Size([8, 768])
pred.shape: torch.Size([8, 2])
label.shape: torch.Size([8])
pred.shape: torch.Size([8, 2])
x.shape: torch.Size([8, 8, 3, 224, 224])
x.ndim: 5
x.shape: torch.Size([64, 3, 224, 224])
batch_size: 64
embeddings.shape: torch.Size([64, 197, 768])
input_ini - x shape before view: torch.Size([8, 8, 196, 768])
input_ini - x shape after first reshape: torch.Size([1568, 8, 768])
input_ini - x shape after cat: torch.Size([1568, 9, 768])
input_ini - x shape before final reshape: torch.Size([1568, 8, 768])
input_ini - x shape after final reshape: torch.Size([8, 196, 8, 768])
input_ini - x shape at end: torch.Size([8, 1568, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
cls_token.shape: torch.Size([8, 8, 1, 768])
patch_token.shape: torch.Size([8, 8, 196, 768])
x.shape: torch.Size([64, 197, 768])
x2.shape: torch.Size([64, 197, 768])
temporal.shape: torch.Size([64, 768])
cls_token.shape: torch.Size([64, 768])
### cls_token.shape: torch.Size([8, 768])
features.shape: torch.Size([8, 768])
pred.shape: torch.Size([8, 2])
label.shape: torch.Size([8])
pred.shape: torch.Size([8, 2])
x.shape: torch.Size([8, 8, 3, 224, 224])
x.ndim: 5
x.shape: torch.Size([64, 3, 224, 224])
batch_size: 64
embeddings.shape: torch.Size([64, 197, 768])
input_ini - x shape before view: torch.Size([8, 8, 196, 768])
input_ini - x shape after first reshape: torch.Size([1568, 8, 768])
input_ini - x shape after cat: torch.Size([1568, 9, 768])
input_ini - x shape before final reshape: torch.Size([1568, 8, 768])
input_ini - x shape after final reshape: torch.Size([8, 196, 8, 768])
input_ini - x shape at end: torch.Size([8, 1568, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
cls_token.shape: torch.Size([8, 8, 1, 768])
patch_token.shape: torch.Size([8, 8, 196, 768])
x.shape: torch.Size([64, 197, 768])
x2.shape: torch.Size([64, 197, 768])
temporal.shape: torch.Size([64, 768])
cls_token.shape: torch.Size([64, 768])
### cls_token.shape: torch.Size([8, 768])
features.shape: torch.Size([8, 768])
pred.shape: torch.Size([8, 2])
label.shape: torch.Size([8])
pred.shape: torch.Size([8, 2])
x.shape: torch.Size([8, 8, 3, 224, 224])
x.ndim: 5
x.shape: torch.Size([64, 3, 224, 224])
batch_size: 64
embeddings.shape: torch.Size([64, 197, 768])
input_ini - x shape before view: torch.Size([8, 8, 196, 768])
input_ini - x shape after first reshape: torch.Size([1568, 8, 768])
input_ini - x shape after cat: torch.Size([1568, 9, 768])
input_ini - x shape before final reshape: torch.Size([1568, 8, 768])
input_ini - x shape after final reshape: torch.Size([8, 196, 8, 768])
input_ini - x shape at end: torch.Size([8, 1568, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
cls_token.shape: torch.Size([8, 8, 1, 768])
patch_token.shape: torch.Size([8, 8, 196, 768])
x.shape: torch.Size([64, 197, 768])
x2.shape: torch.Size([64, 197, 768])
temporal.shape: torch.Size([64, 768])
cls_token.shape: torch.Size([64, 768])
### cls_token.shape: torch.Size([8, 768])
features.shape: torch.Size([8, 768])
pred.shape: torch.Size([8, 2])
label.shape: torch.Size([8])
pred.shape: torch.Size([8, 2])
x.shape: torch.Size([4, 8, 3, 224, 224])
x.ndim: 5
x.shape: torch.Size([32, 3, 224, 224])
batch_size: 32
embeddings.shape: torch.Size([32, 197, 768])
input_ini - x shape before view: torch.Size([4, 8, 196, 768])
input_ini - x shape after first reshape: torch.Size([784, 8, 768])
input_ini - x shape after cat: torch.Size([784, 9, 768])
input_ini - x shape before final reshape: torch.Size([784, 8, 768])
input_ini - x shape after final reshape: torch.Size([4, 196, 8, 768])
input_ini - x shape at end: torch.Size([4, 1568, 768])
x2.shape): torch.Size([4, 1569, 768])
(x1.shape): torch.Size([4, 1569, 768])
(x2.shape): torch.Size([4, 1569, 768])
x2.shape): torch.Size([4, 1569, 768])
(x1.shape): torch.Size([4, 1569, 768])
(x2.shape): torch.Size([4, 1569, 768])
x2.shape): torch.Size([4, 1569, 768])
(x1.shape): torch.Size([4, 1569, 768])
100%|██████████| 13/13 [00:02<00:00,  5.97it/s]
2025-05-30 10:57:33,252 - INFO - dataset: DFDC    step: 41    testing-loss, overall: 0.6748046875    
2025-05-30 10:57:33,253 - INFO - dataset: DFDC    step: 41    testing-metric, acc: 0.65    testing-metric, auc: 0.5017582417582418    testing-metric, eer: 0.5142857142857142    testing-metric, ap: 0.7087572794837649    testing-metric, video_auc: 0.5017582417582418    testing-metric, acc_real:0.7714285714285715; acc_fake:0.5846153846153846
2025-05-30 10:57:33,254 - INFO - dataset: avg    step: 41    testing-metric, acc: 0.65    testing-metric, auc: 0.5017582417582418    testing-metric, eer: 0.5142857142857142    testing-metric, ap: 0.7087572794837649    testing-metric, video_auc: 0.5017582417582418    
2025-05-30 10:57:33,254 - INFO - ===> Test Done!
 50%|█████     | 2/4 [00:05<00:05,  2.76s/it] 75%|███████▌  | 3/4 [00:06<00:01,  1.74s/it]2025-05-30 10:57:33,851 - INFO - ===> Test start!
2025-05-30 10:57:33,854 - INFO - data_dict saved to ./logs/training/clip_stan_2025-05-30-10-56-05/test/DFDC/data_dict_test.pickle
(x2.shape): torch.Size([4, 1569, 768])
cls_token.shape: torch.Size([4, 8, 1, 768])
patch_token.shape: torch.Size([4, 8, 196, 768])
x.shape: torch.Size([32, 197, 768])
x2.shape: torch.Size([32, 197, 768])
temporal.shape: torch.Size([32, 768])
cls_token.shape: torch.Size([32, 768])
### cls_token.shape: torch.Size([4, 768])
features.shape: torch.Size([4, 768])
pred.shape: torch.Size([4, 2])
label.shape: torch.Size([4])
pred.shape: torch.Size([4, 2])
len(y_pred): 100
len(y_true): 100
x.shape: torch.Size([32, 8, 3, 224, 224])
x.ndim: 5
x.shape: torch.Size([256, 3, 224, 224])
batch_size: 256
embeddings.shape: torch.Size([256, 197, 768])
input_ini - x shape before view: torch.Size([32, 8, 196, 768])
input_ini - x shape after first reshape: torch.Size([6272, 8, 768])
input_ini - x shape after cat: torch.Size([6272, 9, 768])
input_ini - x shape before final reshape: torch.Size([6272, 8, 768])
input_ini - x shape after final reshape: torch.Size([32, 196, 8, 768])
input_ini - x shape at end: torch.Size([32, 1568, 768])
x2.shape): torch.Size([32, 1569, 768])
(x1.shape): torch.Size([32, 1569, 768])
(x2.shape): torch.Size([32, 1569, 768])
x2.shape): torch.Size([32, 1569, 768])
(x1.shape): torch.Size([32, 1569, 768])
(x2.shape): torch.Size([32, 1569, 768])
x2.shape): torch.Size([32, 1569, 768])
(x1.shape): torch.Size([32, 1569, 768])
(x2.shape): torch.Size([32, 1569, 768])
cls_token.shape: torch.Size([32, 8, 1, 768])
patch_token.shape: torch.Size([32, 8, 196, 768])
x.shape: torch.Size([256, 197, 768])
x2.shape: torch.Size([256, 197, 768])
temporal.shape: torch.Size([256, 768])
cls_token.shape: torch.Size([256, 768])
### cls_token.shape: torch.Size([32, 768])
features.shape: torch.Size([32, 768])
pred.shape: torch.Size([32, 2])
label.shape: torch.Size([32])
pred.shape: torch.Size([32, 2])
x.shape: torch.Size([4, 8, 3, 224, 224])
x.ndim: 5
x.shape: torch.Size([32, 3, 224, 224])
batch_size: 32
embeddings.shape: torch.Size([32, 197, 768])
input_ini - x shape before view: torch.Size([4, 8, 196, 768])
input_ini - x shape after first reshape: torch.Size([784, 8, 768])
input_ini - x shape after cat: torch.Size([784, 9, 768])
input_ini - x shape before final reshape: torch.Size([784, 8, 768])
input_ini - x shape after final reshape: torch.Size([4, 196, 8, 768])
input_ini - x shape at end: torch.Size([4, 1568, 768])
x2.shape): torch.Size([4, 1569, 768])
(x1.shape): torch.Size([4, 1569, 768])
(x2.shape): torch.Size([4, 1569, 768])
x2.shape): torch.Size([4, 1569, 768])
(x1.shape): torch.Size([4, 1569, 768])
(x2.shape): torch.Size([4, 1569, 768])
x2.shape): torch.Size([4, 1569, 768])
(x1.shape): torch.Size([4, 1569, 768])
(x2.shape): torch.Size([4, 1569, 768])
cls_token.shape: torch.Size([4, 8, 1, 768])
patch_token.shape: torch.Size([4, 8, 196, 768])
x.shape: torch.Size([32, 197, 768])
x2.shape: torch.Size([32, 197, 768])
temporal.shape: torch.Size([32, 768])
cls_token.shape: torch.Size([32, 768])
### cls_token.shape: torch.Size([4, 768])
features.shape: torch.Size([4, 768])
pred.shape: torch.Size([4, 2])
label.shape: torch.Size([4])
pred.shape: torch.Size([4, 2])

  0%|          | 0/13 [00:00<?, ?it/s][A
  8%|▊         | 1/13 [00:00<00:08,  1.48it/s][A
 15%|█▌        | 2/13 [00:00<00:03,  2.79it/s][A
 23%|██▎       | 3/13 [00:00<00:02,  3.91it/s][A
 31%|███       | 4/13 [00:01<00:01,  4.81it/s][A
 38%|███▊      | 5/13 [00:01<00:01,  5.52it/s][A
 46%|████▌     | 6/13 [00:01<00:01,  6.05it/s][Ax.shape: torch.Size([8, 8, 3, 224, 224])
x.ndim: 5
x.shape: torch.Size([64, 3, 224, 224])
batch_size: 64
embeddings.shape: torch.Size([64, 197, 768])
input_ini - x shape before view: torch.Size([8, 8, 196, 768])
input_ini - x shape after first reshape: torch.Size([1568, 8, 768])
input_ini - x shape after cat: torch.Size([1568, 9, 768])
input_ini - x shape before final reshape: torch.Size([1568, 8, 768])
input_ini - x shape after final reshape: torch.Size([8, 196, 8, 768])
input_ini - x shape at end: torch.Size([8, 1568, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
cls_token.shape: torch.Size([8, 8, 1, 768])
patch_token.shape: torch.Size([8, 8, 196, 768])
x.shape: torch.Size([64, 197, 768])
x2.shape: torch.Size([64, 197, 768])
temporal.shape: torch.Size([64, 768])
cls_token.shape: torch.Size([64, 768])
### cls_token.shape: torch.Size([8, 768])
features.shape: torch.Size([8, 768])
pred.shape: torch.Size([8, 2])
label.shape: torch.Size([8])
pred.shape: torch.Size([8, 2])
x.shape: torch.Size([8, 8, 3, 224, 224])
x.ndim: 5
x.shape: torch.Size([64, 3, 224, 224])
batch_size: 64
embeddings.shape: torch.Size([64, 197, 768])
input_ini - x shape before view: torch.Size([8, 8, 196, 768])
input_ini - x shape after first reshape: torch.Size([1568, 8, 768])
input_ini - x shape after cat: torch.Size([1568, 9, 768])
input_ini - x shape before final reshape: torch.Size([1568, 8, 768])
input_ini - x shape after final reshape: torch.Size([8, 196, 8, 768])
input_ini - x shape at end: torch.Size([8, 1568, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
cls_token.shape: torch.Size([8, 8, 1, 768])
patch_token.shape: torch.Size([8, 8, 196, 768])
x.shape: torch.Size([64, 197, 768])
x2.shape: torch.Size([64, 197, 768])
temporal.shape: torch.Size([64, 768])
cls_token.shape: torch.Size([64, 768])
### cls_token.shape: torch.Size([8, 768])
features.shape: torch.Size([8, 768])
pred.shape: torch.Size([8, 2])
label.shape: torch.Size([8])
pred.shape: torch.Size([8, 2])
x.shape: torch.Size([8, 8, 3, 224, 224])
x.ndim: 5
x.shape: torch.Size([64, 3, 224, 224])
batch_size: 64
embeddings.shape: torch.Size([64, 197, 768])
input_ini - x shape before view: torch.Size([8, 8, 196, 768])
input_ini - x shape after first reshape: torch.Size([1568, 8, 768])
input_ini - x shape after cat: torch.Size([1568, 9, 768])
input_ini - x shape before final reshape: torch.Size([1568, 8, 768])
input_ini - x shape after final reshape: torch.Size([8, 196, 8, 768])
input_ini - x shape at end: torch.Size([8, 1568, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
cls_token.shape: torch.Size([8, 8, 1, 768])
patch_token.shape: torch.Size([8, 8, 196, 768])
x.shape: torch.Size([64, 197, 768])
x2.shape: torch.Size([64, 197, 768])
temporal.shape: torch.Size([64, 768])
cls_token.shape: torch.Size([64, 768])
### cls_token.shape: torch.Size([8, 768])
features.shape: torch.Size([8, 768])
pred.shape: torch.Size([8, 2])
label.shape: torch.Size([8])
pred.shape: torch.Size([8, 2])
x.shape: torch.Size([8, 8, 3, 224, 224])
x.ndim: 5
x.shape: torch.Size([64, 3, 224, 224])
batch_size: 64
embeddings.shape: torch.Size([64, 197, 768])
input_ini - x shape before view: torch.Size([8, 8, 196, 768])
input_ini - x shape after first reshape: torch.Size([1568, 8, 768])
input_ini - x shape after cat: torch.Size([1568, 9, 768])
input_ini - x shape before final reshape: torch.Size([1568, 8, 768])
input_ini - x shape after final reshape: torch.Size([8, 196, 8, 768])
input_ini - x shape at end: torch.Size([8, 1568, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
cls_token.shape: torch.Size([8, 8, 1, 768])
patch_token.shape: torch.Size([8, 8, 196, 768])
x.shape: torch.Size([64, 197, 768])
x2.shape: torch.Size([64, 197, 768])
temporal.shape: torch.Size([64, 768])
cls_token.shape: torch.Size([64, 768])
### cls_token.shape: torch.Size([8, 768])
features.shape: torch.Size([8, 768])
pred.shape: torch.Size([8, 2])
label.shape: torch.Size([8])
pred.shape: torch.Size([8, 2])
x.shape: torch.Size([8, 8, 3, 224, 224])
x.ndim: 5
x.shape: torch.Size([64, 3, 224, 224])
batch_size: 64
embeddings.shape: torch.Size([64, 197, 768])
input_ini - x shape before view: torch.Size([8, 8, 196, 768])
input_ini - x shape after first reshape: torch.Size([1568, 8, 768])
input_ini - x shape after cat: torch.Size([1568, 9, 768])
input_ini - x shape before final reshape: torch.Size([1568, 8, 768])
input_ini - x shape after final reshape: torch.Size([8, 196, 8, 768])
input_ini - x shape at end: torch.Size([8, 1568, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
cls_token.shape: torch.Size([8, 8, 1, 768])
patch_token.shape: torch.Size([8, 8, 196, 768])
x.shape: torch.Size([64, 197, 768])
x2.shape: torch.Size([64, 197, 768])
temporal.shape: torch.Size([64, 768])
cls_token.shape: torch.Size([64, 768])
### cls_token.shape: torch.Size([8, 768])
features.shape: torch.Size([8, 768])
pred.shape: torch.Size([8, 2])
label.shape: torch.Size([8])
pred.shape: torch.Size([8, 2])
x.shape: torch.Size([8, 8, 3, 224, 224])
x.ndim: 5
x.shape: torch.Size([64, 3, 224, 224])
batch_size: 64
embeddings.shape: torch.Size([64, 197, 768])
input_ini - x shape before view: torch.Size([8, 8, 196, 768])
input_ini - x shape after first reshape: torch.Size([1568, 8, 768])
input_ini - x shape after cat: torch.Size([1568, 9, 768])
input_ini - x shape before final reshape: torch.Size([1568, 8, 768])
input_ini - x shape after final reshape: torch.Size([8, 196, 8, 768])
input_ini - x shape at end: torch.Size([8, 1568, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
cls_token.shape: torch.Size([8, 8, 1, 768])
patch_token.shape: torch.Size([8, 8, 196, 768])
x.shape: torch.Size([64, 197, 768])
x2.shape: torch.Size([64, 197, 768])
temporal.shape: torch.Size([64, 768])
cls_token.shape: torch.Size([64, 768])
### cls_token.shape: torch.Size([8, 768])
features.shape: torch.Size([8, 768])
pred.shape: torch.Size([8, 2])
label.shape: torch.Size([8])
pred.shape: torch.Size([8, 2])
x.shape: torch.Size([8, 8, 3, 224, 224])
x.ndim: 5
x.shape: torch.Size([64, 3, 224, 224])
batch_size: 64
embeddings.shape: torch.Size([64, 197, 768])
input_ini - x shape before view: torch.Size([8, 8, 196, 768])
input_ini - x shape after first reshape: torch.Size([1568, 8, 768])
input_ini - x shape after cat: torch.Size([1568, 9, 768])
input_ini - x shape before final reshape: torch.Size([1568, 8, 768])

 54%|█████▍    | 7/13 [00:01<00:00,  6.44it/s][A
 62%|██████▏   | 8/13 [00:01<00:00,  6.73it/s][A
 69%|██████▉   | 9/13 [00:01<00:00,  6.94it/s][A
 77%|███████▋  | 10/13 [00:01<00:00,  7.08it/s][A
 85%|████████▍ | 11/13 [00:02<00:00,  7.19it/s][A
 92%|█████████▏| 12/13 [00:02<00:00,  7.27it/s][Ainput_ini - x shape after final reshape: torch.Size([8, 196, 8, 768])
input_ini - x shape at end: torch.Size([8, 1568, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
cls_token.shape: torch.Size([8, 8, 1, 768])
patch_token.shape: torch.Size([8, 8, 196, 768])
x.shape: torch.Size([64, 197, 768])
x2.shape: torch.Size([64, 197, 768])
temporal.shape: torch.Size([64, 768])
cls_token.shape: torch.Size([64, 768])
### cls_token.shape: torch.Size([8, 768])
features.shape: torch.Size([8, 768])
pred.shape: torch.Size([8, 2])
label.shape: torch.Size([8])
pred.shape: torch.Size([8, 2])
x.shape: torch.Size([8, 8, 3, 224, 224])
x.ndim: 5
x.shape: torch.Size([64, 3, 224, 224])
batch_size: 64
embeddings.shape: torch.Size([64, 197, 768])
input_ini - x shape before view: torch.Size([8, 8, 196, 768])
input_ini - x shape after first reshape: torch.Size([1568, 8, 768])
input_ini - x shape after cat: torch.Size([1568, 9, 768])
input_ini - x shape before final reshape: torch.Size([1568, 8, 768])
input_ini - x shape after final reshape: torch.Size([8, 196, 8, 768])
input_ini - x shape at end: torch.Size([8, 1568, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
cls_token.shape: torch.Size([8, 8, 1, 768])
patch_token.shape: torch.Size([8, 8, 196, 768])
x.shape: torch.Size([64, 197, 768])
x2.shape: torch.Size([64, 197, 768])
temporal.shape: torch.Size([64, 768])
cls_token.shape: torch.Size([64, 768])
### cls_token.shape: torch.Size([8, 768])
features.shape: torch.Size([8, 768])
pred.shape: torch.Size([8, 2])
label.shape: torch.Size([8])
pred.shape: torch.Size([8, 2])
x.shape: torch.Size([8, 8, 3, 224, 224])
x.ndim: 5
x.shape: torch.Size([64, 3, 224, 224])
batch_size: 64
embeddings.shape: torch.Size([64, 197, 768])
input_ini - x shape before view: torch.Size([8, 8, 196, 768])
input_ini - x shape after first reshape: torch.Size([1568, 8, 768])
input_ini - x shape after cat: torch.Size([1568, 9, 768])
input_ini - x shape before final reshape: torch.Size([1568, 8, 768])
input_ini - x shape after final reshape: torch.Size([8, 196, 8, 768])
input_ini - x shape at end: torch.Size([8, 1568, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
cls_token.shape: torch.Size([8, 8, 1, 768])
patch_token.shape: torch.Size([8, 8, 196, 768])
x.shape: torch.Size([64, 197, 768])
x2.shape: torch.Size([64, 197, 768])
temporal.shape: torch.Size([64, 768])
cls_token.shape: torch.Size([64, 768])
### cls_token.shape: torch.Size([8, 768])
features.shape: torch.Size([8, 768])
pred.shape: torch.Size([8, 2])
label.shape: torch.Size([8])
pred.shape: torch.Size([8, 2])
x.shape: torch.Size([8, 8, 3, 224, 224])
x.ndim: 5
x.shape: torch.Size([64, 3, 224, 224])
batch_size: 64
embeddings.shape: torch.Size([64, 197, 768])
input_ini - x shape before view: torch.Size([8, 8, 196, 768])
input_ini - x shape after first reshape: torch.Size([1568, 8, 768])
input_ini - x shape after cat: torch.Size([1568, 9, 768])
input_ini - x shape before final reshape: torch.Size([1568, 8, 768])
input_ini - x shape after final reshape: torch.Size([8, 196, 8, 768])
input_ini - x shape at end: torch.Size([8, 1568, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
cls_token.shape: torch.Size([8, 8, 1, 768])
patch_token.shape: torch.Size([8, 8, 196, 768])
x.shape: torch.Size([64, 197, 768])
x2.shape: torch.Size([64, 197, 768])
temporal.shape: torch.Size([64, 768])
cls_token.shape: torch.Size([64, 768])
### cls_token.shape: torch.Size([8, 768])
features.shape: torch.Size([8, 768])
pred.shape: torch.Size([8, 2])
label.shape: torch.Size([8])
pred.shape: torch.Size([8, 2])
x.shape: torch.Size([8, 8, 3, 224, 224])
x.ndim: 5
x.shape: torch.Size([64, 3, 224, 224])
batch_size: 64
embeddings.shape: torch.Size([64, 197, 768])
input_ini - x shape before view: torch.Size([8, 8, 196, 768])
input_ini - x shape after first reshape: torch.Size([1568, 8, 768])
input_ini - x shape after cat: torch.Size([1568, 9, 768])
input_ini - x shape before final reshape: torch.Size([1568, 8, 768])
input_ini - x shape after final reshape: torch.Size([8, 196, 8, 768])
input_ini - x shape at end: torch.Size([8, 1568, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
cls_token.shape: torch.Size([8, 8, 1, 768])
patch_token.shape: torch.Size([8, 8, 196, 768])
x.shape: torch.Size([64, 197, 768])
x2.shape: torch.Size([64, 197, 768])
temporal.shape: torch.Size([64, 768])
cls_token.shape: torch.Size([64, 768])
### cls_token.shape: torch.Size([8, 768])
features.shape: torch.Size([8, 768])
pred.shape: torch.Size([8, 2])
label.shape: torch.Size([8])
pred.shape: torch.Size([8, 2])
x.shape: torch.Size([8, 8, 3, 224, 224])
x.ndim: 5
x.shape: torch.Size([64, 3, 224, 224])
batch_size: 64
embeddings.shape: torch.Size([64, 197, 768])
input_ini - x shape before view: torch.Size([8, 8, 196, 768])
input_ini - x shape after first reshape: torch.Size([1568, 8, 768])
input_ini - x shape after cat: torch.Size([1568, 9, 768])
input_ini - x shape before final reshape: torch.Size([1568, 8, 768])
input_ini - x shape after final reshape: torch.Size([8, 196, 8, 768])
input_ini - x shape at end: torch.Size([8, 1568, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
x2.shape): torch.Size([8, 1569, 768])
(x1.shape): torch.Size([8, 1569, 768])
(x2.shape): torch.Size([8, 1569, 768])
cls_token.shape: torch.Size([8, 8, 1, 768])
patch_token.shape: torch.Size([8, 8, 196, 768])
x.shape: torch.Size([64, 197, 768])
x2.shape: torch.Size([64, 197, 768])
temporal.shape: torch.Size([64, 768])
cls_token.shape: torch.Size([64, 768])
### cls_token.shape: torch.Size([8, 768])
features.shape: torch.Size([8, 768])
pred.shape: torch.Size([8, 2])
label.shape: torch.Size([8])
pred.shape: torch.Size([8, 2])
x.shape: torch.Size([4, 8, 3, 224, 224])
x.ndim: 5
x.shape: torch.Size([32, 3, 224, 224])
batch_size: 32
embeddings.shape: torch.Size([32, 197, 768])
input_ini - x shape before view: torch.Size([4, 8, 196, 768])
input_ini - x shape after first reshape: torch.Size([784, 8, 768])
input_ini - x shape after cat: torch.Size([784, 9, 768])
input_ini - x shape before final reshape: torch.Size([784, 8, 768])
input_ini - x shape after final reshape: torch.Size([4, 196, 8, 768])
input_ini - x shape at end: torch.Size([4, 1568, 768])
x2.shape): torch.Size([4, 1569, 768])
(x1.shape): torch.Size([4, 1569, 768])
(x2.shape): torch.Size([4, 1569, 768])
x2.shape): torch.Size([4, 1569, 768])
(x1.shape): torch.Size([4, 1569, 768])
(x2.shape): torch.Size([4, 1569, 768])
x2.shape): torch.Size([4, 1569, 768])
(x1.shape): torch.Size([4, 1569, 768])
100%|██████████| 13/13 [00:02<00:00,  5.84it/s]
2025-05-30 10:57:36,090 - INFO - dataset: DFDC    step: 43    testing-loss, overall: 0.67431640625    
2025-05-30 10:57:36,091 - INFO - dataset: DFDC    step: 43    testing-metric, acc: 0.65    testing-metric, auc: 0.501978021978022    testing-metric, eer: 0.5142857142857142    testing-metric, ap: 0.7102494917152462    testing-metric, video_auc: 0.501978021978022    testing-metric, acc_real:0.7714285714285715; acc_fake:0.5846153846153846
2025-05-30 10:57:36,091 - INFO - dataset: avg    step: 43    testing-metric, acc: 0.65    testing-metric, auc: 0.501978021978022    testing-metric, eer: 0.5142857142857142    testing-metric, ap: 0.7102494917152462    testing-metric, video_auc: 0.501978021978022    
2025-05-30 10:57:36,091 - INFO - ===> Test Done!
100%|██████████| 4/4 [00:08<00:00,  1.97s/it]100%|██████████| 4/4 [00:08<00:00,  2.10s/it]
2025-05-30 10:57:36,098 - INFO - ===> Epoch[10] end with testing auc: 
================================ Each dataset best metric ================================ 
| DFDC:  auc=0.5090109890109891 | 
============================================================================================= 
================================== Average best metric ====================================== 
| avg auc: 0.5090109890109891 | 
| DFDC: 0.5090109890109891 | 
=============================================================================================!
2025-05-30 10:57:36,098 - INFO - Stop Training on best Testing metric 
================================ Each dataset best metric ================================ 
| DFDC:  auc=0.5090109890109891 | 
============================================================================================= 
================================== Average best metric ====================================== 
| avg auc: 0.5090109890109891 | 
| DFDC: 0.5090109890109891 | 
=============================================================================================
(x2.shape): torch.Size([4, 1569, 768])
cls_token.shape: torch.Size([4, 8, 1, 768])
patch_token.shape: torch.Size([4, 8, 196, 768])
x.shape: torch.Size([32, 197, 768])
x2.shape: torch.Size([32, 197, 768])
temporal.shape: torch.Size([32, 768])
cls_token.shape: torch.Size([32, 768])
### cls_token.shape: torch.Size([4, 768])
features.shape: torch.Size([4, 768])
pred.shape: torch.Size([4, 2])
label.shape: torch.Size([4])
pred.shape: torch.Size([4, 2])
len(y_pred): 100
len(y_true): 100
