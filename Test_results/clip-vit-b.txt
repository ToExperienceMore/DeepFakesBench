(DeepfakeBench-torch2.0) root@autodl-container-f74b419777-65470359:DeepfakeBench# sh cmd.sh 
+ python3 training/test.py --detector_path ./training/config/detector/clip_enhanced.yaml --test_dataset DFDC DFDCP Celeb-DF-v2 UADFV --weights_path /root/autodl-tmp/benchmark_deepfakes/DeepfakeBench/logs/clip_enhanced_2025-05-29-02-22-27/test/avg/ckpt_best.pth
/root/autodl-tmp/envs/DeepfakeBench-torch2.0/lib/python3.9/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/root/autodl-tmp/envs/DeepfakeBench-torch2.0/lib/python3.9/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
['in_channels', 'out_channels', 'kernel_size', 'stride', 'padding', 'dilation', 'groups', 'bias', 'padding_mode', 'device', 'dtype']
spatial_count=0 keep_stride_count=0
batch_size: 128
clip_path: weights/clip-vit-base-patch16
features_dim: 768
===> Load checkpoint done!

Dataset: DFDC
Number of images: 26387
Number of labels: 26387
test images: 26387
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 207/207 [01:44<00:00,  1.98it/s]

Detailed metrics for DFDC:
True Negatives (Real classified as Real): 8328
False Positives (Real classified as Fake): 4211
False Negatives (Fake classified as Real): 3185
True Positives (Fake classified as Fake): 10663
Accuracy: 0.7197
Precision: 0.7169
Recall: 0.7700
F1 Score: 0.7425

Predictions shape: (26387,)
Labels shape: (26387,)
Number of processed images: 26387
Number of processed image names: 26387
len(y_pred): 26387
len(y_true): 26387

dataset: DFDC
acc: 0.7197104634858074
auc: 0.8043031766307952
eer: 0.28104314538639447
ap: 0.8308175301511714
pred: [0.1423519  0.99222684 0.21346207 ... 0.76391774 0.60348386 0.7088568 ]
video_auc: 0.836833639082932
label: [0 1 1 ... 1 0 1]

Dataset: DFDCP
Number of images: 17222
Number of labels: 17222
test images: 17222
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 135/135 [01:09<00:00,  1.95it/s]

Detailed metrics for DFDCP:
True Negatives (Real classified as Real): 3781
False Positives (Real classified as Fake): 2120
False Negatives (Fake classified as Real): 1995
True Positives (Fake classified as Fake): 9326
Accuracy: 0.7611
Precision: 0.8148
Recall: 0.8238
F1 Score: 0.8193

Predictions shape: (17222,)
Labels shape: (17222,)
Number of processed images: 17222
Number of processed image names: 17222
len(y_pred): 17222
len(y_true): 17222

dataset: DFDCP
acc: 0.761061433050749
auc: 0.820725134641797
eer: 0.269276393831554
ap: 0.8919912614522179
pred: [0.8389818  0.99465805 0.96785015 ... 0.28760788 0.28479552 0.2731088 ]
video_auc: 0.8664846486709253
label: [1 1 1 ... 1 1 1]

Dataset: Celeb-DF-v2
Number of images: 16420
Number of labels: 16420
test images: 16420
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 129/129 [01:05<00:00,  1.96it/s]

Detailed metrics for Celeb-DF-v2:
True Negatives (Real classified as Real): 4333
False Positives (Real classified as Fake): 1287
False Negatives (Fake classified as Real): 3350
True Positives (Fake classified as Fake): 7450
Accuracy: 0.7176
Precision: 0.8527
Recall: 0.6898
F1 Score: 0.7627

Predictions shape: (16420,)
Labels shape: (16420,)
Number of processed images: 16420
Number of processed image names: 16420
len(y_pred): 16420
len(y_true): 16420

dataset: Celeb-DF-v2
acc: 0.7176004872107187
auc: 0.8183264218399894
eer: 0.2688612099644128
ap: 0.8919255746090449
pred: [0.98587394 0.21108769 0.9553617  ... 0.9571193  0.22775117 0.17759138]
video_auc: 0.8903998678122935
label: [1 1 1 ... 1 0 1]

Dataset: UADFV
Number of images: 3099
Number of labels: 3099
test images: 3099
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 25/25 [00:13<00:00,  1.81it/s]

Detailed metrics for UADFV:
True Negatives (Real classified as Real): 950
False Positives (Real classified as Fake): 598
False Negatives (Fake classified as Real): 24
True Positives (Fake classified as Fake): 1527
Accuracy: 0.7993
Precision: 0.7186
Recall: 0.9845
F1 Score: 0.8308

Predictions shape: (3099,)
Labels shape: (3099,)
Number of processed images: 3099
Number of processed image names: 3099
len(y_pred): 3099
len(y_true): 3099

dataset: UADFV
acc: 0.7992900935785737
auc: 0.9632861686300578
eer: 0.09431524547803617
ap: 0.9654797268823933
pred: [0.9615805  0.9668924  0.19484538 ... 0.9937411  0.13479207 0.18027547]
video_auc: 0.9845897542690545
label: [0 0 0 ... 1 0 0]
===> Test Done!
+ python3 training/test.py --detector_path ./training/config/detector/clip_enhanced.yaml --test_dataset FaceShifter DeepFakeDetection --weights_path /root/autodl-tmp/benchmark_deepfakes/DeepfakeBench/logs/clip_enhanced_2025-05-29-02-22-27/test/avg/ckpt_best.pth
/root/autodl-tmp/envs/DeepfakeBench-torch2.0/lib/python3.9/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/root/autodl-tmp/envs/DeepfakeBench-torch2.0/lib/python3.9/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
['in_channels', 'out_channels', 'kernel_size', 'stride', 'padding', 'dilation', 'groups', 'bias', 'padding_mode', 'device', 'dtype']
spatial_count=0 keep_stride_count=0
batch_size: 128
clip_path: weights/clip-vit-base-patch16
features_dim: 768
===> Load checkpoint done!

Dataset: FaceShifter
Number of images: 8958
Number of labels: 8958
test images: 8958
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 70/70 [00:38<00:00,  1.84it/s]

Detailed metrics for FaceShifter:
True Negatives (Real classified as Real): 3694
False Positives (Real classified as Fake): 785
False Negatives (Fake classified as Real): 2610
True Positives (Fake classified as Fake): 1869
Accuracy: 0.6210
Precision: 0.7042
Recall: 0.4173
F1 Score: 0.5240

Predictions shape: (8958,)
Labels shape: (8958,)
Number of processed images: 8958
Number of processed image names: 8958
len(y_pred): 8958
len(y_true): 8958

dataset: FaceShifter
acc: 0.6210091538289797
auc: 0.6870155289443066
eer: 0.3625809332440277
ap: 0.6843792732823882
pred: [0.581069   0.06489785 0.1378329  ... 0.54440784 0.07809179 0.7092417 ]
video_auc: 0.7443367346938776
label: [1 0 0 ... 0 0 1]

Dataset: DeepFakeDetection
Number of images: 102541
Number of labels: 102541
test images: 102541
Detailed metrics for DeepFakeDetection:
True Negatives (Real classified as Real): 8395
False Positives (Real classified as Fake): 2346
False Negatives (Fake classified as Real): 11574
True Positives (Fake classified as Fake): 80226
Accuracy: 0.8642
Precision: 0.9716
Recall: 0.8739
F1 Score: 0.9202

Predictions shape: (102541,)
Labels shape: (102541,)
Number of processed images: 102541
Number of processed image names: 102541
len(y_pred): 102541
len(y_true): 102541

dataset: DeepFakeDetection
acc: 0.8642494221823466
auc: 0.9186407929504339
eer: 0.16246159575458524
ap: 0.9895173885335338
pred: [0.62998027 0.98673904 0.18267092 ... 0.99012774 0.17303081 0.11186886]
video_auc: 0.962141428517518
label: [1 1 1 ... 1 1 0]
===> Test Done!
+ python3 training/test.py --detector_path ./training/config/detector/clip_enhanced.yaml --test_dataset FaceForensics++ --weights_path /root/autodl-tmp/benchmark_deepfakes/DeepfakeBench/logs/clip_enhanced_2025-05-29-02-22-27/test/avg/ckpt_best.pth
/root/autodl-tmp/envs/DeepfakeBench-torch2.0/lib/python3.9/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/root/autodl-tmp/envs/DeepfakeBench-torch2.0/lib/python3.9/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
['in_channels', 'out_channels', 'kernel_size', 'stride', 'padding', 'dilation', 'groups', 'bias', 'padding_mode', 'device', 'dtype']
spatial_count=0 keep_stride_count=0
batch_size: 128
clip_path: weights/clip-vit-base-patch16
features_dim: 768
===> Load checkpoint done!

Dataset: FaceForensics++
Number of images: 22388
Number of labels: 22388
Detailed metrics for FaceForensics++:
True Negatives (Real classified as Real): 3694
False Positives (Real classified as Fake): 785
False Negatives (Fake classified as Real): 1126
True Positives (Fake classified as Fake): 16783
Accuracy: 0.9146
Precision: 0.9553
Recall: 0.9371
F1 Score: 0.9461

Predictions shape: (22388,)
Labels shape: (22388,)
Number of processed images: 22388
Number of processed image names: 22388
len(y_pred): 22388
len(y_true): 22388

dataset: FaceForensics++
acc: 0.9146417723780597
auc: 0.9616424721986677
eer: 0.09912926992632284
ap: 0.9903067130465505
pred: [0.84969455 0.96635526 0.99381906 ... 0.80501515 0.9912574  0.49898773]
video_auc: 0.9960204081632653
label: [1 1 1 ... 1 1 0]
===> Test Done!
