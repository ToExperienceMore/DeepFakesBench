Dataset: FaceForensics++
Number of images: 22388
Number of labels: 22388
100%|███████████████████████████████████████████████████████████████████| 2799/2799 [06:20<00:00,  7.35it/s]

Detailed metrics for FaceForensics++:
True Negatives (Real classified as Real): 3928
False Positives (Real classified as Fake): 551
False Negatives (Fake classified as Real): 840
True Positives (Fake classified as Fake): 17069
Accuracy: 0.9379
Precision: 0.9687
Recall: 0.9531
F1 Score: 0.9608

Predictions shape: (22388,)
Labels shape: (22388,)
Number of processed images: 22388
Number of processed image names: 22388
len(y_pred): 22388
len(y_true): 22388

dataset: FaceForensics++
acc: 0.9378685009826693
auc: 0.9758634767012127
eer: 0.06831882116543872
ap: 0.9942117465806217
pred: [0.9029177  0.99680746 0.996786   ... 0.9960383  0.9985777  0.18066841]
video_auc: 0.9977040816326531
label: [1 1 1 ... 1 1 0]
===> Test Done!

epfakeBench-torch2.0) root@autodl-container-f74b419777-65470359:DeepfakeBench# sh cmd.sh 
+ python3 training/test.py --detector_path ./training/config/detector/clip_enhanced.yaml --test_dataset DFDC DFDCP Celeb-DF-v2 UADFV --weights_path ./logs/training/clip_enhanced_2025-05-28-07-03-43/test/avg/ckpt_best.pth
/root/autodl-tmp/envs/DeepfakeBench-torch2.0/lib/python3.9/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: '/root/autodl-tmp/envs/DeepfakeBench-torch2.0/lib/python3.9/site-packages/torchvision/image.so: undefined symbol: _ZN3c1017RegisterOperatorsD1Ev'If you don't plan on using image functionality from `torchvision.io`, you can ignore this warning. Otherwise, there might be something wrong with your environment. Did you have `libjpeg` or `libpng` installed before building `torchvision` from source?
  warn(
['in_channels', 'out_channels', 'kernel_size', 'stride', 'padding', 'dilation', 'groups', 'bias', 'padding_mode', 'device', 'dtype']
spatial_count=0 keep_stride_count=0
batch_size: 32
features_dim: 1024
===> Load checkpoint done!

Dataset: DFDC
Number of images: 26387
Number of labels: 26387
test images: 26387
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████| 3299/3299 [07:28<00:00,  7.35it/s]

Detailed metrics for DFDC:
True Negatives (Real classified as Real): 9506
False Positives (Real classified as Fake): 3033
False Negatives (Fake classified as Real): 3288
True Positives (Fake classified as Fake): 10560
Accuracy: 0.7605
Precision: 0.7769
Recall: 0.7626
F1 Score: 0.7697

Predictions shape: (26387,)
Labels shape: (26387,)
Number of processed images: 26387
Number of processed image names: 26387
len(y_pred): 26387
len(y_true): 26387

dataset: DFDC
acc: 0.7604502217000796
auc: 0.8530480193535049
eer: 0.23949278251854214
ap: 0.8823780722557456
pred: [0.04957817 0.9411902  0.2510713  ... 0.90232927 0.68890584 0.899031  ]
video_auc: 0.8856963409454439
label: [0 1 1 ... 1 0 1]

Dataset: DFDCP
Number of images: 17222
Number of labels: 17222
test images: 17222
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████| 2153/2153 [04:54<00:00,  7.31it/s]

Detailed metrics for DFDCP:
True Negatives (Real classified as Real): 4208
False Positives (Real classified as Fake): 1693
False Negatives (Fake classified as Real): 2289
True Positives (Fake classified as Fake): 9032
Accuracy: 0.7688
Precision: 0.8421
Recall: 0.7978
F1 Score: 0.8194

Predictions shape: (17222,)
Labels shape: (17222,)
Number of processed images: 17222
Number of processed image names: 17222
len(y_pred): 17222
len(y_true): 17222

dataset: DFDCP
acc: 0.768784113343398
auc: 0.8490703144294665
eer: 0.24029825453312997
ap: 0.9186395840912954
pred: [0.12039291 0.9977927  0.99793965 ... 0.98813033 0.85917425 0.26011002]
video_auc: 0.8922316093138265
label: [1 1 1 ... 1 1 1]

Dataset: Celeb-DF-v2
Number of images: 16420
Number of labels: 16420
test images: 16420
100%|█████████████████████████████████████████████████████████████████████████████████████████████████████| 2053/2053 [04:40<00:00,  7.31it/s]

Detailed metrics for Celeb-DF-v2:
True Negatives (Real classified as Real): 4536
False Positives (Real classified as Fake): 1084
False Negatives (Fake classified as Real): 2280
True Positives (Fake classified as Fake): 8520
Accuracy: 0.7951
Precision: 0.8871
Recall: 0.7889
F1 Score: 0.8351

Predictions shape: (16420,)
Labels shape: (16420,)
Number of processed images: 16420
Number of processed image names: 16420
len(y_pred): 16420
len(y_true): 16420

dataset: Celeb-DF-v2
acc: 0.7951278928136419
auc: 0.8793027052853565
eer: 0.20195729537366547
ap: 0.9312359141160684
pred: [0.992349   0.4545034  0.9232098  ... 0.9975805  0.09406715 0.23455925]
video_auc: 0.9501982815598149
label: [1 1 1 ... 1 0 1]

Dataset: UADFV
Number of images: 3099
Number of labels: 3099
test images: 3099
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████| 388/388 [00:53<00:00,  7.29it/s]

Detailed metrics for UADFV:
True Negatives (Real classified as Real): 1175
False Positives (Real classified as Fake): 373
False Negatives (Fake classified as Real): 38
True Positives (Fake classified as Fake): 1513
Accuracy: 0.8674
Precision: 0.8022
Recall: 0.9755
F1 Score: 0.8804

Predictions shape: (3099,)
Labels shape: (3099,)
Number of processed images: 3099
Number of processed image names: 3099
len(y_pred): 3099
len(y_true): 3099

dataset: UADFV
acc: 0.8673765730880929
auc: 0.9839471741995245
eer: 0.05167958656330749
ap: 0.988115173180055
pred: [0.20482789 0.4782778  0.6643176  ... 0.9970458  0.08620009 0.0689263 ]
video_auc: 0.9941690962099126
label: [0 0 0 ... 1 0 0]
===> Test Done!

Dataset: DeepFakeDetection
Number of images: 102541
Number of labels: 102541
test images: 102541
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████| 802/802 [27:27<00:00,  2.05s/it]

Detailed metrics for DeepFakeDetection:
True Negatives (Real classified as Real): 9242
False Positives (Real classified as Fake): 1499
False Negatives (Fake classified as Real): 9959
True Positives (Fake classified as Fake): 81841
Accuracy: 0.8883
Precision: 0.9820
Recall: 0.8915
F1 Score: 0.9346

Predictions shape: (102541,)
Labels shape: (102541,)
Number of processed images: 102541
Number of processed image names: 102541
len(y_pred): 102541
len(y_true): 102541

dataset: DeepFakeDetection
acc: 0.8882593304141758
auc: 0.946942420659623
eer: 0.11907643608602551
ap: 0.9936524708147849
pred: [0.99846315 0.99880624 0.9956489  ... 0.99751663 0.9985079  0.9986732 ]
video_auc: 0.9815240107892662
label: [1 1 1 ... 1 1 1]
===> Test Done!